<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Phân tích dữ liệu thực tế với R</title>
  <meta name="description" content="A book example for a Chapman &amp; Hall book.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Phân tích dữ liệu thực tế với R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A book example for a Chapman &amp; Hall book." />
  <meta name="github-repo" content="yihui/bookdown-crc" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Phân tích dữ liệu thực tế với R" />
  
  <meta name="twitter:description" content="A book example for a Chapman &amp; Hall book." />
  

<meta name="author" content="Hoàng Đức Anh">


<meta name="date" content="2018-09-24">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html">
<link rel="next" href="lp-trinh-chc-nang-ham-vi-purrr.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Phân tích dữ liệu thực tế với R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Lời mở đầu</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#tai-sao-nen-oc-cun-sach-nay"><i class="fa fa-check"></i>Tại sao nên đọc cuốn sách này</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cu-truc-cua-sach"><i class="fa fa-check"></i>Cấu trúc của sách</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cac-phn-mm-uc-s-dung"><i class="fa fa-check"></i>Các phần mềm được sử dụng</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#li-cam-on"><i class="fa fa-check"></i>Lời cảm ơn</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="v-tac-gia.html"><a href="v-tac-gia.html"><i class="fa fa-check"></i>Về tác giả</a></li>
<li class="part"><span><b>I Các kiến thức cơ bản</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Khoa học dữ liệu và nghề phân tích dữ liệu</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#khoa-hoc-d-liu"><i class="fa fa-check"></i><b>1.1</b> Khoa học dữ liệu</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#tai-sao-phan-tich-d-liu-la-ngh-kho"><i class="fa fa-check"></i><b>1.2</b> Tại sao phân tích dữ liệu là nghề khó?</a></li>
</ul></li>
<li class="part"><span><b>II Ứng dụng thực tế</b></span></li>
<li class="chapter" data-level="2" data-path="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html"><a href="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html"><i class="fa fa-check"></i><b>2</b> Các phương pháp phân tích dữ liệu thực tế ứng dụng với R</a><ul>
<li class="chapter" data-level="2.1" data-path="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html"><a href="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html#phn-1"><i class="fa fa-check"></i><b>2.1</b> Phần 1</a></li>
<li class="chapter" data-level="2.2" data-path="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html"><a href="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html#phn-2"><i class="fa fa-check"></i><b>2.2</b> Phần 2</a></li>
<li class="chapter" data-level="2.3" data-path="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html"><a href="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html#phn-3"><i class="fa fa-check"></i><b>2.3</b> Phần 3</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><i class="fa fa-check"></i><b>3</b> Ngữ pháp của biến đổi dữ liệu với DPLYR</a><ul>
<li class="chapter" data-level="3.1" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#gii-thiu-v-pipe-operator"><i class="fa fa-check"></i><b>3.1</b> Giới thiệu về pipe operator</a></li>
<li class="chapter" data-level="3.2" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#cac-ham-co-ban-trong-dplyr"><i class="fa fa-check"></i><b>3.2</b> Các hàm cơ bản trong dplyr</a><ul>
<li class="chapter" data-level="3.2.1" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#nhom-cau-lnh-truy-vn-d-liu"><i class="fa fa-check"></i><b>3.2.1</b> Nhóm câu lệnh truy vấn dữ liệu</a></li>
<li class="chapter" data-level="3.2.2" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#nhom-cau-lnh-bin-i-d-liu"><i class="fa fa-check"></i><b>3.2.2</b> Nhóm câu lệnh biến đổi dữ liệu</a></li>
<li class="chapter" data-level="3.2.3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#nhom-ham-tng-hp-d-liu-vi-summarise"><i class="fa fa-check"></i><b>3.2.3</b> Nhóm hàm tổng hợp dữ liệu với <code>summarise</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#cac-ham-nang-cao-trong-dplyr"><i class="fa fa-check"></i><b>3.3</b> Các hàm nâng cao trong dplyr</a><ul>
<li class="chapter" data-level="3.3.1" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#iu-kin-phan-nhom-vi-case_when"><i class="fa fa-check"></i><b>3.3.1</b> Điều kiện phân nhóm với <code>case_when</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#tao-them-bin-mi-theo-iu-kin-vi-mutate_if-mutate_at"><i class="fa fa-check"></i><b>3.3.2</b> Tạo thêm biến mới theo điều kiện với <code>mutate_if</code> &amp; <code>mutate_at</code></a></li>
<li class="chapter" data-level="3.3.3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#tng-hp-d-liu-theo-iu-kin-vi-summarise_at-va-summarise_if"><i class="fa fa-check"></i><b>3.3.3</b> Tổng hợp dữ liệu theo điều kiện với <code>summarise_at</code> và <code>summarise_if</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html"><i class="fa fa-check"></i><b>4</b> Phân rã và xoay chiều dữ liệu</a><ul>
<li class="chapter" data-level="4.1" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#phan-ra-d-liu-thanh-dang-doc-vi-gather"><i class="fa fa-check"></i><b>4.1</b> Phân rã dữ liệu thành dạng dọc với <code>gather</code></a></li>
<li class="chapter" data-level="4.2" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#xoay-chiu-d-liu-vi-spread"><i class="fa fa-check"></i><b>4.2</b> Xoay chiều dữ liệu với <code>spread</code></a></li>
<li class="chapter" data-level="4.3" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#tach-mt-bin-thanh-nhiu-bin-vi-separate"><i class="fa fa-check"></i><b>4.3</b> Tách một biến thành nhiều biến với <code>separate</code></a></li>
<li class="chapter" data-level="4.4" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#gp-nhiu-bin-thanh-mt-bin-vi-unite"><i class="fa fa-check"></i><b>4.4</b> Gộp nhiều biến thành một biến với <code>unite</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html"><i class="fa fa-check"></i><b>5</b> Lập trình chức năng hàm với purrr</a><ul>
<li class="chapter" data-level="5.1" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#nhom-ham-map"><i class="fa fa-check"></i><b>5.1</b> Nhóm hàm map</a></li>
<li class="chapter" data-level="5.2" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#sa-i-gia-tri-vi-modify"><i class="fa fa-check"></i><b>5.2</b> Sửa đổi giá trị với <code>modify</code></a></li>
<li class="chapter" data-level="5.3" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#ng-dung"><i class="fa fa-check"></i><b>5.3</b> Ứng dụng</a><ul>
<li class="chapter" data-level="5.3.1" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#bin-i-d-liu-vi-modify-va-map_df"><i class="fa fa-check"></i><b>5.3.1</b> Biến đổi dữ liệu với <code>modify</code> và <code>map_df</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#phan-tich-nhiu-nhom-khac-nhau-cung-luc"><i class="fa fa-check"></i><b>5.3.2</b> Phân tích nhiều nhóm khác nhau cùng lúc</a></li>
<li class="chapter" data-level="5.3.3" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#phan-tich-nhiu-bin-trong-dataframe-cung-luc"><i class="fa fa-check"></i><b>5.3.3</b> Phân tích nhiều biến trong dataframe cùng lúc</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Machine Learning</b></span></li>
<li class="chapter" data-level="6" data-path="khai-quat-v-hoc-may.html"><a href="khai-quat-v-hoc-may.html"><i class="fa fa-check"></i><b>6</b> Khái quát về học máy</a><ul>
<li class="chapter" data-level="6.1" data-path="khai-quat-v-hoc-may.html"><a href="khai-quat-v-hoc-may.html#gii-thiu"><i class="fa fa-check"></i><b>6.1</b> Giới thiệu</a></li>
<li class="chapter" data-level="6.2" data-path="khai-quat-v-hoc-may.html"><a href="khai-quat-v-hoc-may.html#quy-trinh-xay-dng-mo-hinh-d-bao"><i class="fa fa-check"></i><b>6.2</b> Quy trình xây dựng mô hình dự báo</a></li>
<li class="chapter" data-level="6.3" data-path="khai-quat-v-hoc-may.html"><a href="khai-quat-v-hoc-may.html#cac-nhom-thut-ng-cn-nh"><i class="fa fa-check"></i><b>6.3</b> Các nhóm thuật ngữ cần nhớ</a></li>
<li class="chapter" data-level="6.4" data-path="khai-quat-v-hoc-may.html"><a href="khai-quat-v-hoc-may.html#luu-y"><i class="fa fa-check"></i><b>6.4</b> Lưu ý</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html"><i class="fa fa-check"></i><b>7</b> Phân tích giỏ hàng</a><ul>
<li class="chapter" data-level="7.1" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#cac-khai-nim-co-ban"><i class="fa fa-check"></i><b>7.1</b> Các khái niệm cơ bản</a></li>
<li class="chapter" data-level="7.2" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#cach-thc-hin-mo-hinh"><i class="fa fa-check"></i><b>7.2</b> Cách thực hiện mô hình</a></li>
<li class="chapter" data-level="7.3" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#ba-cau-hoi-khi-phan-tich-gio-hang"><i class="fa fa-check"></i><b>7.3</b> Ba câu hỏi khi phân tích giỏ hàng</a><ul>
<li class="chapter" data-level="7.3.1" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#cac-san-phm-nao-hay-uc-mua-cung-nhau"><i class="fa fa-check"></i><b>7.3.1</b> Các sản phẩm nào hay được mua cùng nhau</a></li>
<li class="chapter" data-level="7.3.2" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#khach-hang-mua-san-phm-a-thi-se-mua-san-phm-nao-tip-theo"><i class="fa fa-check"></i><b>7.3.2</b> Khách hàng mua sản phẩm A thì sẽ mua sản phẩm nào tiếp theo?</a></li>
<li class="chapter" data-level="7.3.3" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#khach-hang-mua-san-phm-gi-thi-se-mua-tip-san-phm-a"><i class="fa fa-check"></i><b>7.3.3</b> Khách hàng mua sản phẩm gì thì sẽ mua tiếp sản phẩm A?</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#uu-nhuc-im"><i class="fa fa-check"></i><b>7.4</b> Ưu nhược điểm</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="feature-engineering.html"><a href="feature-engineering.html"><i class="fa fa-check"></i><b>8</b> Feature Engineering</a><ul>
<li class="chapter" data-level="8.1" data-path="feature-engineering.html"><a href="feature-engineering.html#feature-engineering-cho-cac-bin-nhom"><i class="fa fa-check"></i><b>8.1</b> Feature engineering cho các biến nhóm</a><ul>
<li class="chapter" data-level="8.1.1" data-path="feature-engineering.html"><a href="feature-engineering.html#tao-d-liu-gia-dummy-data-cho-bin-khong-phan-bit-th-t"><i class="fa fa-check"></i><b>8.1.1</b> Tạo dữ liệu giả (dummy data) cho biến không phân biệt thứ tự</a></li>
<li class="chapter" data-level="8.1.2" data-path="feature-engineering.html"><a href="feature-engineering.html#d-liu-co-rt-nhiu-nhom"><i class="fa fa-check"></i><b>8.1.2</b> Dữ liệu có rất nhiều nhóm</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="feature-engineering.html"><a href="feature-engineering.html#cac-bin-lien-tuc"><i class="fa fa-check"></i><b>8.2</b> Các biến liên tục</a><ul>
<li class="chapter" data-level="8.2.1" data-path="feature-engineering.html"><a href="feature-engineering.html#bin-i-11"><i class="fa fa-check"></i><b>8.2.1</b> Biến đổi 1:1</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Chuỗi thời gian</b></span></li>
<li class="chapter" data-level="9" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html"><i class="fa fa-check"></i><b>9</b> Giới thiệu về chuỗi thời gian</a><ul>
<li class="chapter" data-level="9.1" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#thanh-phn-cua-chui-thi-gian"><i class="fa fa-check"></i><b>9.1</b> Thành phần của chuỗi thời gian</a></li>
</ul></li>
<li class="part"><span><b>V Case study</b></span></li>
<li class="chapter" data-level="10" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html"><i class="fa fa-check"></i><b>10</b> Trực quan hóa dữ liệu</a><ul>
<li class="chapter" data-level="10.1" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html#xay-dng-phu-ban-hang-theo-tng-nhom"><i class="fa fa-check"></i><b>10.1</b> Xây dựng phễu bán hàng theo từng nhóm</a></li>
<li class="chapter" data-level="10.2" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html#ve-biu--warterfall-cho-aciveinactive-users"><i class="fa fa-check"></i><b>10.2</b> Vẽ biểu đồ warterfall cho acive/inactive users</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="more-to-say.html"><a href="more-to-say.html"><i class="fa fa-check"></i><b>A</b> More to Say</a></li>
<li class="chapter" data-level="" data-path="tai-liu-tham-khao.html"><a href="tai-liu-tham-khao.html"><i class="fa fa-check"></i>Tài liệu tham khảo</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Phân tích dữ liệu thực tế với R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="phan-ra-va-xoay-chiu-d-liu" class="section level1">
<h1><span class="header-section-number">Chương 4</span> Phân rã và xoay chiều dữ liệu</h1>
<p>Khi phân tích dữ liệu, dữ liệu sau khi được làm sạch thường cơ bản có hai dạng.</p>
<ul>
<li>Dạng ngang: Mỗi dòng ứng với 1 quan sát và nhiều biến</li>
<li>Dạng dọc: Nhiều dòng có thể chứa cùng một quan sát nhưng với các biến khác nhau.</li>
</ul>
<p>Xem hai ví dụ về dữ liệu dạng ngang và dọc ở dưới đây.</p>
<table>
<thead>
<tr class="header">
<th align="right">id</th>
<th align="left">Species</th>
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">setosa</td>
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">setosa</td>
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">setosa</td>
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">setosa</td>
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="right">id</th>
<th align="left">Species</th>
<th align="left">Measurement</th>
<th align="right">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="left">Sepal.Length</td>
<td align="right">5.1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="left">Sepal.Width</td>
<td align="right">3.5</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="left">Petal.Length</td>
<td align="right">1.4</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">setosa</td>
<td align="left">Petal.Width</td>
<td align="right">0.2</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="left">Sepal.Length</td>
<td align="right">4.9</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="left">Sepal.Width</td>
<td align="right">3.0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="left">Petal.Length</td>
<td align="right">1.4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">setosa</td>
<td align="left">Petal.Width</td>
<td align="right">0.2</td>
</tr>
</tbody>
</table>
<p>Trong thực tế, chúng ta phải sử dụng rất linh hoạt cả hai định dạng dữ liệu này (dữ liệu ngang và dữ liệu dọc). Trong chương này, chúng ta sẽ học cách sử dụng và biến đổi dữ liệu giữa hai định dạng với <code>tidyr</code>.</p>
<div id="phan-ra-d-liu-thanh-dang-doc-vi-gather" class="section level2">
<h2><span class="header-section-number">4.1</span> Phân rã dữ liệu thành dạng dọc với <code>gather</code></h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb103-2" data-line-number="2">data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb103-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> name_of_key,</a>
<a class="sourceLine" id="cb103-4" data-line-number="4">         <span class="dt">value =</span> name_of_value_variable,</a>
<a class="sourceLine" id="cb103-5" data-line-number="5">         <span class="dt">gather =</span> <span class="kw">c</span>(list_of_var))</a></code></pre></div>
<p>Xem ví dụ sau.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb104-2" data-line-number="2">df &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb104-3" data-line-number="3"><span class="st">  </span><span class="kw">head</span>(<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb104-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb104-5" data-line-number="5"><span class="st">  </span><span class="kw">select</span>(<span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) </a>
<a class="sourceLine" id="cb104-6" data-line-number="6">df  </a></code></pre></div>
<pre><code>##   id Species Sepal.Length Sepal.Width Petal.Length
## 1  1  setosa          5.1         3.5          1.4
## 2  2  setosa          4.9         3.0          1.4
##   Petal.Width
## 1         0.2
## 2         0.2</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1"><span class="co"># Xoay dữ liệu sang dạng dọc</span></a>
<a class="sourceLine" id="cb106-2" data-line-number="2">df2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb106-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> Measurement, </a>
<a class="sourceLine" id="cb106-4" data-line-number="4">       <span class="dt">value =</span> Value, </a>
<a class="sourceLine" id="cb106-5" data-line-number="5">       <span class="kw">c</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>)) <span class="co"># Các biến được phân rã</span></a>
<a class="sourceLine" id="cb106-6" data-line-number="6">df2</a></code></pre></div>
<pre><code>##   id Species  Measurement Value
## 1  1  setosa Sepal.Length   5.1
## 2  2  setosa Sepal.Length   4.9
## 3  1  setosa  Sepal.Width   3.5
## 4  2  setosa  Sepal.Width   3.0
## 5  1  setosa Petal.Length   1.4
## 6  2  setosa Petal.Length   1.4
## 7  1  setosa  Petal.Width   0.2
## 8  2  setosa  Petal.Width   0.2</code></pre>
<p>Ở ví dụ trên, khi phân rã dữ liệu sang dạng dọc, các biến được phân rã là 4 biến ở vị trí từ <code>3 đến 6</code>. Do dữ liệu gốc <code>df</code> chỉ có 2 quan sát, nên dữ liệu mới sau khi phân rã sẽ có 8 quan sát.</p>
</div>
<div id="xoay-chiu-d-liu-vi-spread" class="section level2">
<h2><span class="header-section-number">4.2</span> Xoay chiều dữ liệu với <code>spread</code></h2>
<p>Ngược lại với phân rã dữ liệu là xoay chiều dữ liệu. Trong <code>tidyr</code>, ta có thể sử dụng hàm <code>spread</code>. Công thức tổng quát để xoay chiều dữ liệu như sau.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="st">  </span><span class="co">#Biến được xoay thành cột</span></a>
<a class="sourceLine" id="cb108-3" data-line-number="3"><span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> key_variable, </a>
<a class="sourceLine" id="cb108-4" data-line-number="4">         <span class="co"># Biến giá trị</span></a>
<a class="sourceLine" id="cb108-5" data-line-number="5">         <span class="dt">value =</span> value_variable) </a></code></pre></div>
<p>Ta quay trở lại ví dụ ở phần trước vói dữ liệu <code>df2</code> đã được phân rã.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1">df2</a></code></pre></div>
<pre><code>##   id Species  Measurement Value
## 1  1  setosa Sepal.Length   5.1
## 2  2  setosa Sepal.Length   4.9
## 3  1  setosa  Sepal.Width   3.5
## 4  2  setosa  Sepal.Width   3.0
## 5  1  setosa Petal.Length   1.4
## 6  2  setosa Petal.Length   1.4
## 7  1  setosa  Petal.Width   0.2
## 8  2  setosa  Petal.Width   0.2</code></pre>
<p>Ta có thể xoay chiều dữ liệu lại như sau.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" data-line-number="1">df2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb111-2" data-line-number="2"><span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> Measurement, </a>
<a class="sourceLine" id="cb111-3" data-line-number="3">         <span class="dt">value =</span> Value)</a></code></pre></div>
<pre><code>##   id Species Petal.Length Petal.Width Sepal.Length
## 1  1  setosa          1.4         0.2          5.1
## 2  2  setosa          1.4         0.2          4.9
##   Sepal.Width
## 1         3.5
## 2         3.0</code></pre>
</div>
<div id="tach-mt-bin-thanh-nhiu-bin-vi-separate" class="section level2">
<h2><span class="header-section-number">4.3</span> Tách một biến thành nhiều biến với <code>separate</code></h2>
<p>Khi phân tích dữ liệu, ta thường xuyên phải tách một biến thành nhiều biến. Khi đó, việc tách biến sẽ trở nên rất đơn giản với hàm <code>separate</code>. Công thức tổng quát của <code>separate</code> như sau:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-2" data-line-number="2"><span class="st">  </span><span class="kw">separate</span>(var_to_spread, <span class="kw">c</span>(<span class="st">&quot;new_var1&quot;</span>, </a>
<a class="sourceLine" id="cb113-3" data-line-number="3">                            <span class="st">&quot;new_var2&quot;</span>, ...))</a></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">date =</span> <span class="kw">c</span>(<span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb114-2" data-line-number="2">                          <span class="st">&quot;2018-07-01&quot;</span>, </a>
<a class="sourceLine" id="cb114-3" data-line-number="3">                          <span class="st">&quot;2018-09-02&quot;</span>))</a>
<a class="sourceLine" id="cb114-4" data-line-number="4">df</a></code></pre></div>
<pre><code>##         date
## 1       &lt;NA&gt;
## 2 2018-07-01
## 3 2018-09-02</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" data-line-number="1"><span class="co"># Tách biến date thành 3 biến</span></a>
<a class="sourceLine" id="cb116-2" data-line-number="2">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb116-3" data-line-number="3"><span class="st">  </span><span class="kw">separate</span>(date, <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;date&quot;</span>))</a></code></pre></div>
<pre><code>##   year month date
## 1 &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;
## 2 2018    07   01
## 3 2018    09   02</code></pre>
</div>
<div id="gp-nhiu-bin-thanh-mt-bin-vi-unite" class="section level2">
<h2><span class="header-section-number">4.4</span> Gộp nhiều biến thành một biến với <code>unite</code></h2>
<p>Ngược lại với <code>spread</code>, ta có thể gộp nhiều biến thành một với <code>unite</code>. Công thức tổng quát của <code>unite</code> như sau.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb118-2" data-line-number="2"><span class="st">  </span><span class="kw">unite</span>(new_var, var_<span class="dv">1</span>, var2,...)</a></code></pre></div>
<p>Trong đó, <code>var_1</code>, <code>var_2</code> là tên các biến sẽ được gộp. <code>new_var</code> là tên biến mới được tạo thành.</p>
<p>Quay trở lại ví dụ trên.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">date =</span> <span class="kw">c</span>(<span class="st">&quot;2018-07-01&quot;</span>, <span class="st">&quot;2018-09-02&quot;</span>)) <span class="op">%&gt;%</span><span class="st">   </span><span class="kw">separate</span>(date, <span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>, <span class="st">&quot;date&quot;</span>))</a>
<a class="sourceLine" id="cb119-2" data-line-number="2">df</a></code></pre></div>
<pre><code>##   year month date
## 1 2018    07   01
## 2 2018    09   02</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1"><span class="co"># Gộp nhiều biến</span></a>
<a class="sourceLine" id="cb121-2" data-line-number="2">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-3" data-line-number="3"><span class="st">  </span><span class="kw">unite</span>(full_date, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, </a>
<a class="sourceLine" id="cb121-4" data-line-number="4">        <span class="dt">sep =</span> <span class="st">&quot;/&quot;</span>,</a>
<a class="sourceLine" id="cb121-5" data-line-number="5">        <span class="dt">remove =</span> F)</a></code></pre></div>
<pre><code>##    full_date year month date
## 1 2018/07/01 2018    07   01
## 2 2018/09/02 2018    09   02</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lp-trinh-chc-nang-ham-vi-purrr.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/04-phan-ra-va-xoay-chieu-du-lieu.Rmd",
"text": "Edit"
},
"download": ["bookdown.pdf", "bookdown.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
