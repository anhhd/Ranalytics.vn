---
title: "Tổ chức dữ liệu với spread và gather trong tidyverse"
author: "Nguyen Hai Truong"
date: "2019-05-15"
summary: "Sử dụng spread và gather trong tidyr thay thế cho reshape2"
banner: "img/banners/banner-41.png"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = F, message = F)
```

Trong quá trình phân tích dữ liệu, sẽ có lúc chúng ta muốn nhìn dữ liệu theo các chiều khác nhau. Trong bài viết này, `Ranalytics` sẽ hướng dẫn các bạn cách tổ chức dữ liệu theo cách  mà chúng ta mong muốn bằng việc sử dụng hàm `gather()` và `spread()` trong package `tidyverse`. 

# gather

Sử dụng dữ liệu giả định, bao gồm tổng điểm thi cuối năm 5 môn: Toán, Lý, Hóa, Anh, Văn của 3 bạn học sinh cấp 3 vào năm 2017, 2018.

```{r}
library(tibble)
table1 <- tibble(
  student = c("Viet", "Nam", "Quoc"),
  `2017` = c(37.5, 40, 45),
  `2018` = c(40, 40, 42.5)
)

table1
```

Giả sử bây giờ chúng ta muốn tổ chức dữ liệu theo một cách khác.

Chúng ta sẽ nhóm 2 biến `2017` và `2018` thành giá trị của biến mới, sẽ đặt tên là `year`, còn biến chứa những giá trị của biến `2017` và `2018` lúc đầu sẽ được đặt tên là `total_score` (tổng điểm)

Chúng ta sẽ sử dụng hàm `gather()` trong package `tidyverse` như sau:


```{r}
library(tidyverse)
table2 <- table1 %>% 
  gather(
    `2017`, `2018`,   # 2 biến cần nhóm lại (gather) 
    key = "year",     # Biến mới `year` bao gồm 2 giá trị 2017,2018
    value = "total_score"  # Biến mới `total_score` chứa giá trị của 2 biến `2017` và `2018` ban đầu
  )

table2
```

Quá trình biến đổi dữ liệu vừa rồi được mô tả bằng hình ảnh sau: 

![](/img/blog/20190515_gather_flow.png)

---

# spread

Spreading là quá trình ngược lại của gathering.

Cấu trúc hàm `spread()` như sau:

```{r}
table2 %>% 
  spread(
    key = year,   # spread biến year (các giá trị trong biến year thành các biến mới)
    value = total_score 
  )
```

---

Như vậy, chúng ta đã vừa được học cách tổ chức dữ liệu theo cách mà chúng ta mong muốn bằng việc sử dụng hàm `gather()` và `spread()` trong package `tidyverse`. Chúc các bạn học tập và làm việc hiệu quả với ``Ranalytics.vn``!
