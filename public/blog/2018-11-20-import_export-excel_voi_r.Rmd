---
title: "Import và Export dữ liệu từ Excel vào R"
author: "Nguyễn Hải Trường"
date: "2018-11-20"
categories:
  - Data import
tags:
  - Data Import
summary: "Cách import và export excel vào R"
banner: "img/banners/banner-22.png"
---


Để có thể thực hiện phân tích dữ liệu, trước tiên chúng ta cần phải có dữ liệu, mà dữ liệu có thể có từ nhiều nguồn khác nhau và được lưu trữ dưới các định dạng file khác nhau như `.txt`, `.csv`, `.xlsx`, hay database... Trong bài viết này, `Ranalytics` sẽ hướng dẫn các bạn cách import và export dữ liệu từ file Excel vào `R`.



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Excel to R

Để import file Excel vào `R`, chúng ta có thể sử dụng package `readxl`.

```{r, warning=F, message=F}
library(readxl)
library(dplyr)
```


Giả sử, chúng ta đang có 1 file Excel `datasets.xlsx` có sẵn trong thư mục package `readxl` trong đường dẫn sau:

```{r, warning=F, message=F}
path <- readxl_example("datasets.xlsx")
path
```

---

![](/img/blog/20181120_excel_file_datasets.gif)

---

File Excel `datasets.xlsx` có 4 sheets: `iris`, `mtcars`, `chickwts`, `quakes`.

Bây giờ để import dữ liệu `iris` (sheet đầu tiên trong file Excel này) vào `R`, chúng ta sẽ sử dụng hàm `read_excel()` với câu lệnh như sau:

```{r, warning=F, message=F}
iris <- read_excel(path, # đường dẫn
                   sheet = 1 # số thứ tự sheet
                   )

iris %>% 
  as.data.frame %>% 
  head
```

Tương tự như vậy, nếu chúng ta muốn import dữ liệu `mtcars` (sheet thứ 2 trong file Excel) vào `R`, chúng ta chỉ cần chọn option `sheet = 2`.

```{r, warning=F, message=F}
mtcars <- read_excel(path, # đường dẫn
                     sheet = 2 # số thứ tự sheet
                     )

mtcars %>% 
  as.data.frame %>% 
  head
```


Như vậy, để import dữ liệu của tất cả các sheet trong file Excel vào `R`, chúng ta có thể import từng sheet trong file Excel đó vào `R` bằng việc sử dụng câu lệnh ở trên. Tuy nhiên, việc làm "manual" đó chỉ thích hợp với trường hợp file Excel chỉ gồm 1 vài sheet, còn đối với những trường hợp file Excel bao gồm cả hàng chục hoặc hàng trăm sheet thì chúng ta cần một giải pháp khác thông minh hơn để xử lý vấn đề trên.

Để giải quyết vấn đề trên, chúng ta có thể dùng cách sau:


```{r, warning=F, message=F}

library(openxlsx) # package cần dùng
wb_obj <- loadWorkbook(path) # thống kê những sheets có trong file excel
sheet_names <- sheets(wb_obj) # tên của các sheets
for (i in 1:length(sheet_names)) {
  
  # Đối với lần lượt từng sheet trong file excel, câu lệnh sẽ import thành 1 data frame trong R với tên tương ứng theo từng sheet
  assign(sheet_names[i], readWorkbook(wb_obj, sheet = i))
  
}


```


---

![](/img/blog/20181120_import_all_excel_sheets_into_r.gif)

---

Kết quả: Tất cả các sheet trong file Excel sẽ được import vào `R` thành các data frame tương ứng (trong Global Environment).


# R to Excel

Như vậy, chúng ta đã biết làm thế nào để import dữ liệu từ file Excel vào `R`. Câu hỏi đặt ra lúc này là: Vậy làm thế nào để export dữ liệu từ `R` ra file Excel?

Câu trả lời là: Dùng hàm `write.xlsx()` trong package `xlsx`.

```{r, warning=F, message=F, eval = F}
library(xlsx)
write.xlsx(iris, # tên data 
           file = paste0(getwd(),"/","iris_data.xlsx"), # đường dẫn
           row.names = F
           )

```

---

![](/img/blog/20181120_export_r_to_excel.gif)

Tuy nhiên, với cách sử dụng `xlsx`, máy tính đòi hỏi phải cài đặt Java. Do đó, hiện này có một cách thuận tiện hơn, đó là sử dụng package `writexl`

```{r, eval = F}
library(writexl)
writexl::write_xlsx(iris, path = "./iris_data.xlsx")
```


---

Kết quả: Dữ liệu `iris` đã được export từ `R` sang Excel (file `iris_data.xlsx`).

Như vậy, chúng ta đã vừa được học cách import và export dữ liệu từ Excel vào `R`. 
Chúc các bạn học tập và làm việc hiệu quả với `Ranalytics.vn`!