---
title: "Tổng hợp nhiều biến với hàm summarise"
author: "Nguyễn Hải Trường"
date: '2019-03-25'
categories:
  - data-manipulation
tags:
  - dplyr
summary: "Sử dụng hàm summarise trong dplyr"
banner: "img/banners/banner-35.png"
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = F, message = F)
```

Trong quá trình phân tích dữ liệu sẽ có thể phát sinh việc chúng ta muốn summarise nhiều biến cùng lúc trong tập dữ liệu. Trong bài viết này, `Ranalytics` sẽ hướng dẫn các bạn cách sử dụng nhóm hàm `summarise_if()`, `summarise_at()`, `summarise_all()` để xử lý vấn đề trên.

---

Về cơ bản, nhóm hàm trên sử dụng khi chúng ta muốn summarise nhiều biến cùng lúc, còn sự khác biệt của nhóm hàm trên là:

- `summarise_all()`: áp dụng đối với tất cả các biến trong tập dữ liệu

- `summarise_at()`: chỉ áp dụng đối với những biến nhất định mà chúng ta chỉ định

- `summarise_if()`: chỉ áp dụng đối với những biến thỏa mãn những điều kiện mà chúng ta đã đặt ra.


Sử dụng dữ liệu `iris` có sẵn trong `R`. Dữ liệu bao gồm những thông số (đơn vị: cm) về chiều dài/rộng cánh hoa và đài hoa của 3 loài hoa: `setosa`, `versicolor`, `virginica` (150 quan sát).

```{r}
# Package sử dụng
library(dplyr)
library(knitr)

# Summary dữ liệu
iris %>% summary

# 6 quan sát đầu tiên của tập dữ liệu
iris %>% 
  head %>% 
  kable()
```

Giả sử chúng ta muốn xem trung bình chiều dài, rộng cánh hoa và đài hoa của từng loài hoa: setosa, versicolor, virginica -> dùng `summarise_all()`.

```{r}
iris %>%
  group_by(Species) %>%
  summarise_all(list(average = mean)  # average - đuôi tên của những biến mới, mean - hàm tính trung bình
                ) %>% 
  kable()
```

Nếu chúng ta chỉ muốn xem trung bình chiều dài, rộng của đài hoa của từng loài hoa -> sử dụng `summarise_at()`.

```{r}
iris %>%
  group_by(Species) %>%
  summarise_at(c("Sepal.Length", "Sepal.Width"), # chỉ áp dụng với 2 này
               list(average = mean) # average - đuôi tên của những biến mới, mean - hàm tính trung bình
               ) %>% 
  kable()
```

Còn trong trường hợp, chúng ta muốn summarise chỉ số mean của những biến số (numeric) -> dùng `summarise_if()`.


```{r}
iris %>%
  group_by(Species) %>%
  summarise_if(is.numeric,  # chỉ áp dụng đối với những biến numeric
               list(average = mean) # average - đuôi tên của những biến mới, mean - hàm tính trung bình
               ) %>% 
  kable()
```

---

Như vậy, chúng ta đã vừa được học cách summarise nhiều biến cùng 1 lúc bằng việc sử dụng nhóm hàm `summarise_if()`, `summarise_at()`, `summarise_all()` trong `dplyr`. Chúc các bạn học tập và làm việc hiệu quả với ``Ranalytics.vn``!