<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chương 6 Lập trình chức năng hàm với purrr | Phân tích dữ liệu thực tế với R</title>
  <meta name="description" content="Chương 6 Lập trình chức năng hàm với purrr | Phân tích dữ liệu thực tế với R" />
  <meta name="generator" content="bookdown 0.11.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Chương 6 Lập trình chức năng hàm với purrr | Phân tích dữ liệu thực tế với R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chương 6 Lập trình chức năng hàm với purrr | Phân tích dữ liệu thực tế với R" />
  <meta name="github-repo" content="yihui/bookdown-crc" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chương 6 Lập trình chức năng hàm với purrr | Phân tích dữ liệu thực tế với R" />
  
  <meta name="twitter:description" content="Chương 6 Lập trình chức năng hàm với purrr | Phân tích dữ liệu thực tế với R" />
  

<meta name="author" content="Hoàng Đức Anh" />


<meta name="date" content="2019-07-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lp-trinh-ham.html">
<link rel="next" href="bin-i-d-liu-text.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Phân tích dữ liệu thực tế với R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="li-m-u.html"><a href="li-m-u.html"><i class="fa fa-check"></i>Lời mở đầu</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Khoa học dữ liệu và nghề phân tích dữ liệu</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#khoa-hoc-d-liu-la-gi"><i class="fa fa-check"></i><b>1.1</b> Khoa học dữ liệu là gì</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#tai-sao-phan-tich-d-liu-la-ngh-kho"><i class="fa fa-check"></i><b>1.2</b> Tại sao phân tích dữ liệu là nghề khó?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#phan-loai-hoat-ng-phan-tich-d-liu"><i class="fa fa-check"></i><b>1.3</b> Phân loại hoạt động phân tích dữ liệu</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#da-theo-cach-thc-tac-ng-n-khach-hang"><i class="fa fa-check"></i><b>1.3.1</b> Dựa theo cách thức tác động đến khách hàng</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#da-theo-c-tinh-cua-ngh-phan-tich-d-liu"><i class="fa fa-check"></i><b>1.3.2</b> Dựa theo đặc tính của nghề phân tích dữ liệu</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#da-theo-chu-ky-cua-khach-hang-i-vi-san-phm"><i class="fa fa-check"></i><b>1.3.3</b> Dựa theo chu kỳ của khách hàng đối với sản phẩm</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#cach-xay-dng-nhom-phan-tich-d-liu"><i class="fa fa-check"></i><b>1.4</b> Cách xây dựng nhóm phân tích dữ liệu</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#luu-y-khi-oc-tai-liu"><i class="fa fa-check"></i><b>1.5</b> Lưu ý khi đọc tài liệu</a></li>
</ul></li>
<li class="part"><span><b>I Kỹ thuật phân tích dữ liệu thực tế</b></span></li>
<li class="chapter" data-level="2" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><i class="fa fa-check"></i><b>2</b> Ngữ pháp của biến đổi dữ liệu với DPLYR</a><ul>
<li class="chapter" data-level="2.1" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#gii-thiu-v-pipe-operator"><i class="fa fa-check"></i><b>2.1</b> Giới thiệu về pipe operator</a></li>
<li class="chapter" data-level="2.2" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#cac-ham-co-ban-trong-dplyr"><i class="fa fa-check"></i><b>2.2</b> Các hàm cơ bản trong dplyr</a><ul>
<li class="chapter" data-level="2.2.1" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#nhom-cau-lnh-truy-vn-d-liu"><i class="fa fa-check"></i><b>2.2.1</b> Nhóm câu lệnh truy vấn dữ liệu</a></li>
<li class="chapter" data-level="2.2.2" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#nhom-cau-lnh-bin-i-d-liu"><i class="fa fa-check"></i><b>2.2.2</b> Nhóm câu lệnh biến đổi dữ liệu</a></li>
<li class="chapter" data-level="2.2.3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#nhom-ham-tng-hp-d-liu-vi-summarise"><i class="fa fa-check"></i><b>2.2.3</b> Nhóm hàm tổng hợp dữ liệu với <code>summarise</code></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#cac-ham-nang-cao-trong-dplyr"><i class="fa fa-check"></i><b>2.3</b> Các hàm nâng cao trong dplyr</a><ul>
<li class="chapter" data-level="2.3.1" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#iu-kin-phan-nhom-vi-case_when"><i class="fa fa-check"></i><b>2.3.1</b> Điều kiện phân nhóm với <code>case_when</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#tao-them-bin-mi-theo-iu-kin-vi-mutate_if-mutate_at"><i class="fa fa-check"></i><b>2.3.2</b> Tạo thêm biến mới theo điều kiện với <code>mutate_if</code> &amp; <code>mutate_at</code></a></li>
<li class="chapter" data-level="2.3.3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#tng-hp-d-liu-theo-iu-kin-vi-summarise_at-va-summarise_if"><i class="fa fa-check"></i><b>2.3.3</b> Tổng hợp dữ liệu theo điều kiện với <code>summarise_at</code> và <code>summarise_if</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html"><i class="fa fa-check"></i><b>3</b> Phân rã và xoay chiều dữ liệu</a><ul>
<li class="chapter" data-level="3.1" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#phan-ra-d-liu-thanh-dang-doc-vi-gather"><i class="fa fa-check"></i><b>3.1</b> Phân rã dữ liệu thành dạng dọc với <code>gather</code></a></li>
<li class="chapter" data-level="3.2" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#xoay-chiu-d-liu-vi-spread"><i class="fa fa-check"></i><b>3.2</b> Xoay chiều dữ liệu với <code>spread</code></a></li>
<li class="chapter" data-level="3.3" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#tach-mt-bin-thanh-nhiu-bin-vi-separate"><i class="fa fa-check"></i><b>3.3</b> Tách một biến thành nhiều biến với <code>separate</code></a></li>
<li class="chapter" data-level="3.4" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#gp-nhiu-bin-thanh-mt-bin-vi-unite"><i class="fa fa-check"></i><b>3.4</b> Gộp nhiều biến thành một biến với <code>unite</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cac-chi-s-thng-ke-mo-ta-co-ban.html"><a href="cac-chi-s-thng-ke-mo-ta-co-ban.html"><i class="fa fa-check"></i><b>4</b> Các chỉ số thống kê mô tả cơ bản</a><ul>
<li class="chapter" data-level="4.1" data-path="cac-chi-s-thng-ke-mo-ta-co-ban.html"><a href="cac-chi-s-thng-ke-mo-ta-co-ban.html#correlation"><i class="fa fa-check"></i><b>4.1</b> Correlation</a></li>
<li class="chapter" data-level="4.2" data-path="cac-chi-s-thng-ke-mo-ta-co-ban.html"><a href="cac-chi-s-thng-ke-mo-ta-co-ban.html#anova"><i class="fa fa-check"></i><b>4.2</b> ANOVA</a></li>
<li class="chapter" data-level="4.3" data-path="cac-chi-s-thng-ke-mo-ta-co-ban.html"><a href="cac-chi-s-thng-ke-mo-ta-co-ban.html#kim-inh-quan-h-chi-binh-phuong"><i class="fa fa-check"></i><b>4.3</b> Kiểm định quan hệ Chi-bình phương</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html"><i class="fa fa-check"></i><b>5</b> Lập trình hàm</a><ul>
<li class="chapter" data-level="5.1" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html#quotes-vs.-unquotes"><i class="fa fa-check"></i><b>5.1</b> <strong>Quotes</strong> vs. <strong>Unquotes</strong></a></li>
<li class="chapter" data-level="5.2" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html#trung-hp-dung-quo_name"><i class="fa fa-check"></i><b>5.2</b> Trường hợp dùng <code>quo_name</code></a></li>
<li class="chapter" data-level="5.3" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html#trung-hop-nhiu-bin"><i class="fa fa-check"></i><b>5.3</b> Trường họp nhiều biến</a></li>
<li class="chapter" data-level="5.4" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html#ng-dung"><i class="fa fa-check"></i><b>5.4</b> Ứng dụng</a><ul>
<li class="chapter" data-level="5.4.1" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html#ham-tinh-toan-tng-hp-nhiu-bin"><i class="fa fa-check"></i><b>5.4.1</b> Hàm tính toán tổng hợp nhiều biến</a></li>
<li class="chapter" data-level="5.4.2" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html#ve--thi-vi-ggplot2"><i class="fa fa-check"></i><b>5.4.2</b> Vẽ đồ thị với ggplot2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html"><i class="fa fa-check"></i><b>6</b> Lập trình chức năng hàm với purrr</a><ul>
<li class="chapter" data-level="6.1" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#nhom-ham-map"><i class="fa fa-check"></i><b>6.1</b> Nhóm hàm map</a></li>
<li class="chapter" data-level="6.2" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#sa-i-gia-tri-vi-modify"><i class="fa fa-check"></i><b>6.2</b> Sửa đổi giá trị với <code>modify</code></a></li>
<li class="chapter" data-level="6.3" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#tao-ham-nhanh-vi-as_mapper"><i class="fa fa-check"></i><b>6.3</b> Tạo hàm nhanh với <code>as_mapper</code></a></li>
<li class="chapter" data-level="6.4" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#xay-dng-chui-cac-ham-lien-tip-vi-compose"><i class="fa fa-check"></i><b>6.4</b> Xây dựng chuỗi các hàm liên tiếp với <code>compose</code></a></li>
<li class="chapter" data-level="6.5" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#ng-dung-1"><i class="fa fa-check"></i><b>6.5</b> Ứng dụng</a><ul>
<li class="chapter" data-level="6.5.1" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#bin-i-d-liu-vi-modify-va-map_df"><i class="fa fa-check"></i><b>6.5.1</b> Biến đổi dữ liệu với <code>modify</code> và <code>map_df</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#phan-tich-nhiu-nhom-khac-nhau-cung-luc"><i class="fa fa-check"></i><b>6.5.2</b> Phân tích nhiều nhóm khác nhau cùng lúc</a></li>
<li class="chapter" data-level="6.5.3" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#phan-tich-nhiu-bin-trong-dataframe-cung-luc"><i class="fa fa-check"></i><b>6.5.3</b> Phân tích nhiều biến trong dataframe cùng lúc</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html"><i class="fa fa-check"></i><b>7</b> Biến đổi dữ liệu text</a><ul>
<li class="chapter" data-level="7.1" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#gii-thiu"><i class="fa fa-check"></i><b>7.1</b> Giới thiệu</a></li>
<li class="chapter" data-level="7.2" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#regular-expression"><i class="fa fa-check"></i><b>7.2</b> Regular expression</a><ul>
<li class="chapter" data-level="7.2.1" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#metadata"><i class="fa fa-check"></i><b>7.2.1</b> Metadata</a></li>
<li class="chapter" data-level="7.2.2" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#sequences"><i class="fa fa-check"></i><b>7.2.2</b> Sequences</a></li>
<li class="chapter" data-level="7.2.3" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#character-class"><i class="fa fa-check"></i><b>7.2.3</b> Character class</a></li>
<li class="chapter" data-level="7.2.4" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#posix-class"><i class="fa fa-check"></i><b>7.2.4</b> POSIX class</a></li>
<li class="chapter" data-level="7.2.5" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#quantifiers"><i class="fa fa-check"></i><b>7.2.5</b> Quantifiers</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#cac-vi-du-tng-hp"><i class="fa fa-check"></i><b>7.3</b> Các ví dụ tổng hợp</a><ul>
<li class="chapter" data-level="7.3.1" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#vi-du-1"><i class="fa fa-check"></i><b>7.3.1</b> Ví dụ 1</a></li>
<li class="chapter" data-level="7.3.2" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#vi-du-2"><i class="fa fa-check"></i><b>7.3.2</b> Ví dụ 2</a></li>
<li class="chapter" data-level="7.3.3" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#vi-du-3"><i class="fa fa-check"></i><b>7.3.3</b> Ví dụ 3</a></li>
<li class="chapter" data-level="7.3.4" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#vi-du-4"><i class="fa fa-check"></i><b>7.3.4</b> Ví dụ 4</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#tai-liu-tham-khao"><i class="fa fa-check"></i><b>7.4</b> Tài liệu tham khảo</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="quan-ly-kt-qua-phan-tich-t-nhiu-mo-hinh.html"><a href="quan-ly-kt-qua-phan-tich-t-nhiu-mo-hinh.html"><i class="fa fa-check"></i><b>8</b> Quản lý kết quả phân tích từ nhiều mô hình</a></li>
<li class="chapter" data-level="9" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html"><i class="fa fa-check"></i><b>9</b> Các nguyên lý dự báo</a><ul>
<li class="chapter" data-level="9.1" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#gii-thiu-1"><i class="fa fa-check"></i><b>9.1</b> Giới thiệu</a><ul>
<li class="chapter" data-level="9.1.1" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#cac-nhanh-trong-hoc-may-machine-learning"><i class="fa fa-check"></i><b>9.1.1</b> Các nhánh trong học máy (machine learning)</a></li>
<li class="chapter" data-level="9.1.2" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#cach-xay-dng-mo-hinh"><i class="fa fa-check"></i><b>9.1.2</b> Cách xây dựng mô hình</a></li>
<li class="chapter" data-level="9.1.3" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#s-dung-mo-hinh"><i class="fa fa-check"></i><b>9.1.3</b> Sử dụng mô hình</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#cac-nguyen-ly-trong-d-bao"><i class="fa fa-check"></i><b>9.2</b> Các nguyên lý trong dự báo</a><ul>
<li class="chapter" data-level="9.2.1" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#reducible-vs.-irreducible-error"><i class="fa fa-check"></i><b>9.2.1</b> Reducible vs. irreducible error</a></li>
<li class="chapter" data-level="9.2.2" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#kha-nang-giai-thich-va-kha-nang-d-bao"><i class="fa fa-check"></i><b>9.2.2</b> Khả năng giải thích và khả năng dự báo</a></li>
<li class="chapter" data-level="9.2.3" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#mo-hinh-co-tham-s-cho-truc-hoc-khong-co-tham-s-cho-truc-parametric-vs.-nonparametric"><i class="fa fa-check"></i><b>9.2.3</b> Mô hình có tham số cho trước hoặc không có tham số cho trước (Parametric vs. Nonparametric)</a></li>
<li class="chapter" data-level="9.2.4" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#nguyen-ly-ch-u"><i class="fa fa-check"></i><b>9.2.4</b> Nguyên lý chữ U</a></li>
<li class="chapter" data-level="9.2.5" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#bias-variance-trade-off"><i class="fa fa-check"></i><b>9.2.5</b> Bias Variance Trade-Off</a></li>
<li class="chapter" data-level="9.2.6" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#overfitting-regularization"><i class="fa fa-check"></i><b>9.2.6</b> Overfitting &amp; regularization</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#quy-trinh-xay-dng-mo-hinh-d-bao"><i class="fa fa-check"></i><b>9.3</b> Quy trình xây dựng mô hình dự báo</a></li>
<li class="chapter" data-level="9.4" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#ensemble-methods"><i class="fa fa-check"></i><b>9.4</b> Ensemble methods</a></li>
<li class="chapter" data-level="9.5" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#luu-y"><i class="fa fa-check"></i><b>9.5</b> Lưu ý</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html"><i class="fa fa-check"></i><b>10</b> Mô hình OLS</a><ul>
<li class="chapter" data-level="10.1" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#gii-thiu-2"><i class="fa fa-check"></i><b>10.1</b> Giới thiệu</a></li>
<li class="chapter" data-level="10.2" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#xay-dng-mo-hinh-co-ban"><i class="fa fa-check"></i><b>10.2</b> Xây dựng mô hình cơ bản</a><ul>
<li class="chapter" data-level="10.2.1" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#mo-hinh-hi-quy-on-bin"><i class="fa fa-check"></i><b>10.2.1</b> Mô hình hồi quy đơn biến</a></li>
<li class="chapter" data-level="10.2.2" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#din-giai-mo-hinh"><i class="fa fa-check"></i><b>10.2.2</b> Diễn giải mô hình</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#anh-gia-cht-lung-mo-hinh"><i class="fa fa-check"></i><b>10.3</b> Đánh giá chất lượng mô hình</a><ul>
<li class="chapter" data-level="10.3.1" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#sai-s-cua-mo-hinh"><i class="fa fa-check"></i><b>10.3.1</b> Sai số của mô hình</a></li>
<li class="chapter" data-level="10.3.2" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#r-binh-phuong-r2"><i class="fa fa-check"></i><b>10.3.2</b> R bình phương <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="10.3.3" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#f-statistic"><i class="fa fa-check"></i><b>10.3.3</b> F statistic</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#d-bao"><i class="fa fa-check"></i><b>10.4</b> Dự báo</a></li>
<li class="chapter" data-level="10.5" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#thut-toan-ti-uu-vi-gradient-decent"><i class="fa fa-check"></i><b>10.5</b> Thuật toán tối ưu với gradient decent</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html"><i class="fa fa-check"></i><b>11</b> Mô hình hồi quy logistic</a><ul>
<li class="chapter" data-level="11.1" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#cach-xay-dng-mo-hinh-1"><i class="fa fa-check"></i><b>11.1</b> Cách xây dựng mô hình</a></li>
<li class="chapter" data-level="11.2" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#vi-du-xay-dng-mo-hinh-on-gian"><i class="fa fa-check"></i><b>11.2</b> Ví dụ xây dựng mô hình đơn giản</a></li>
<li class="chapter" data-level="11.3" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#cac-chi-s-cn-quan-tam-khac"><i class="fa fa-check"></i><b>11.3</b> Các chỉ số cần quan tâm khác</a></li>
<li class="chapter" data-level="11.4" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#anh-gia-cht-lung-mo-hinh-1"><i class="fa fa-check"></i><b>11.4</b> Đánh giá chất lượng mô hình</a><ul>
<li class="chapter" data-level="11.4.1" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#confusion-matrix"><i class="fa fa-check"></i><b>11.4.1</b> Confusion Matrix</a></li>
<li class="chapter" data-level="11.4.2" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#roc"><i class="fa fa-check"></i><b>11.4.2</b> ROC</a></li>
<li class="chapter" data-level="11.4.3" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#gain-va-lift"><i class="fa fa-check"></i><b>11.4.3</b> Gain và Lift</a></li>
<li class="chapter" data-level="11.4.4" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#kolmogorovsmirnov-statistics"><i class="fa fa-check"></i><b>11.4.4</b> Kolmogorov–Smirnov statistics</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#thc-hanh"><i class="fa fa-check"></i><b>11.5</b> Thực hành</a><ul>
<li class="chapter" data-level="11.5.1" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#d-liu"><i class="fa fa-check"></i><b>11.5.1</b> Dữ liệu</a></li>
<li class="chapter" data-level="11.5.2" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#xay-dng-mo-hinh-tren-tp-d-liu-gc"><i class="fa fa-check"></i><b>11.5.2</b> Xây dựng mô hình trên tập dữ liệu gốc</a></li>
<li class="chapter" data-level="11.5.3" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#xay-dng-mo-hinh-tren-hai-tp-train-va-test"><i class="fa fa-check"></i><b>11.5.3</b> Xây dựng mô hình trên hai tập train và test</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#xay-dng-mo-hinh-logistics-theo-machine-learning"><i class="fa fa-check"></i><b>11.6</b> Xây dựng mô hình Logistics theo Machine Learning</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="cay-quyt-inh.html"><a href="cay-quyt-inh.html"><i class="fa fa-check"></i><b>12</b> Cây quyết định</a><ul>
<li class="chapter" data-level="12.1" data-path="cay-quyt-inh.html"><a href="cay-quyt-inh.html#gii-thiu-3"><i class="fa fa-check"></i><b>12.1</b> Giới thiệu</a></li>
<li class="chapter" data-level="12.2" data-path="cay-quyt-inh.html"><a href="cay-quyt-inh.html#regression-trees"><i class="fa fa-check"></i><b>12.2</b> Regression Trees</a></li>
<li class="chapter" data-level="12.3" data-path="cay-quyt-inh.html"><a href="cay-quyt-inh.html#classification-trees"><i class="fa fa-check"></i><b>12.3</b> Classification Trees</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="bagging-boosting-va-random-forest.html"><a href="bagging-boosting-va-random-forest.html"><i class="fa fa-check"></i><b>13</b> Bagging - Boosting và Random Forest</a><ul>
<li class="chapter" data-level="13.1" data-path="bagging-boosting-va-random-forest.html"><a href="bagging-boosting-va-random-forest.html#bagging"><i class="fa fa-check"></i><b>13.1</b> Bagging</a></li>
<li class="chapter" data-level="13.2" data-path="bagging-boosting-va-random-forest.html"><a href="bagging-boosting-va-random-forest.html#random-forests"><i class="fa fa-check"></i><b>13.2</b> Random Forests</a></li>
<li class="chapter" data-level="13.3" data-path="bagging-boosting-va-random-forest.html"><a href="bagging-boosting-va-random-forest.html#boosting"><i class="fa fa-check"></i><b>13.3</b> Boosting</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>14</b> Unsupervised learning</a></li>
<li class="chapter" data-level="15" data-path="k-means.html"><a href="k-means.html"><i class="fa fa-check"></i><b>15</b> k-means</a><ul>
<li class="chapter" data-level="15.1" data-path="k-means.html"><a href="k-means.html#gii-thiu-4"><i class="fa fa-check"></i><b>15.1</b> Giới thiệu</a></li>
<li class="chapter" data-level="15.2" data-path="k-means.html"><a href="k-means.html#thut-toan"><i class="fa fa-check"></i><b>15.2</b> Thuật toán</a></li>
<li class="chapter" data-level="15.3" data-path="k-means.html"><a href="k-means.html#uu-nhuc-im-cua-k-means"><i class="fa fa-check"></i><b>15.3</b> Ưu nhược điểm của K-means</a></li>
<li class="chapter" data-level="15.4" data-path="k-means.html"><a href="k-means.html#thc-hanh-tren-r"><i class="fa fa-check"></i><b>15.4</b> Thực hành trên R</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html"><i class="fa fa-check"></i><b>16</b> Phân tích giỏ hàng</a><ul>
<li class="chapter" data-level="16.1" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#cac-khai-nim-co-ban"><i class="fa fa-check"></i><b>16.1</b> Các khái niệm cơ bản</a></li>
<li class="chapter" data-level="16.2" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#cach-thc-hin-mo-hinh"><i class="fa fa-check"></i><b>16.2</b> Cách thực hiện mô hình</a></li>
<li class="chapter" data-level="16.3" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#ba-cau-hoi-khi-phan-tich-gio-hang"><i class="fa fa-check"></i><b>16.3</b> Ba câu hỏi khi phân tích giỏ hàng</a><ul>
<li class="chapter" data-level="16.3.1" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#cac-san-phm-nao-hay-uc-mua-cung-nhau"><i class="fa fa-check"></i><b>16.3.1</b> Các sản phẩm nào hay được mua cùng nhau</a></li>
<li class="chapter" data-level="16.3.2" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#khach-hang-mua-san-phm-a-thi-se-mua-san-phm-nao-tip-theo"><i class="fa fa-check"></i><b>16.3.2</b> Khách hàng mua sản phẩm A thì sẽ mua sản phẩm nào tiếp theo?</a></li>
<li class="chapter" data-level="16.3.3" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#khach-hang-mua-san-phm-gi-thi-se-mua-tip-san-phm-a"><i class="fa fa-check"></i><b>16.3.3</b> Khách hàng mua sản phẩm gì thì sẽ mua tiếp sản phẩm A?</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#uu-nhuc-im"><i class="fa fa-check"></i><b>16.4</b> Ưu nhược điểm</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="feature-engineering.html"><a href="feature-engineering.html"><i class="fa fa-check"></i><b>17</b> Feature Engineering</a><ul>
<li class="chapter" data-level="17.1" data-path="feature-engineering.html"><a href="feature-engineering.html#feature-engineering-cho-cac-bin-nhom"><i class="fa fa-check"></i><b>17.1</b> Feature engineering cho các biến nhóm</a><ul>
<li class="chapter" data-level="17.1.1" data-path="feature-engineering.html"><a href="feature-engineering.html#tao-d-liu-gia-dummy-data-cho-bin-khong-phan-bit-th-t"><i class="fa fa-check"></i><b>17.1.1</b> Tạo dữ liệu giả (dummy data) cho biến không phân biệt thứ tự</a></li>
<li class="chapter" data-level="17.1.2" data-path="feature-engineering.html"><a href="feature-engineering.html#d-liu-co-rt-nhiu-nhom"><i class="fa fa-check"></i><b>17.1.2</b> Dữ liệu có rất nhiều nhóm</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="feature-engineering.html"><a href="feature-engineering.html#cac-bin-lien-tuc"><i class="fa fa-check"></i><b>17.2</b> Các biến liên tục</a><ul>
<li class="chapter" data-level="17.2.1" data-path="feature-engineering.html"><a href="feature-engineering.html#bin-i-11"><i class="fa fa-check"></i><b>17.2.1</b> Biến đổi 1:1</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Chuỗi thời gian</b></span></li>
<li class="chapter" data-level="18" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html"><i class="fa fa-check"></i><b>18</b> Giới thiệu về chuỗi thời gian</a><ul>
<li class="chapter" data-level="18.1" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#thanh-phn-cua-chui-thi-gian"><i class="fa fa-check"></i><b>18.1</b> Thành phần của chuỗi thời gian</a></li>
<li class="chapter" data-level="18.2" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#d-liu-chui-thi-gian"><i class="fa fa-check"></i><b>18.2</b> Dữ liệu chuỗi thời gian</a></li>
<li class="chapter" data-level="18.3" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#smoothing"><i class="fa fa-check"></i><b>18.3</b> Smoothing</a></li>
<li class="chapter" data-level="18.4" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#seasonal-decomposition"><i class="fa fa-check"></i><b>18.4</b> Seasonal decomposition</a></li>
<li class="chapter" data-level="18.5" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#exponential-forecasting-model"><i class="fa fa-check"></i><b>18.5</b> Exponential Forecasting Model</a><ul>
<li class="chapter" data-level="18.5.1" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#single-exponential-model"><i class="fa fa-check"></i><b>18.5.1</b> Single Exponential Model</a></li>
<li class="chapter" data-level="18.5.2" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#hold-holt-winters-exponential-smoothing"><i class="fa fa-check"></i><b>18.5.2</b> Hold &amp; Holt-Winters exponential smoothing</a></li>
<li class="chapter" data-level="18.5.3" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#t-ng-xay-dng-mo-hinh"><i class="fa fa-check"></i><b>18.5.3</b> Tự động xây dựng mô hình</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="mo-hinh-arima.html"><a href="mo-hinh-arima.html"><i class="fa fa-check"></i><b>19</b> Mô hình ARIMA</a><ul>
<li class="chapter" data-level="19.1" data-path="mo-hinh-arima.html"><a href="mo-hinh-arima.html#chui-thi-gian-dng"><i class="fa fa-check"></i><b>19.1</b> Chuỗi thời gian dừng</a></li>
<li class="chapter" data-level="19.2" data-path="mo-hinh-arima.html"><a href="mo-hinh-arima.html#mo-hinh-arima-1"><i class="fa fa-check"></i><b>19.2</b> Mô hình ARIMA</a></li>
<li class="chapter" data-level="19.3" data-path="mo-hinh-arima.html"><a href="mo-hinh-arima.html#vi-du-vi-r"><i class="fa fa-check"></i><b>19.3</b> Ví dụ với R</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html"><a href="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html"><i class="fa fa-check"></i><b>20</b> Phân tích chuỗi thời gian với tidyquant và timetk</a><ul>
<li class="chapter" data-level="20.1" data-path="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html"><a href="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html#ly-d-liu-vi-package-tidyquant"><i class="fa fa-check"></i><b>20.1</b> Lấy dữ liệu với package tidyquant</a></li>
<li class="chapter" data-level="20.2" data-path="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html"><a href="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html#trc-quan-hoa-vi-geom_ma"><i class="fa fa-check"></i><b>20.2</b> Trực quan hóa với <code>geom_ma</code></a></li>
<li class="chapter" data-level="20.3" data-path="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html"><a href="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html#chuyn-t-dataframe-thanh-xts"><i class="fa fa-check"></i><b>20.3</b> Chuyển từ dataframe thành xts</a></li>
</ul></li>
<li class="part"><span><b>III Case study</b></span></li>
<li class="chapter" data-level="21" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html"><i class="fa fa-check"></i><b>21</b> Trực quan hóa dữ liệu</a><ul>
<li class="chapter" data-level="21.1" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html#xay-dng-phu-ban-hang-theo-tng-nhom"><i class="fa fa-check"></i><b>21.1</b> Xây dựng phễu bán hàng theo từng nhóm</a></li>
<li class="chapter" data-level="21.2" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html#ve-biu--warterfall-cho-aciveinactive-users"><i class="fa fa-check"></i><b>21.2</b> Vẽ biểu đồ warterfall cho acive/inactive users</a></li>
<li class="chapter" data-level="21.3" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html#xay-dng-biu--lollipop-chart"><i class="fa fa-check"></i><b>21.3</b> Xây dựng biểu đồ lollipop chart</a></li>
<li class="chapter" data-level="21.4" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html#trc-quan-hoa-cac-phn-trung-lp-nhau"><i class="fa fa-check"></i><b>21.4</b> Trực quan hóa các phần trùng lặp nhau</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="cac-meo-trong-r.html"><a href="cac-meo-trong-r.html"><i class="fa fa-check"></i><b>22</b> Các mẹo trong R</a><ul>
<li class="chapter" data-level="22.1" data-path="cac-meo-trong-r.html"><a href="cac-meo-trong-r.html#hin-thi-s-binh-thung"><i class="fa fa-check"></i><b>22.1</b> Hiển thị số bình thường</a></li>
<li class="chapter" data-level="22.2" data-path="cac-meo-trong-r.html"><a href="cac-meo-trong-r.html#export-d-liu-ra-excel"><i class="fa fa-check"></i><b>22.2</b> Export dữ liệu ra excel</a></li>
<li class="chapter" data-level="22.3" data-path="cac-meo-trong-r.html"><a href="cac-meo-trong-r.html#lam-vic-khi-proxy-bi-chn"><i class="fa fa-check"></i><b>22.3</b> Làm việc khi proxy bị chặn</a></li>
<li class="chapter" data-level="22.4" data-path="cac-meo-trong-r.html"><a href="cac-meo-trong-r.html#t-ng-render-ra-kt-qua-phan-tich"><i class="fa fa-check"></i><b>22.4</b> Tự động render ra kết quả phân tích</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Anh Hoang Duc</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Phân tích dữ liệu thực tế với R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lp-trinh-chc-nang-ham-vi-purrr" class="section level1">
<h1><span class="header-section-number">Chương 6</span> Lập trình chức năng hàm với purrr</h1>
<p>Khi phân tích dữ liệu phức tạp, ta thường xuyên phải thực hiện một nhóm các phân tích tương tự nhau cho các nhóm dữ liệu khác nhau. Việc sử dụng các hàm làm đơn vị thao tác cơ bản và phối hợp các hàm với nhau được gọi là lập trình chức năng hàm (functional programming). Để đơn giản, ta xét ví dụ sau.</p>
<p>Sử dụng tập dữ liệu <code>iris</code>, với mỗi nhóm của <code>Species</code>, xây dựng mô hình hồi quy giữa <code>Sepal.Length</code> và <code>Petal.Length</code>, so sánh giá trị <code>r.squared</code> giữa các mô hình.</p>
<p>Với cách làm thông thường, ta sẽ phải thức hiện theo thứ tự sau:</p>
<ul>
<li>Tạo các data.frame cho từng giá trị của Species</li>
<li>Với mỗi data.frame vừa tạo, xây dựng mô hình <code>lm</code></li>
<li>Với mỗi mô hình vừa tạo, chiết xuất giá trị <code>r.squared</code> và lưu vào một data.frame</li>
</ul>
<p>Cách triển khai trên có thể sử dụng vòng lặp trong R với phương án như sau</p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb215-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb215-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb215-2"></a><span class="kw">library</span>(purrr)</span>
<span id="cb215-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb215-3"></a></span>
<span id="cb215-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb215-4"></a>category &lt;-<span class="st"> </span>iris<span class="op">$</span>Species <span class="op">%&gt;%</span><span class="st"> </span>levels <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()</span>
<span id="cb215-5"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb215-5"></a>model_result &lt;-<span class="st"> </span><span class="kw">data.frame</span>()</span>
<span id="cb215-6"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb215-6"></a><span class="cf">for</span> (i <span class="cf">in</span> category){</span>
<span id="cb215-7"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb215-7"></a>  df &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Species <span class="op">==</span><span class="st"> </span>i)</span>
<span id="cb215-8"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb215-8"></a>  model &lt;-<span class="st"> </span><span class="kw">lm</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width, <span class="dt">data =</span> df)</span>
<span id="cb215-9"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb215-9"></a>  model_summary &lt;-<span class="st"> </span><span class="kw">summary</span>(model)</span>
<span id="cb215-10"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb215-10"></a>  df_temp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">species =</span> i,</span>
<span id="cb215-11"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb215-11"></a>                        <span class="dt">r.square =</span> model_summary<span class="op">$</span>r.squared)</span>
<span id="cb215-12"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb215-12"></a>  model_result &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(model_result, df_temp)</span>
<span id="cb215-13"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb215-13"></a>}</span></code></pre>
<p>Tuy nhiên, với lập trình chức năng hàm, ta có thể làm rất đơn giản như sau.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb216-1"></a><span class="kw">library</span>(purrr)</span>
<span id="cb216-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb216-2"></a>iris <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb216-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb216-3"></a><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>Species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb216-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb216-4"></a><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">lm</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width, <span class="dt">data =</span> .)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb216-5"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb216-5"></a><span class="st">  </span><span class="kw">map</span>(summary) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb216-6"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb216-6"></a><span class="st">  </span><span class="kw">map_dbl</span>(<span class="st">&quot;r.squared&quot;</span>)</span></code></pre>
<pre><code>##     setosa versicolor  virginica 
##  0.5513756  0.2765821  0.2090573</code></pre>
<p>Trong chương này, chúng ta sẽ tìm hiểu các cách thức cơ bản lập trình chức năng hàm với R qua package <code>purrr</code>. Việc nắm vững kiến thức và kỹ năng lập trình hàm có rất nhiều ứng dụng trong công việc phân tích, giúp giảm thiểu rất lớn thời gian phân tích, làm cho quá trình phân tích mạch lạc hơn rất nhiều trong các bài toán khám phá dữ liệu</p>
<div id="nhom-ham-map" class="section level2">
<h2><span class="header-section-number">6.1</span> Nhóm hàm map</h2>
<p>Công thức tổng quát của nhóm hàm map</p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb218-1"></a><span class="kw">map</span>(.x, .f, ...)</span></code></pre>
<p><strong>Giải thích</strong>: Với mỗi giá trị của <code>.x</code>, thực hiện <code>.f</code>. Trong đó, x là một list.</p>
<p>Hàm map làm hàm tổng quát, ngoài ra, <code>map</code> còn có các biến thể chính sau</p>
<table style="width:56%;">
<colgroup>
<col width="18%" />
<col width="37%" />
</colgroup>
<thead>
<tr class="header">
<th>Câu lệnh</th>
<th>Kết quả</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>map</code></td>
<td>list</td>
</tr>
<tr class="even">
<td><code>map_dbl</code></td>
<td>vector dạng double</td>
</tr>
<tr class="odd">
<td><code>map_int</code></td>
<td>vector dạng int</td>
</tr>
<tr class="even">
<td><code>map_chr</code></td>
<td>vector dạng character</td>
</tr>
<tr class="odd">
<td><code>map_df</code></td>
<td>data.frame</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb219-1"></a><span class="co"># Dạng list</span></span>
<span id="cb219-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb219-2"></a>iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map</span>(class)</span></code></pre>
<pre><code>## $Sepal.Length
## [1] &quot;numeric&quot;
## 
## $Sepal.Width
## [1] &quot;numeric&quot;
## 
## $Petal.Length
## [1] &quot;numeric&quot;
## 
## $Petal.Width
## [1] &quot;numeric&quot;
## 
## $Species
## [1] &quot;factor&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb221-1"></a><span class="co"># Dạng char</span></span>
<span id="cb221-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb221-2"></a>iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_chr</span>(class)</span></code></pre>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
##    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot;    &quot;numeric&quot;     &quot;factor&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb223-1"></a><span class="co"># Dạng data.frame</span></span>
<span id="cb223-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb223-2"></a>iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_df</span>(class)</span></code></pre>
<pre><code>## # A tibble: 1 x 5
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##   &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;  
## 1 numeric      numeric     numeric      numeric     factor</code></pre>
<p><strong>Map theo điều kiện với <code>map_if</code> và <code>map_at</code></strong></p>
<p>Tương tự với <code>map</code>, nhóm <code>map_if</code> và <code>map_at</code> cho phép tính toán theo điều kiện hoặc vị trí của list. Xem ví dụ sau.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb225-1"></a><span class="co"># map_if</span></span>
<span id="cb225-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb225-2"></a>iris <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb225-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb225-3"></a><span class="st">  </span><span class="kw">map_if</span>(is.numeric, as.character) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb225-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb225-4"></a><span class="st">  </span>as.data.frame <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb225-5"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb225-5"></a><span class="st">  </span>str</span></code></pre>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  5 variables:
##  $ Sepal.Length: Factor w/ 35 levels &quot;4.3&quot;,&quot;4.4&quot;,&quot;4.5&quot;,..: 9 7 5 4 8 12 4 8 2 7 ...
##  $ Sepal.Width : Factor w/ 23 levels &quot;2&quot;,&quot;2.2&quot;,&quot;2.3&quot;,..: 15 10 12 11 16 19 14 14 9 11 ...
##  $ Petal.Length: Factor w/ 43 levels &quot;1&quot;,&quot;1.1&quot;,&quot;1.2&quot;,..: 5 5 4 6 5 8 5 6 5 6 ...
##  $ Petal.Width : Factor w/ 22 levels &quot;0.1&quot;,&quot;0.2&quot;,&quot;0.3&quot;,..: 2 2 2 2 2 4 3 2 2 1 ...
##  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb227-1"></a><span class="co"># map_at</span></span>
<span id="cb227-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb227-2"></a>iris <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb227-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb227-3"></a><span class="st">  </span><span class="kw">map_at</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), as.character) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb227-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb227-4"></a><span class="st">  </span>str</span></code></pre>
<pre><code>## List of 5
##  $ Sepal.Length: chr [1:150] &quot;5.1&quot; &quot;4.9&quot; &quot;4.7&quot; &quot;4.6&quot; ...
##  $ Sepal.Width : chr [1:150] &quot;3.5&quot; &quot;3&quot; &quot;3.2&quot; &quot;3.1&quot; ...
##  $ Petal.Length: num [1:150] 1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num [1:150] 0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<hr />
<p><strong>Lưu ý</strong>: Với trường hợp có hai biến đầu vào, có thể sử dụng nhóm hàm <code>map2</code>. Ví dụ</p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb229-1"></a><span class="co"># Không chạy</span></span>
<span id="cb229-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb229-2"></a><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>, sum)</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb230-1"></a><span class="kw">map2_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>, sum)</span></code></pre>
<pre><code>## [1] 5 7 9</code></pre>
<p>Với các trường hợp phức tạp, ta cần vận dụng linh hoạt.</p>
<p><strong>Ví dụ</strong>: Với mỗi dòng trong iris , tách thành dataframe riêng và xoay chiều dữ liêu. Tên các cột trở thành biến <code>attribute</code>, giá trị các cột trở thành biến <code>value</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb232-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb232-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb232-2"></a>get_data &lt;-<span class="st"> </span><span class="cf">function</span>(data, i){</span>
<span id="cb232-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb232-3"></a> df &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb232-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb232-4"></a><span class="st">    </span><span class="kw">slice</span>(i) <span class="op">%&gt;%</span><span class="st"> </span>t <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb232-5"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb232-5"></a><span class="st">    </span>as.data.frame</span>
<span id="cb232-6"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb232-6"></a> result &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">attribute =</span> <span class="kw">rownames</span>(df),</span>
<span id="cb232-7"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb232-7"></a>                      <span class="dt">value =</span> df[,<span class="dv">1</span>])</span>
<span id="cb232-8"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb232-8"></a> <span class="kw">rownames</span>(result) &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb232-9"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb232-9"></a> <span class="kw">return</span>(result)</span>
<span id="cb232-10"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb232-10"></a>}</span>
<span id="cb232-11"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb232-11"></a></span>
<span id="cb232-12"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb232-12"></a><span class="kw">get_data</span>(mtcars, <span class="dv">3</span>)</span></code></pre>
<pre><code>##    attribute  value
## 1        mpg  22.80
## 2        cyl   4.00
## 3       disp 108.00
## 4         hp  93.00
## 5       drat   3.85
## 6         wt   2.32
## 7       qsec  18.61
## 8         vs   1.00
## 9         am   1.00
## 10      gear   4.00
## 11      carb   1.00</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb234-1"></a><span class="kw">get_data</span>(iris, <span class="dv">1</span>)</span></code></pre>
<pre><code>##      attribute  value
## 1 Sepal.Length    5.1
## 2  Sepal.Width    3.5
## 3 Petal.Length    1.4
## 4  Petal.Width    0.2
## 5      Species setosa</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb236-1"></a><span class="kw">map2</span>(<span class="kw">replicate</span>(<span class="dv">3</span>, iris, <span class="dt">simplify =</span> F),</span>
<span id="cb236-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb236-2"></a>     <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>), get_data)</span></code></pre>
<pre><code>## [[1]]
##      attribute  value
## 1 Sepal.Length    5.1
## 2  Sepal.Width    3.5
## 3 Petal.Length    1.4
## 4  Petal.Width    0.2
## 5      Species setosa
## 
## [[2]]
##      attribute  value
## 1 Sepal.Length    4.9
## 2  Sepal.Width      3
## 3 Petal.Length    1.4
## 4  Petal.Width    0.2
## 5      Species setosa
## 
## [[3]]
##      attribute  value
## 1 Sepal.Length    4.7
## 2  Sepal.Width    3.2
## 3 Petal.Length    1.3
## 4  Petal.Width    0.2
## 5      Species setosa</code></pre>
</div>
<div id="sa-i-gia-tri-vi-modify" class="section level2">
<h2><span class="header-section-number">6.2</span> Sửa đổi giá trị với <code>modify</code></h2>
<p>Tương tự như <code>map</code>, <code>modify</code> cho áp dụng hàm vào một nhóm các list. Tuy nhiên, khác với <code>map</code>, <code>modify</code> cho ra kết quả với cấu trúc dữ liệu ban đâu.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb238-1"></a><span class="co"># map đổi cấu trúc của dataframe</span></span>
<span id="cb238-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb238-2"></a>iris <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb238-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb238-3"></a><span class="st">  </span><span class="kw">map_if</span>(is.factor, as.character) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb238-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb238-4"></a><span class="st">  </span>str</span></code></pre>
<pre><code>## List of 5
##  $ Sepal.Length: num [1:150] 5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num [1:150] 3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num [1:150] 1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num [1:150] 0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : chr [1:150] &quot;setosa&quot; &quot;setosa&quot; &quot;setosa&quot; &quot;setosa&quot; ...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb240-1"></a><span class="co"># modify giữ nguyên cấu trúc</span></span>
<span id="cb240-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb240-2"></a>iris <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb240-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb240-3"></a><span class="st">  </span><span class="kw">modify_if</span>(is.factor, as.character) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb240-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb240-4"></a><span class="st">  </span>str</span></code></pre>
<pre><code>## &#39;data.frame&#39;:    150 obs. of  5 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : chr  &quot;setosa&quot; &quot;setosa&quot; &quot;setosa&quot; &quot;setosa&quot; ...</code></pre>
</div>
<div id="tao-ham-nhanh-vi-as_mapper" class="section level2">
<h2><span class="header-section-number">6.3</span> Tạo hàm nhanh với <code>as_mapper</code></h2>
<p><code>as_mapper</code> cho phép tạo hàm nhanh, đặc biệt hữu ích khi ta chỉ muốn tạo và sử dụng một hàm trong một vài trường hợp đặc biệt.</p>
<p>Công thức tổng quát</p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb242-1"></a><span class="co"># Với một tham số</span></span>
<span id="cb242-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb242-2"></a><span class="kw">as_mapper</span>(<span class="op">~</span><span class="kw">f</span>(.x))</span>
<span id="cb242-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb242-3"></a><span class="co"># Với hai tham số</span></span>
<span id="cb242-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb242-4"></a><span class="kw">as_mapper</span>(<span class="kw">f</span>(.x, .y))</span></code></pre>
<p>Xem các ví dụ sau:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb243-1"></a><span class="co"># Cộng 10 vào mỗi giá trị</span></span>
<span id="cb243-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb243-2"></a><span class="kw">map_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="op">~</span><span class="st"> </span>.x<span class="op">+</span><span class="dv">10</span>)</span></code></pre>
<pre><code>## [1] 11 12 13</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb245-1"></a><span class="co"># Cộng hai vector với nhau</span></span>
<span id="cb245-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb245-2"></a><span class="kw">map2_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">5</span><span class="op">:</span><span class="dv">7</span>, <span class="op">~</span>.x <span class="op">+</span><span class="st"> </span>.y)</span></code></pre>
<pre><code>## [1]  6  8 10</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb247-1"></a><span class="co"># Cách viết khác</span></span>
<span id="cb247-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb247-2"></a><span class="kw">map2_dbl</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">5</span><span class="op">:</span><span class="dv">7</span>, <span class="kw">as_mapper</span>(<span class="op">~</span>.x <span class="op">+</span><span class="st"> </span>.y))</span></code></pre>
<pre><code>## [1]  6  8 10</code></pre>
</div>
<div id="xay-dng-chui-cac-ham-lien-tip-vi-compose" class="section level2">
<h2><span class="header-section-number">6.4</span> Xây dựng chuỗi các hàm liên tiếp với <code>compose</code></h2>
<p>Hàm <code>compose</code> cho phép kết hợp nhiều hàm với nhau với hàm ở bên phải là input đầu vào cho hàm bên trái. Cấu trúc như sau.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb249-1"></a><span class="kw">compose</span>(f_<span class="dv">2</span>, f_<span class="dv">1</span>) </span>
<span id="cb249-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb249-2"></a><span class="co"># Tương đương với</span></span>
<span id="cb249-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb249-3"></a>argument <span class="op">%&gt;%</span><span class="st"> </span>f_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span>f_<span class="dv">1</span></span></code></pre>
<p>Xem ví dụ sau:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb250-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb250-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb250-2"></a><span class="kw">library</span>(broom)</span>
<span id="cb250-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb250-3"></a><span class="kw">lm</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width, <span class="dt">data =</span> iris) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb250-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb250-4"></a><span class="st">  </span>tidy</span></code></pre>
<pre><code>## # A tibble: 2 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    6.53      0.479     13.6  6.47e-28
## 2 Sepal.Width   -0.223     0.155     -1.44 1.52e- 1</code></pre>
<p>Cách viết trên có thể thay thế như sau</p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb252-1"></a>tidy_lm &lt;-<span class="st"> </span><span class="kw">compose</span>(tidy, lm)</span>
<span id="cb252-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb252-2"></a><span class="kw">tidy_lm</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width, <span class="dt">data =</span> iris)</span></code></pre>
<pre><code>## # A tibble: 2 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    6.53      0.479     13.6  6.47e-28
## 2 Sepal.Width   -0.223     0.155     -1.44 1.52e- 1</code></pre>
<p>Ta có thể thêm các nhóm hàm khác đi cùng với <code>compose</code> như <code>filter</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb254-1"></a>my_func &lt;-<span class="st"> </span><span class="kw">compose</span>(</span>
<span id="cb254-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb254-2"></a>  <span class="kw">as_mapper</span>(<span class="op">~</span><span class="kw">filter</span>(.x, p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>)),</span>
<span id="cb254-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb254-3"></a>  tidy, </span>
<span id="cb254-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb254-4"></a>  lm)</span>
<span id="cb254-5"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb254-5"></a><span class="kw">my_func</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Sepal.Width, <span class="dt">data =</span> iris)</span></code></pre>
<pre><code>## # A tibble: 1 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)     6.53     0.479      13.6 6.47e-28</code></pre>
</div>
<div id="ng-dung-1" class="section level2">
<h2><span class="header-section-number">6.5</span> Ứng dụng</h2>
<div id="bin-i-d-liu-vi-modify-va-map_df" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Biến đổi dữ liệu với <code>modify</code> và <code>map_df</code></h3>
<p>Khi phân tích dữ liệu, đôi khi ta cần chuẩn hóa dữ liệu cho tất cả các biến numeric trong data.frame. Với nhóm hàm của purrr, ta có thể thực hiện như sau</p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb256-1"></a><span class="co"># Tạo hàm</span></span>
<span id="cb256-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb256-2"></a>standardize_data &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb256-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb256-3"></a>  x &lt;-<span class="st"> </span>(x <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x))<span class="op">/</span>(<span class="kw">max</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x))</span>
<span id="cb256-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb256-4"></a>  <span class="kw">return</span>(x)</span>
<span id="cb256-5"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb256-5"></a>}</span>
<span id="cb256-6"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb256-6"></a><span class="co"># Sử dụng map_df</span></span>
<span id="cb256-7"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb256-7"></a>df &lt;-<span class="st"> </span>iris</span>
<span id="cb256-8"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb256-8"></a>df[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] &lt;-<span class="st"> </span>df[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_df</span>(standardize_data)</span>
<span id="cb256-9"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb256-9"></a>df <span class="op">%&gt;%</span><span class="st"> </span>head</span></code></pre>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1   0.22222222   0.6250000   0.06779661  0.04166667  setosa
## 2   0.16666667   0.4166667   0.06779661  0.04166667  setosa
## 3   0.11111111   0.5000000   0.05084746  0.04166667  setosa
## 4   0.08333333   0.4583333   0.08474576  0.04166667  setosa
## 5   0.19444444   0.6666667   0.06779661  0.04166667  setosa
## 6   0.30555556   0.7916667   0.11864407  0.12500000  setosa</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb258-1"></a><span class="co"># Sử dụng modify</span></span>
<span id="cb258-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb258-2"></a><span class="co"># Sử dụng map_df</span></span>
<span id="cb258-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb258-3"></a>df &lt;-<span class="st"> </span>iris</span>
<span id="cb258-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb258-4"></a>df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">modify_if</span>(is.numeric, standardize_data)</span>
<span id="cb258-5"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb258-5"></a>df <span class="op">%&gt;%</span><span class="st"> </span>head</span></code></pre>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1   0.22222222   0.6250000   0.06779661  0.04166667  setosa
## 2   0.16666667   0.4166667   0.06779661  0.04166667  setosa
## 3   0.11111111   0.5000000   0.05084746  0.04166667  setosa
## 4   0.08333333   0.4583333   0.08474576  0.04166667  setosa
## 5   0.19444444   0.6666667   0.06779661  0.04166667  setosa
## 6   0.30555556   0.7916667   0.11864407  0.12500000  setosa</code></pre>
</div>
<div id="phan-tich-nhiu-nhom-khac-nhau-cung-luc" class="section level3">
<h3><span class="header-section-number">6.5.2</span> Phân tích nhiều nhóm khác nhau cùng lúc</h3>
<p>Khi phân tích dữ liệu, đôi khi ta muốn xây dựng chuẩn phân tích dữ liệu qua một số bước, bao gồm:</p>
<ul>
<li>Tính toán các chỉ số thống kê</li>
<li>Vẽ đồ thị</li>
<li>Xây dụng mô hình đơn giản</li>
</ul>
<p>Quy trình này sẽ không gặp vấn đề khi ta chỉ phải xử lý với một nhóm nhỏ dữ liệu. Khi số lượng nhóm tăng lên, việc phân tích dữ liệu trở nên khó khăn hơn rất nhiều và tốn thời gian. Tuy nhiên, với <code>purrr</code>, các vấn đề này trở nên rất đơn giản.</p>
<p><strong>Ví dụ</strong>: Với mỗi nhóm của Species trong tập dữ liệu iris:</p>
<ul>
<li>Tổng hơp dữ liệu</li>
<li>Vẽ đồ thị điểm giữa Sepal.Length vs. Petal.Length</li>
<li>Xây dựng mô hình hồi quy Sepal.Length ~ Petal.Length</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb260-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-2"></a><span class="co"># Bước một: Xây dựng hàm</span></span>
<span id="cb260-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-3"></a>my_stat &lt;-<span class="st"> </span><span class="cf">function</span>(data){</span>
<span id="cb260-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-4"></a>  <span class="kw">print</span>(<span class="st">&quot;Summary data&quot;</span>)</span>
<span id="cb260-5"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-5"></a>  <span class="kw">print</span>(<span class="st">&quot;====================&quot;</span>)</span>
<span id="cb260-6"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-6"></a>  <span class="kw">summary</span>(data) <span class="op">%&gt;%</span><span class="st"> </span>print</span>
<span id="cb260-7"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-7"></a>  </span>
<span id="cb260-8"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-8"></a>  p &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb260-9"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-9"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Sepal.Length, Petal.Length)) <span class="op">+</span></span>
<span id="cb260-10"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-10"></a><span class="st">    </span><span class="kw">geom_point</span>() </span>
<span id="cb260-11"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-11"></a></span>
<span id="cb260-12"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-12"></a>  <span class="kw">print</span>(<span class="st">&quot;Summary model&quot;</span>)</span>
<span id="cb260-13"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-13"></a>  <span class="kw">print</span>(<span class="st">&quot;====================&quot;</span>)</span>
<span id="cb260-14"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-14"></a>  model &lt;-<span class="st"> </span><span class="kw">lm</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Petal.Length, <span class="dt">data =</span> data)</span>
<span id="cb260-15"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-15"></a>  <span class="kw">summary</span>(model) <span class="op">%&gt;%</span><span class="st"> </span>print</span>
<span id="cb260-16"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-16"></a>  p <span class="op">%&gt;%</span><span class="st"> </span>print</span>
<span id="cb260-17"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-17"></a>}</span>
<span id="cb260-18"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-18"></a><span class="co"># Test hàm</span></span>
<span id="cb260-19"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb260-19"></a><span class="kw">my_stat</span>(iris)</span></code></pre>
<pre><code>## [1] &quot;Summary data&quot;
## [1] &quot;====================&quot;
##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
##                 
## [1] &quot;Summary model&quot;
## [1] &quot;====================&quot;
## 
## Call:
## lm(formula = Sepal.Length ~ Petal.Length, data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.24675 -0.29657 -0.01515  0.27676  1.00269 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   4.30660    0.07839   54.94   &lt;2e-16 ***
## Petal.Length  0.40892    0.01889   21.65   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4071 on 148 degrees of freedom
## Multiple R-squared:   0.76,  Adjusted R-squared:  0.7583 
## F-statistic: 468.6 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><img src="07-lap-trinh-ham-voi-purrr_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb262-1"></a><span class="co"># Bước 2: Xây dựng map</span></span>
<span id="cb262-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb262-2"></a></span>
<span id="cb262-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb262-3"></a>iris<span class="op">$</span>Species <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb262-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb262-4"></a><span class="st">  </span>unique <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb262-5"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb262-5"></a><span class="st">  </span><span class="kw">map</span>(<span class="cf">function</span>(value){</span>
<span id="cb262-6"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb262-6"></a>    <span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;Analysis of &quot;</span>, value))</span>
<span id="cb262-7"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb262-7"></a>    iris <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb262-8"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb262-8"></a><span class="st">      </span><span class="kw">filter</span>(Species <span class="op">==</span><span class="st"> </span>value) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb262-9"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb262-9"></a><span class="st">      </span>my_stat</span>
<span id="cb262-10"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb262-10"></a>  })</span></code></pre>
<pre><code>## [1] &quot;Analysis of setosa&quot;
## [1] &quot;Summary data&quot;
## [1] &quot;====================&quot;
##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.300   Min.   :1.000   Min.   :0.100  
##  1st Qu.:4.800   1st Qu.:3.200   1st Qu.:1.400   1st Qu.:0.200  
##  Median :5.000   Median :3.400   Median :1.500   Median :0.200  
##  Mean   :5.006   Mean   :3.428   Mean   :1.462   Mean   :0.246  
##  3rd Qu.:5.200   3rd Qu.:3.675   3rd Qu.:1.575   3rd Qu.:0.300  
##  Max.   :5.800   Max.   :4.400   Max.   :1.900   Max.   :0.600  
##        Species  
##  setosa    :50  
##  versicolor: 0  
##  virginica : 0  
##                 
##                 
##                 
## [1] &quot;Summary model&quot;
## [1] &quot;====================&quot;
## 
## Call:
## lm(formula = Sepal.Length ~ Petal.Length, data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.57238 -0.20671 -0.03084  0.17339  0.93608 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    4.2132     0.4156  10.138 1.61e-13 ***
## Petal.Length   0.5423     0.2823   1.921   0.0607 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3432 on 48 degrees of freedom
## Multiple R-squared:  0.07138,    Adjusted R-squared:  0.05204 
## F-statistic:  3.69 on 1 and 48 DF,  p-value: 0.0607</code></pre>
<p><img src="07-lap-trinh-ham-voi-purrr_files/figure-html/unnamed-chunk-19-2.png" width="672" /></p>
<pre><code>## [1] &quot;Analysis of versicolor&quot;
## [1] &quot;Summary data&quot;
## [1] &quot;====================&quot;
##   Sepal.Length    Sepal.Width     Petal.Length   Petal.Width   
##  Min.   :4.900   Min.   :2.000   Min.   :3.00   Min.   :1.000  
##  1st Qu.:5.600   1st Qu.:2.525   1st Qu.:4.00   1st Qu.:1.200  
##  Median :5.900   Median :2.800   Median :4.35   Median :1.300  
##  Mean   :5.936   Mean   :2.770   Mean   :4.26   Mean   :1.326  
##  3rd Qu.:6.300   3rd Qu.:3.000   3rd Qu.:4.60   3rd Qu.:1.500  
##  Max.   :7.000   Max.   :3.400   Max.   :5.10   Max.   :1.800  
##        Species  
##  setosa    : 0  
##  versicolor:50  
##  virginica : 0  
##                 
##                 
##                 
## [1] &quot;Summary model&quot;
## [1] &quot;====================&quot;
## 
## Call:
## lm(formula = Sepal.Length ~ Petal.Length, data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.73479 -0.20272 -0.02065  0.26092  0.69956 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    2.4075     0.4463   5.395 2.08e-06 ***
## Petal.Length   0.8283     0.1041   7.954 2.59e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3425 on 48 degrees of freedom
## Multiple R-squared:  0.5686, Adjusted R-squared:  0.5596 
## F-statistic: 63.26 on 1 and 48 DF,  p-value: 2.586e-10</code></pre>
<p><img src="07-lap-trinh-ham-voi-purrr_files/figure-html/unnamed-chunk-19-3.png" width="672" /></p>
<pre><code>## [1] &quot;Analysis of virginica&quot;
## [1] &quot;Summary data&quot;
## [1] &quot;====================&quot;
##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.900   Min.   :2.200   Min.   :4.500   Min.   :1.400  
##  1st Qu.:6.225   1st Qu.:2.800   1st Qu.:5.100   1st Qu.:1.800  
##  Median :6.500   Median :3.000   Median :5.550   Median :2.000  
##  Mean   :6.588   Mean   :2.974   Mean   :5.552   Mean   :2.026  
##  3rd Qu.:6.900   3rd Qu.:3.175   3rd Qu.:5.875   3rd Qu.:2.300  
##  Max.   :7.900   Max.   :3.800   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    : 0  
##  versicolor: 0  
##  virginica :50  
##                 
##                 
##                 
## [1] &quot;Summary model&quot;
## [1] &quot;====================&quot;
## 
## Call:
## lm(formula = Sepal.Length ~ Petal.Length, data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.73409 -0.23643 -0.03132  0.23771  0.76207 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.05966    0.46677    2.27   0.0277 *  
## Petal.Length  0.99574    0.08367   11.90  6.3e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3232 on 48 degrees of freedom
## Multiple R-squared:  0.7469, Adjusted R-squared:  0.7416 
## F-statistic: 141.6 on 1 and 48 DF,  p-value: 6.298e-16</code></pre>
<p><img src="07-lap-trinh-ham-voi-purrr_files/figure-html/unnamed-chunk-19-4.png" width="672" /></p>
<pre><code>## [[1]]</code></pre>
<p><img src="07-lap-trinh-ham-voi-purrr_files/figure-html/unnamed-chunk-19-5.png" width="672" /></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="07-lap-trinh-ham-voi-purrr_files/figure-html/unnamed-chunk-19-6.png" width="672" /></p>
<pre><code>## 
## [[3]]</code></pre>
<p><img src="07-lap-trinh-ham-voi-purrr_files/figure-html/unnamed-chunk-19-7.png" width="672" /></p>
</div>
<div id="phan-tich-nhiu-bin-trong-dataframe-cung-luc" class="section level3">
<h3><span class="header-section-number">6.5.3</span> Phân tích nhiều biến trong dataframe cùng lúc</h3>
<p>Một biên thể khác của <code>map</code> là sử dụng trong phân tích cùng lúc nhiều biến số với một biến thuộc dạng nhóm (group). Khi lập trình với NSE, ta cần phải sử dụng hàm <code>syms()</code> trước khi <code>map</code></p>
<p><strong>Ví dụ</strong>: Với mỗi biến số trong tập dữ liệu <code>iris</code>:</p>
<ul>
<li>So sánh giá trị trung bình của biến này với các nhóm khác nhau của <code>Species</code></li>
<li>Vẽ biểu đồ boxplot</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb269-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-2"></a></span>
<span id="cb269-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-3"></a><span class="co"># Bước 1: Xây dựng hàm</span></span>
<span id="cb269-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-4"></a></span>
<span id="cb269-5"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-5"></a>my_stat &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb269-6"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-6"></a>  x &lt;-<span class="st"> </span><span class="kw">enquo</span>(x)</span>
<span id="cb269-7"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-7"></a>  iris <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb269-8"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-8"></a><span class="st">    </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb269-9"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-9"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(<span class="op">!!</span>x)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb269-10"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-10"></a><span class="st">    </span>print</span>
<span id="cb269-11"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-11"></a>  iris <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb269-12"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-12"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Species, <span class="op">!!</span>x)) <span class="op">+</span></span>
<span id="cb269-13"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-13"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Species)) <span class="op">+</span></span>
<span id="cb269-14"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-14"></a><span class="st">    </span><span class="kw">theme_minimal</span>()</span>
<span id="cb269-15"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-15"></a>}</span>
<span id="cb269-16"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb269-16"></a><span class="kw">my_stat</span>(Sepal.Length)</span></code></pre>
<pre><code>## # A tibble: 3 x 2
##   Species     mean
##   &lt;fct&gt;      &lt;dbl&gt;
## 1 setosa      5.01
## 2 versicolor  5.94
## 3 virginica   6.59</code></pre>
<p><img src="07-lap-trinh-ham-voi-purrr_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb271-1"></a><span class="co"># Bước 2: Dùng map</span></span>
<span id="cb271-2"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb271-2"></a>iris <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb271-3"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb271-3"></a><span class="st">  </span><span class="kw">select_if</span>(is.numeric) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb271-4"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb271-4"></a><span class="st">  </span>names <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb271-5"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb271-5"></a><span class="st">  </span>syms <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb271-6"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#cb271-6"></a><span class="st">  </span><span class="kw">map</span>(my_stat)</span></code></pre>
<pre><code>## # A tibble: 3 x 2
##   Species     mean
##   &lt;fct&gt;      &lt;dbl&gt;
## 1 setosa      5.01
## 2 versicolor  5.94
## 3 virginica   6.59
## # A tibble: 3 x 2
##   Species     mean
##   &lt;fct&gt;      &lt;dbl&gt;
## 1 setosa      3.43
## 2 versicolor  2.77
## 3 virginica   2.97
## # A tibble: 3 x 2
##   Species     mean
##   &lt;fct&gt;      &lt;dbl&gt;
## 1 setosa      1.46
## 2 versicolor  4.26
## 3 virginica   5.55
## # A tibble: 3 x 2
##   Species     mean
##   &lt;fct&gt;      &lt;dbl&gt;
## 1 setosa     0.246
## 2 versicolor 1.33 
## 3 virginica  2.03</code></pre>
<pre><code>## [[1]]</code></pre>
<p><img src="07-lap-trinh-ham-voi-purrr_files/figure-html/unnamed-chunk-20-2.png" width="672" /></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="07-lap-trinh-ham-voi-purrr_files/figure-html/unnamed-chunk-20-3.png" width="672" /></p>
<pre><code>## 
## [[3]]</code></pre>
<p><img src="07-lap-trinh-ham-voi-purrr_files/figure-html/unnamed-chunk-20-4.png" width="672" /></p>
<pre><code>## 
## [[4]]</code></pre>
<p><img src="07-lap-trinh-ham-voi-purrr_files/figure-html/unnamed-chunk-20-5.png" width="672" /></p>
<p><strong>Lưu ý</strong>: Việc ứng dụng <code>purrr</code> với các hàm tính toán thống kê sẽ cho phép phân tích khám phá dữ liệu hàng loạt</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lp-trinh-ham.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bin-i-d-liu-text.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"split_by": "rmd"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
