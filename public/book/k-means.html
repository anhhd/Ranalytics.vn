<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chương 14 k-means | Phân tích dữ liệu thực tế với R</title>
  <meta name="description" content="Chương 14 k-means | Phân tích dữ liệu thực tế với R" />
  <meta name="generator" content="bookdown 0.11.3 and GitBook 2.6.7" />

  <meta property="og:title" content="Chương 14 k-means | Phân tích dữ liệu thực tế với R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chương 14 k-means | Phân tích dữ liệu thực tế với R" />
  <meta name="github-repo" content="yihui/bookdown-crc" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chương 14 k-means | Phân tích dữ liệu thực tế với R" />
  
  <meta name="twitter:description" content="Chương 14 k-means | Phân tích dữ liệu thực tế với R" />
  

<meta name="author" content="Hoàng Đức Anh" />


<meta name="date" content="2019-07-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="unsupervised-learning.html">
<link rel="next" href="phan-tich-gio-hang.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Phân tích dữ liệu thực tế với R</a></li>

<li class="divider"></li>
<li class="part"><span><b>I Kỹ thuật phân tích dữ liệu thực tế</b></span></li>
<li class="chapter" data-level="1" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><i class="fa fa-check"></i><b>1</b> Ngữ pháp của biến đổi dữ liệu với DPLYR</a><ul>
<li class="chapter" data-level="1.1" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#gii-thiu-v-pipe-operator"><i class="fa fa-check"></i><b>1.1</b> Giới thiệu về pipe operator</a></li>
<li class="chapter" data-level="1.2" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#cac-ham-co-ban-trong-dplyr"><i class="fa fa-check"></i><b>1.2</b> Các hàm cơ bản trong dplyr</a><ul>
<li class="chapter" data-level="1.2.1" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#nhom-cau-lnh-truy-vn-d-liu"><i class="fa fa-check"></i><b>1.2.1</b> Nhóm câu lệnh truy vấn dữ liệu</a></li>
<li class="chapter" data-level="1.2.2" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#nhom-cau-lnh-bin-i-d-liu"><i class="fa fa-check"></i><b>1.2.2</b> Nhóm câu lệnh biến đổi dữ liệu</a></li>
<li class="chapter" data-level="1.2.3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#nhom-ham-tng-hp-d-liu-vi-summarise"><i class="fa fa-check"></i><b>1.2.3</b> Nhóm hàm tổng hợp dữ liệu với <code>summarise</code></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#cac-ham-nang-cao-trong-dplyr"><i class="fa fa-check"></i><b>1.3</b> Các hàm nâng cao trong dplyr</a><ul>
<li class="chapter" data-level="1.3.1" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#iu-kin-phan-nhom-vi-case_when"><i class="fa fa-check"></i><b>1.3.1</b> Điều kiện phân nhóm với <code>case_when</code></a></li>
<li class="chapter" data-level="1.3.2" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#tao-them-bin-mi-theo-iu-kin-vi-mutate_if-mutate_at"><i class="fa fa-check"></i><b>1.3.2</b> Tạo thêm biến mới theo điều kiện với <code>mutate_if</code> &amp; <code>mutate_at</code></a></li>
<li class="chapter" data-level="1.3.3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#tng-hp-d-liu-theo-iu-kin-vi-summarise_at-va-summarise_if"><i class="fa fa-check"></i><b>1.3.3</b> Tổng hợp dữ liệu theo điều kiện với <code>summarise_at</code> và <code>summarise_if</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html"><i class="fa fa-check"></i><b>2</b> Phân rã và xoay chiều dữ liệu</a><ul>
<li class="chapter" data-level="2.1" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#phan-ra-d-liu-thanh-dang-doc-vi-gather"><i class="fa fa-check"></i><b>2.1</b> Phân rã dữ liệu thành dạng dọc với <code>gather</code></a></li>
<li class="chapter" data-level="2.2" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#xoay-chiu-d-liu-vi-spread"><i class="fa fa-check"></i><b>2.2</b> Xoay chiều dữ liệu với <code>spread</code></a></li>
<li class="chapter" data-level="2.3" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#tach-mt-bin-thanh-nhiu-bin-vi-separate"><i class="fa fa-check"></i><b>2.3</b> Tách một biến thành nhiều biến với <code>separate</code></a></li>
<li class="chapter" data-level="2.4" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#gp-nhiu-bin-thanh-mt-bin-vi-unite"><i class="fa fa-check"></i><b>2.4</b> Gộp nhiều biến thành một biến với <code>unite</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cac-chi-s-thng-ke-mo-ta-co-ban.html"><a href="cac-chi-s-thng-ke-mo-ta-co-ban.html"><i class="fa fa-check"></i><b>3</b> Các chỉ số thống kê mô tả cơ bản</a><ul>
<li class="chapter" data-level="3.1" data-path="cac-chi-s-thng-ke-mo-ta-co-ban.html"><a href="cac-chi-s-thng-ke-mo-ta-co-ban.html#correlation"><i class="fa fa-check"></i><b>3.1</b> Correlation</a></li>
<li class="chapter" data-level="3.2" data-path="cac-chi-s-thng-ke-mo-ta-co-ban.html"><a href="cac-chi-s-thng-ke-mo-ta-co-ban.html#anova"><i class="fa fa-check"></i><b>3.2</b> ANOVA</a></li>
<li class="chapter" data-level="3.3" data-path="cac-chi-s-thng-ke-mo-ta-co-ban.html"><a href="cac-chi-s-thng-ke-mo-ta-co-ban.html#kim-inh-quan-h-chi-binh-phuong"><i class="fa fa-check"></i><b>3.3</b> Kiểm định quan hệ Chi-bình phương</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html"><i class="fa fa-check"></i><b>4</b> Lập trình hàm</a><ul>
<li class="chapter" data-level="4.1" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html#quotes-vs.-unquotes"><i class="fa fa-check"></i><b>4.1</b> <strong>Quotes</strong> vs. <strong>Unquotes</strong></a></li>
<li class="chapter" data-level="4.2" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html#trung-hp-dung-quo_name"><i class="fa fa-check"></i><b>4.2</b> Trường hợp dùng <code>quo_name</code></a></li>
<li class="chapter" data-level="4.3" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html#trung-hop-nhiu-bin"><i class="fa fa-check"></i><b>4.3</b> Trường họp nhiều biến</a></li>
<li class="chapter" data-level="4.4" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html#ng-dung"><i class="fa fa-check"></i><b>4.4</b> Ứng dụng</a><ul>
<li class="chapter" data-level="4.4.1" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html#ham-tinh-toan-tng-hp-nhiu-bin"><i class="fa fa-check"></i><b>4.4.1</b> Hàm tính toán tổng hợp nhiều biến</a></li>
<li class="chapter" data-level="4.4.2" data-path="lp-trinh-ham.html"><a href="lp-trinh-ham.html#ve--thi-vi-ggplot2"><i class="fa fa-check"></i><b>4.4.2</b> Vẽ đồ thị với ggplot2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html"><i class="fa fa-check"></i><b>5</b> Lập trình chức năng hàm với purrr</a><ul>
<li class="chapter" data-level="5.1" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#nhom-ham-map"><i class="fa fa-check"></i><b>5.1</b> Nhóm hàm map</a></li>
<li class="chapter" data-level="5.2" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#sa-i-gia-tri-vi-modify"><i class="fa fa-check"></i><b>5.2</b> Sửa đổi giá trị với <code>modify</code></a></li>
<li class="chapter" data-level="5.3" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#tao-ham-nhanh-vi-as_mapper"><i class="fa fa-check"></i><b>5.3</b> Tạo hàm nhanh với <code>as_mapper</code></a></li>
<li class="chapter" data-level="5.4" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#xay-dng-chui-cac-ham-lien-tip-vi-compose"><i class="fa fa-check"></i><b>5.4</b> Xây dựng chuỗi các hàm liên tiếp với <code>compose</code></a></li>
<li class="chapter" data-level="5.5" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#ng-dung-1"><i class="fa fa-check"></i><b>5.5</b> Ứng dụng</a><ul>
<li class="chapter" data-level="5.5.1" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#bin-i-d-liu-vi-modify-va-map_df"><i class="fa fa-check"></i><b>5.5.1</b> Biến đổi dữ liệu với <code>modify</code> và <code>map_df</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#phan-tich-nhiu-nhom-khac-nhau-cung-luc"><i class="fa fa-check"></i><b>5.5.2</b> Phân tích nhiều nhóm khác nhau cùng lúc</a></li>
<li class="chapter" data-level="5.5.3" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#phan-tich-nhiu-bin-trong-dataframe-cung-luc"><i class="fa fa-check"></i><b>5.5.3</b> Phân tích nhiều biến trong dataframe cùng lúc</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html"><i class="fa fa-check"></i><b>6</b> Biến đổi dữ liệu text</a><ul>
<li class="chapter" data-level="6.1" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#gii-thiu"><i class="fa fa-check"></i><b>6.1</b> Giới thiệu</a></li>
<li class="chapter" data-level="6.2" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#regular-expression"><i class="fa fa-check"></i><b>6.2</b> Regular expression</a><ul>
<li class="chapter" data-level="6.2.1" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#metadata"><i class="fa fa-check"></i><b>6.2.1</b> Metadata</a></li>
<li class="chapter" data-level="6.2.2" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#sequences"><i class="fa fa-check"></i><b>6.2.2</b> Sequences</a></li>
<li class="chapter" data-level="6.2.3" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#character-class"><i class="fa fa-check"></i><b>6.2.3</b> Character class</a></li>
<li class="chapter" data-level="6.2.4" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#posix-class"><i class="fa fa-check"></i><b>6.2.4</b> POSIX class</a></li>
<li class="chapter" data-level="6.2.5" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#quantifiers"><i class="fa fa-check"></i><b>6.2.5</b> Quantifiers</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#cac-vi-du-tng-hp"><i class="fa fa-check"></i><b>6.3</b> Các ví dụ tổng hợp</a><ul>
<li class="chapter" data-level="6.3.1" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#vi-du-1"><i class="fa fa-check"></i><b>6.3.1</b> Ví dụ 1</a></li>
<li class="chapter" data-level="6.3.2" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#vi-du-2"><i class="fa fa-check"></i><b>6.3.2</b> Ví dụ 2</a></li>
<li class="chapter" data-level="6.3.3" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#vi-du-3"><i class="fa fa-check"></i><b>6.3.3</b> Ví dụ 3</a></li>
<li class="chapter" data-level="6.3.4" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#vi-du-4"><i class="fa fa-check"></i><b>6.3.4</b> Ví dụ 4</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="bin-i-d-liu-text.html"><a href="bin-i-d-liu-text.html#tai-liu-tham-khao"><i class="fa fa-check"></i><b>6.4</b> Tài liệu tham khảo</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="quan-ly-kt-qua-phan-tich-t-nhiu-mo-hinh.html"><a href="quan-ly-kt-qua-phan-tich-t-nhiu-mo-hinh.html"><i class="fa fa-check"></i><b>7</b> Quản lý kết quả phân tích từ nhiều mô hình</a></li>
<li class="chapter" data-level="8" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html"><i class="fa fa-check"></i><b>8</b> Các nguyên lý dự báo</a><ul>
<li class="chapter" data-level="8.1" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#gii-thiu-1"><i class="fa fa-check"></i><b>8.1</b> Giới thiệu</a><ul>
<li class="chapter" data-level="8.1.1" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#cac-nhanh-trong-hoc-may-machine-learning"><i class="fa fa-check"></i><b>8.1.1</b> Các nhánh trong học máy (machine learning)</a></li>
<li class="chapter" data-level="8.1.2" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#cach-xay-dng-mo-hinh"><i class="fa fa-check"></i><b>8.1.2</b> Cách xây dựng mô hình</a></li>
<li class="chapter" data-level="8.1.3" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#s-dung-mo-hinh"><i class="fa fa-check"></i><b>8.1.3</b> Sử dụng mô hình</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#cac-nguyen-ly-trong-d-bao"><i class="fa fa-check"></i><b>8.2</b> Các nguyên lý trong dự báo</a><ul>
<li class="chapter" data-level="8.2.1" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#reducible-vs.-irreducible-error"><i class="fa fa-check"></i><b>8.2.1</b> Reducible vs. irreducible error</a></li>
<li class="chapter" data-level="8.2.2" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#kha-nang-giai-thich-va-kha-nang-d-bao"><i class="fa fa-check"></i><b>8.2.2</b> Khả năng giải thích và khả năng dự báo</a></li>
<li class="chapter" data-level="8.2.3" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#mo-hinh-co-tham-s-cho-truc-hoc-khong-co-tham-s-cho-truc-parametric-vs.-nonparametric"><i class="fa fa-check"></i><b>8.2.3</b> Mô hình có tham số cho trước hoặc không có tham số cho trước (Parametric vs. Nonparametric)</a></li>
<li class="chapter" data-level="8.2.4" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#nguyen-ly-ch-u"><i class="fa fa-check"></i><b>8.2.4</b> Nguyên lý chữ U</a></li>
<li class="chapter" data-level="8.2.5" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#bias-variance-trade-off"><i class="fa fa-check"></i><b>8.2.5</b> Bias Variance Trade-Off</a></li>
<li class="chapter" data-level="8.2.6" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#overfitting-regularization"><i class="fa fa-check"></i><b>8.2.6</b> Overfitting &amp; regularization</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#quy-trinh-xay-dng-mo-hinh-d-bao"><i class="fa fa-check"></i><b>8.3</b> Quy trình xây dựng mô hình dự báo</a></li>
<li class="chapter" data-level="8.4" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#ensemble-methods"><i class="fa fa-check"></i><b>8.4</b> Ensemble methods</a></li>
<li class="chapter" data-level="8.5" data-path="cac-nguyen-ly-d-bao.html"><a href="cac-nguyen-ly-d-bao.html#luu-y"><i class="fa fa-check"></i><b>8.5</b> Lưu ý</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html"><i class="fa fa-check"></i><b>9</b> Mô hình OLS</a><ul>
<li class="chapter" data-level="9.1" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#gii-thiu-2"><i class="fa fa-check"></i><b>9.1</b> Giới thiệu</a></li>
<li class="chapter" data-level="9.2" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#xay-dng-mo-hinh-co-ban"><i class="fa fa-check"></i><b>9.2</b> Xây dựng mô hình cơ bản</a><ul>
<li class="chapter" data-level="9.2.1" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#mo-hinh-hi-quy-on-bin"><i class="fa fa-check"></i><b>9.2.1</b> Mô hình hồi quy đơn biến</a></li>
<li class="chapter" data-level="9.2.2" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#din-giai-mo-hinh"><i class="fa fa-check"></i><b>9.2.2</b> Diễn giải mô hình</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#anh-gia-cht-lung-mo-hinh"><i class="fa fa-check"></i><b>9.3</b> Đánh giá chất lượng mô hình</a><ul>
<li class="chapter" data-level="9.3.1" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#sai-s-cua-mo-hinh"><i class="fa fa-check"></i><b>9.3.1</b> Sai số của mô hình</a></li>
<li class="chapter" data-level="9.3.2" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#r-binh-phuong-r2"><i class="fa fa-check"></i><b>9.3.2</b> R bình phương <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="9.3.3" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#f-statistic"><i class="fa fa-check"></i><b>9.3.3</b> F statistic</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#d-bao"><i class="fa fa-check"></i><b>9.4</b> Dự báo</a></li>
<li class="chapter" data-level="9.5" data-path="mo-hinh-ols.html"><a href="mo-hinh-ols.html#thut-toan-ti-uu-vi-gradient-decent"><i class="fa fa-check"></i><b>9.5</b> Thuật toán tối ưu với gradient decent</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html"><i class="fa fa-check"></i><b>10</b> Mô hình hồi quy logistic</a><ul>
<li class="chapter" data-level="10.1" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#cach-xay-dng-mo-hinh-1"><i class="fa fa-check"></i><b>10.1</b> Cách xây dựng mô hình</a></li>
<li class="chapter" data-level="10.2" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#vi-du-xay-dng-mo-hinh-on-gian"><i class="fa fa-check"></i><b>10.2</b> Ví dụ xây dựng mô hình đơn giản</a></li>
<li class="chapter" data-level="10.3" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#cac-chi-s-cn-quan-tam-khac"><i class="fa fa-check"></i><b>10.3</b> Các chỉ số cần quan tâm khác</a></li>
<li class="chapter" data-level="10.4" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#anh-gia-cht-lung-mo-hinh-1"><i class="fa fa-check"></i><b>10.4</b> Đánh giá chất lượng mô hình</a><ul>
<li class="chapter" data-level="10.4.1" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#confusion-matrix"><i class="fa fa-check"></i><b>10.4.1</b> Confusion Matrix</a></li>
<li class="chapter" data-level="10.4.2" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#roc"><i class="fa fa-check"></i><b>10.4.2</b> ROC</a></li>
<li class="chapter" data-level="10.4.3" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#gain-va-lift"><i class="fa fa-check"></i><b>10.4.3</b> Gain và Lift</a></li>
<li class="chapter" data-level="10.4.4" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#kolmogorovsmirnov-statistics"><i class="fa fa-check"></i><b>10.4.4</b> Kolmogorov–Smirnov statistics</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#thc-hanh"><i class="fa fa-check"></i><b>10.5</b> Thực hành</a><ul>
<li class="chapter" data-level="10.5.1" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#d-liu"><i class="fa fa-check"></i><b>10.5.1</b> Dữ liệu</a></li>
<li class="chapter" data-level="10.5.2" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#xay-dng-mo-hinh-tren-tp-d-liu-gc"><i class="fa fa-check"></i><b>10.5.2</b> Xây dựng mô hình trên tập dữ liệu gốc</a></li>
<li class="chapter" data-level="10.5.3" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#xay-dng-mo-hinh-tren-hai-tp-train-va-test"><i class="fa fa-check"></i><b>10.5.3</b> Xây dựng mô hình trên hai tập train và test</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="mo-hinh-hi-quy-logistic.html"><a href="mo-hinh-hi-quy-logistic.html#xay-dng-mo-hinh-logistics-theo-machine-learning"><i class="fa fa-check"></i><b>10.6</b> Xây dựng mô hình Logistics theo Machine Learning</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="cay-quyt-inh.html"><a href="cay-quyt-inh.html"><i class="fa fa-check"></i><b>11</b> Cây quyết định</a><ul>
<li class="chapter" data-level="11.1" data-path="cay-quyt-inh.html"><a href="cay-quyt-inh.html#gii-thiu-3"><i class="fa fa-check"></i><b>11.1</b> Giới thiệu</a></li>
<li class="chapter" data-level="11.2" data-path="cay-quyt-inh.html"><a href="cay-quyt-inh.html#regression-trees"><i class="fa fa-check"></i><b>11.2</b> Regression Trees</a></li>
<li class="chapter" data-level="11.3" data-path="cay-quyt-inh.html"><a href="cay-quyt-inh.html#classification-trees"><i class="fa fa-check"></i><b>11.3</b> Classification Trees</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bagging-boosting-va-random-forest.html"><a href="bagging-boosting-va-random-forest.html"><i class="fa fa-check"></i><b>12</b> Bagging - Boosting và Random Forest</a><ul>
<li class="chapter" data-level="12.1" data-path="bagging-boosting-va-random-forest.html"><a href="bagging-boosting-va-random-forest.html#bagging"><i class="fa fa-check"></i><b>12.1</b> Bagging</a></li>
<li class="chapter" data-level="12.2" data-path="bagging-boosting-va-random-forest.html"><a href="bagging-boosting-va-random-forest.html#random-forests"><i class="fa fa-check"></i><b>12.2</b> Random Forests</a></li>
<li class="chapter" data-level="12.3" data-path="bagging-boosting-va-random-forest.html"><a href="bagging-boosting-va-random-forest.html#boosting"><i class="fa fa-check"></i><b>12.3</b> Boosting</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>13</b> Unsupervised learning</a></li>
<li class="chapter" data-level="14" data-path="k-means.html"><a href="k-means.html"><i class="fa fa-check"></i><b>14</b> k-means</a><ul>
<li class="chapter" data-level="14.1" data-path="k-means.html"><a href="k-means.html#gii-thiu-4"><i class="fa fa-check"></i><b>14.1</b> Giới thiệu</a></li>
<li class="chapter" data-level="14.2" data-path="k-means.html"><a href="k-means.html#thut-toan"><i class="fa fa-check"></i><b>14.2</b> Thuật toán</a></li>
<li class="chapter" data-level="14.3" data-path="k-means.html"><a href="k-means.html#uu-nhuc-im-cua-k-means"><i class="fa fa-check"></i><b>14.3</b> Ưu nhược điểm của K-means</a></li>
<li class="chapter" data-level="14.4" data-path="k-means.html"><a href="k-means.html#thc-hanh-tren-r"><i class="fa fa-check"></i><b>14.4</b> Thực hành trên R</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html"><i class="fa fa-check"></i><b>15</b> Phân tích giỏ hàng</a><ul>
<li class="chapter" data-level="15.1" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#cac-khai-nim-co-ban"><i class="fa fa-check"></i><b>15.1</b> Các khái niệm cơ bản</a></li>
<li class="chapter" data-level="15.2" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#cach-thc-hin-mo-hinh"><i class="fa fa-check"></i><b>15.2</b> Cách thực hiện mô hình</a></li>
<li class="chapter" data-level="15.3" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#ba-cau-hoi-khi-phan-tich-gio-hang"><i class="fa fa-check"></i><b>15.3</b> Ba câu hỏi khi phân tích giỏ hàng</a><ul>
<li class="chapter" data-level="15.3.1" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#cac-san-phm-nao-hay-uc-mua-cung-nhau"><i class="fa fa-check"></i><b>15.3.1</b> Các sản phẩm nào hay được mua cùng nhau</a></li>
<li class="chapter" data-level="15.3.2" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#khach-hang-mua-san-phm-a-thi-se-mua-san-phm-nao-tip-theo"><i class="fa fa-check"></i><b>15.3.2</b> Khách hàng mua sản phẩm A thì sẽ mua sản phẩm nào tiếp theo?</a></li>
<li class="chapter" data-level="15.3.3" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#khach-hang-mua-san-phm-gi-thi-se-mua-tip-san-phm-a"><i class="fa fa-check"></i><b>15.3.3</b> Khách hàng mua sản phẩm gì thì sẽ mua tiếp sản phẩm A?</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#uu-nhuc-im"><i class="fa fa-check"></i><b>15.4</b> Ưu nhược điểm</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="feature-engineering.html"><a href="feature-engineering.html"><i class="fa fa-check"></i><b>16</b> Feature Engineering</a><ul>
<li class="chapter" data-level="16.1" data-path="feature-engineering.html"><a href="feature-engineering.html#feature-engineering-cho-cac-bin-nhom"><i class="fa fa-check"></i><b>16.1</b> Feature engineering cho các biến nhóm</a><ul>
<li class="chapter" data-level="16.1.1" data-path="feature-engineering.html"><a href="feature-engineering.html#tao-d-liu-gia-dummy-data-cho-bin-khong-phan-bit-th-t"><i class="fa fa-check"></i><b>16.1.1</b> Tạo dữ liệu giả (dummy data) cho biến không phân biệt thứ tự</a></li>
<li class="chapter" data-level="16.1.2" data-path="feature-engineering.html"><a href="feature-engineering.html#d-liu-co-rt-nhiu-nhom"><i class="fa fa-check"></i><b>16.1.2</b> Dữ liệu có rất nhiều nhóm</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="feature-engineering.html"><a href="feature-engineering.html#cac-bin-lien-tuc"><i class="fa fa-check"></i><b>16.2</b> Các biến liên tục</a><ul>
<li class="chapter" data-level="16.2.1" data-path="feature-engineering.html"><a href="feature-engineering.html#bin-i-11"><i class="fa fa-check"></i><b>16.2.1</b> Biến đổi 1:1</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Chuỗi thời gian</b></span></li>
<li class="chapter" data-level="17" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html"><i class="fa fa-check"></i><b>17</b> Giới thiệu về chuỗi thời gian</a><ul>
<li class="chapter" data-level="17.1" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#thanh-phn-cua-chui-thi-gian"><i class="fa fa-check"></i><b>17.1</b> Thành phần của chuỗi thời gian</a></li>
<li class="chapter" data-level="17.2" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#d-liu-chui-thi-gian"><i class="fa fa-check"></i><b>17.2</b> Dữ liệu chuỗi thời gian</a></li>
<li class="chapter" data-level="17.3" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#smoothing"><i class="fa fa-check"></i><b>17.3</b> Smoothing</a></li>
<li class="chapter" data-level="17.4" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#seasonal-decomposition"><i class="fa fa-check"></i><b>17.4</b> Seasonal decomposition</a></li>
<li class="chapter" data-level="17.5" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#exponential-forecasting-model"><i class="fa fa-check"></i><b>17.5</b> Exponential Forecasting Model</a><ul>
<li class="chapter" data-level="17.5.1" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#single-exponential-model"><i class="fa fa-check"></i><b>17.5.1</b> Single Exponential Model</a></li>
<li class="chapter" data-level="17.5.2" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#hold-holt-winters-exponential-smoothing"><i class="fa fa-check"></i><b>17.5.2</b> Hold &amp; Holt-Winters exponential smoothing</a></li>
<li class="chapter" data-level="17.5.3" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#t-ng-xay-dng-mo-hinh"><i class="fa fa-check"></i><b>17.5.3</b> Tự động xây dựng mô hình</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="mo-hinh-arima.html"><a href="mo-hinh-arima.html"><i class="fa fa-check"></i><b>18</b> Mô hình ARIMA</a><ul>
<li class="chapter" data-level="18.1" data-path="mo-hinh-arima.html"><a href="mo-hinh-arima.html#chui-thi-gian-dng"><i class="fa fa-check"></i><b>18.1</b> Chuỗi thời gian dừng</a></li>
<li class="chapter" data-level="18.2" data-path="mo-hinh-arima.html"><a href="mo-hinh-arima.html#mo-hinh-arima-1"><i class="fa fa-check"></i><b>18.2</b> Mô hình ARIMA</a></li>
<li class="chapter" data-level="18.3" data-path="mo-hinh-arima.html"><a href="mo-hinh-arima.html#vi-du-vi-r"><i class="fa fa-check"></i><b>18.3</b> Ví dụ với R</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html"><a href="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html"><i class="fa fa-check"></i><b>19</b> Phân tích chuỗi thời gian với tidyquant và timetk</a><ul>
<li class="chapter" data-level="19.1" data-path="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html"><a href="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html#ly-d-liu-vi-package-tidyquant"><i class="fa fa-check"></i><b>19.1</b> Lấy dữ liệu với package tidyquant</a></li>
<li class="chapter" data-level="19.2" data-path="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html"><a href="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html#trc-quan-hoa-vi-geom_ma"><i class="fa fa-check"></i><b>19.2</b> Trực quan hóa với <code>geom_ma</code></a></li>
<li class="chapter" data-level="19.3" data-path="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html"><a href="phan-tich-chui-thi-gian-vi-tidyquant-va-timetk.html#chuyn-t-dataframe-thanh-xts"><i class="fa fa-check"></i><b>19.3</b> Chuyển từ dataframe thành xts</a></li>
</ul></li>
<li class="part"><span><b>III Case study</b></span></li>
<li class="chapter" data-level="20" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html"><i class="fa fa-check"></i><b>20</b> Trực quan hóa dữ liệu</a><ul>
<li class="chapter" data-level="20.1" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html#xay-dng-phu-ban-hang-theo-tng-nhom"><i class="fa fa-check"></i><b>20.1</b> Xây dựng phễu bán hàng theo từng nhóm</a></li>
<li class="chapter" data-level="20.2" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html#ve-biu--warterfall-cho-aciveinactive-users"><i class="fa fa-check"></i><b>20.2</b> Vẽ biểu đồ warterfall cho acive/inactive users</a></li>
<li class="chapter" data-level="20.3" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html#xay-dng-biu--lollipop-chart"><i class="fa fa-check"></i><b>20.3</b> Xây dựng biểu đồ lollipop chart</a></li>
<li class="chapter" data-level="20.4" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html#trc-quan-hoa-cac-phn-trung-lp-nhau"><i class="fa fa-check"></i><b>20.4</b> Trực quan hóa các phần trùng lặp nhau</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="cac-meo-trong-r.html"><a href="cac-meo-trong-r.html"><i class="fa fa-check"></i><b>21</b> Các mẹo trong R</a><ul>
<li class="chapter" data-level="21.1" data-path="cac-meo-trong-r.html"><a href="cac-meo-trong-r.html#hin-thi-s-binh-thung"><i class="fa fa-check"></i><b>21.1</b> Hiển thị số bình thường</a></li>
<li class="chapter" data-level="21.2" data-path="cac-meo-trong-r.html"><a href="cac-meo-trong-r.html#export-d-liu-ra-excel"><i class="fa fa-check"></i><b>21.2</b> Export dữ liệu ra excel</a></li>
<li class="chapter" data-level="21.3" data-path="cac-meo-trong-r.html"><a href="cac-meo-trong-r.html#lam-vic-khi-proxy-bi-chn"><i class="fa fa-check"></i><b>21.3</b> Làm việc khi proxy bị chặn</a></li>
<li class="chapter" data-level="21.4" data-path="cac-meo-trong-r.html"><a href="cac-meo-trong-r.html#t-ng-render-ra-kt-qua-phan-tich"><i class="fa fa-check"></i><b>21.4</b> Tự động render ra kết quả phân tích</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Anh Hoang Duc</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Phân tích dữ liệu thực tế với R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="k-means" class="section level1">
<h1><span class="header-section-number">Chương 14</span> k-means</h1>
<div id="gii-thiu-4" class="section level2">
<h2><span class="header-section-number">14.1</span> Giới thiệu</h2>
<p>Trong chương này, chúng ta sẽ cùng tìm hiểu về thuật toán <code>clustering K-means</code> - một thuật toán thuộc về nhóm <strong>unsupervised learning</strong> (“học không giám sát”).</p>
<p><code>Clustering K-means</code> có thể ứng dụng trong các lĩnh vực như ngân hàng hay thương mại điện tử vào việc phân nhóm khách hàng dựa trên những đặc điểm về hành vi, thói quen chi tiêu và demographics của họ. Điều đó sẽ giúp cho ngân hàng hay các công ty thương mại điện tử có thể hiểu rõ được hành vi khách hàng của mình, để sau đó có thể offer những sản phẩm, dịch vụ phù hợp với nhu cầu của từng khách hàng.</p>
<p>Thuật toán <code>K-means</code> sẽ nhóm các đối tượng (quan sát) có những đặc điểm và hành vi tương đồng vào K nhóm bất kỳ. Số lượng nhóm K sẽ phụ thuộc vào mục đích cũng như bối cảnh mà chúng ta đặt ra (thông thường nên từ 2 đến 10 nhóm).</p>
<p>Ví dụ, sử dụng dữ liệu <code>iris</code> có sẵn trong <code>R</code> chúng ta sẽ phân nhóm (<code>cluster</code>) các quan sát thành 2 nhóm dựa vào biến <code>Sepal.Length</code> và <code>Petal.length</code>.</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="k-means.html#cb628-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb628-2"><a href="k-means.html#cb628-2"></a><span class="co"># Lấy ngẫu nhiên 100 quan sát, </span></span>
<span id="cb628-3"><a href="k-means.html#cb628-3"></a><span class="co"># và chỉ lấy 2 biến `Sepal.Length` và `Petal.Length`</span></span>
<span id="cb628-4"><a href="k-means.html#cb628-4"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb628-5"><a href="k-means.html#cb628-5"></a>data &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb628-6"><a href="k-means.html#cb628-6"></a><span class="st">  </span><span class="kw">select</span>(Sepal.Length, Petal.Length) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb628-7"><a href="k-means.html#cb628-7"></a><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">100</span>)</span>
<span id="cb628-8"><a href="k-means.html#cb628-8"></a></span>
<span id="cb628-9"><a href="k-means.html#cb628-9"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb628-10"><a href="k-means.html#cb628-10"></a>data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb628-11"><a href="k-means.html#cb628-11"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Sepal.Length, Petal.Length)) <span class="op">+</span></span>
<span id="cb628-12"><a href="k-means.html#cb628-12"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)<span class="op">+</span></span>
<span id="cb628-13"><a href="k-means.html#cb628-13"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="53-kmeans_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<ul>
<li><strong>Bước 1</strong>: Chúng ta sẽ lựa chọn ngẫu nhiên 2 tâm (<code>cluster centroids</code>) - tương đương với 2 nhóm, là 2 điểm x (đỏ) và x (xanh dương) như sau:</li>
</ul>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="k-means.html#cb629-1"></a>data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb629-2"><a href="k-means.html#cb629-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Sepal.Length, Petal.Length)) <span class="op">+</span></span>
<span id="cb629-3"><a href="k-means.html#cb629-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)<span class="op">+</span></span>
<span id="cb629-4"><a href="k-means.html#cb629-4"></a><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span></span>
<span id="cb629-5"><a href="k-means.html#cb629-5"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">6</span>,<span class="dt">y=</span><span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb629-6"><a href="k-means.html#cb629-6"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="53-kmeans_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<ul>
<li><strong>Bước 2</strong>: Quan sát nào mà “gần” hơn với điểm x (đỏ) thì chúng ta sẽ nhóm quan sát đó vào một nhóm màu đỏ, còn những quan sát nào mà “gần” hơn với điểm x (xanh dương), sẽ thuộc về nhóm màu xanh dương. Ở đây “gần” hơn được hiểu là khoảng cách từ quan sát đó đến điểm x nào nhỏ hơn.</li>
</ul>
<p>Khoảng cách giữa 2 điểm có tọa độ (x1, y1) và (x2, y2) được tính như sau:</p>
<p><span class="math display">\[d = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2}\]</span></p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="k-means.html#cb630-1"></a>data1 &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb630-2"><a href="k-means.html#cb630-2"></a><span class="st">  </span><span class="co"># Set ngẫu nhiên 2 centroids</span></span>
<span id="cb630-3"><a href="k-means.html#cb630-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Sepal.Length_red =</span> <span class="dv">6</span>,</span>
<span id="cb630-4"><a href="k-means.html#cb630-4"></a>         <span class="dt">Petal.Length_red =</span> <span class="dv">5</span>,</span>
<span id="cb630-5"><a href="k-means.html#cb630-5"></a>         <span class="dt">Sepal.Length_blue =</span> <span class="dv">5</span>,</span>
<span id="cb630-6"><a href="k-means.html#cb630-6"></a>         <span class="dt">Petal.Length_blue =</span> <span class="dv">1</span></span>
<span id="cb630-7"><a href="k-means.html#cb630-7"></a>         ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb630-8"><a href="k-means.html#cb630-8"></a><span class="st">  </span><span class="co"># Tính khoảng cách từ các quan sát đến 2 centroids</span></span>
<span id="cb630-9"><a href="k-means.html#cb630-9"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb630-10"><a href="k-means.html#cb630-10"></a>    <span class="dt">distance_red =</span> <span class="kw">sqrt</span>((Sepal.Length<span class="op">-</span>Sepal.Length_red)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(Petal.Length <span class="op">-</span><span class="st"> </span>Petal.Length_red)<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb630-11"><a href="k-means.html#cb630-11"></a>    <span class="dt">distance_blue =</span> <span class="kw">sqrt</span>((Sepal.Length<span class="op">-</span>Sepal.Length_blue)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(Petal.Length <span class="op">-</span><span class="st"> </span>Petal.Length_blue)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb630-12"><a href="k-means.html#cb630-12"></a>    ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb630-13"><a href="k-means.html#cb630-13"></a><span class="st">  </span><span class="co"># Tạo biến mới - nhóm mà các quan sát được phân vào</span></span>
<span id="cb630-14"><a href="k-means.html#cb630-14"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">case_when</span>(</span>
<span id="cb630-15"><a href="k-means.html#cb630-15"></a>    distance_red <span class="op">&lt;</span><span class="st"> </span>distance_blue <span class="op">~</span><span class="st"> &quot;red&quot;</span>,</span>
<span id="cb630-16"><a href="k-means.html#cb630-16"></a>    <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;blue&quot;</span></span>
<span id="cb630-17"><a href="k-means.html#cb630-17"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span>as.factor)</span>
<span id="cb630-18"><a href="k-means.html#cb630-18"></a>  </span>
<span id="cb630-19"><a href="k-means.html#cb630-19"></a></span>
<span id="cb630-20"><a href="k-means.html#cb630-20"></a><span class="co"># Plot dữ liệu mới  </span></span>
<span id="cb630-21"><a href="k-means.html#cb630-21"></a>data1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb630-22"><a href="k-means.html#cb630-22"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Sepal.Length, Petal.Length), <span class="dt">group =</span> group) <span class="op">+</span></span>
<span id="cb630-23"><a href="k-means.html#cb630-23"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">col =</span> group))<span class="op">+</span></span>
<span id="cb630-24"><a href="k-means.html#cb630-24"></a><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span></span>
<span id="cb630-25"><a href="k-means.html#cb630-25"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">6</span>,<span class="dt">y=</span><span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb630-26"><a href="k-means.html#cb630-26"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb630-27"><a href="k-means.html#cb630-27"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(</span>
<span id="cb630-28"><a href="k-means.html#cb630-28"></a>    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span> =<span class="st"> &quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span> =<span class="st"> &quot;red&quot;</span>)</span>
<span id="cb630-29"><a href="k-means.html#cb630-29"></a>  )<span class="op">+</span></span>
<span id="cb630-30"><a href="k-means.html#cb630-30"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="53-kmeans_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<ul>
<li><strong>Bước 3</strong>: Tiếp theo, chúng ta sẽ di chuyển 2 tâm x (đỏ) và x (xanh dương) (<code>move centroids</code>) đến điểm mới có tọa độ bằng trung bình tọa độ các quan sát thuộc về 2 nhóm nói trên.</li>
</ul>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="k-means.html#cb631-1"></a><span class="co"># Tính tọa độ của 2 centroids mới</span></span>
<span id="cb631-2"><a href="k-means.html#cb631-2"></a>new_centroids_<span class="dv">1</span> &lt;-<span class="st"> </span>data1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb631-3"><a href="k-means.html#cb631-3"></a><span class="st">  </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb631-4"><a href="k-means.html#cb631-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">average_sepal =</span> <span class="kw">mean</span>(Sepal.Length),</span>
<span id="cb631-5"><a href="k-means.html#cb631-5"></a>            <span class="dt">average_petal =</span> <span class="kw">mean</span>(Petal.Length)</span>
<span id="cb631-6"><a href="k-means.html#cb631-6"></a>            ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb631-7"><a href="k-means.html#cb631-7"></a><span class="st">  </span>as.data.frame</span>
<span id="cb631-8"><a href="k-means.html#cb631-8"></a></span>
<span id="cb631-9"><a href="k-means.html#cb631-9"></a></span>
<span id="cb631-10"><a href="k-means.html#cb631-10"></a><span class="co"># Plot di chuyển centroids</span></span>
<span id="cb631-11"><a href="k-means.html#cb631-11"></a>data1 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb631-12"><a href="k-means.html#cb631-12"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Sepal.Length, Petal.Length), <span class="dt">group =</span> group) <span class="op">+</span></span>
<span id="cb631-13"><a href="k-means.html#cb631-13"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">col =</span> group))<span class="op">+</span></span>
<span id="cb631-14"><a href="k-means.html#cb631-14"></a><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span></span>
<span id="cb631-15"><a href="k-means.html#cb631-15"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">6</span>,<span class="dt">y=</span><span class="dv">5</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb631-16"><a href="k-means.html#cb631-16"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">5</span>,<span class="dt">y=</span><span class="dv">1</span>), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb631-17"><a href="k-means.html#cb631-17"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(</span>
<span id="cb631-18"><a href="k-means.html#cb631-18"></a>    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span> =<span class="st"> &quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span> =<span class="st"> &quot;red&quot;</span>)</span>
<span id="cb631-19"><a href="k-means.html#cb631-19"></a>  )<span class="op">+</span></span>
<span id="cb631-20"><a href="k-means.html#cb631-20"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span></span>
<span id="cb631-21"><a href="k-means.html#cb631-21"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>new_centroids_<span class="dv">1</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>],</span>
<span id="cb631-22"><a href="k-means.html#cb631-22"></a>                 <span class="dt">y=</span>new_centroids_<span class="dv">1</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>]</span>
<span id="cb631-23"><a href="k-means.html#cb631-23"></a>                 ), </span>
<span id="cb631-24"><a href="k-means.html#cb631-24"></a>             <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb631-25"><a href="k-means.html#cb631-25"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>new_centroids_<span class="dv">1</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>],</span>
<span id="cb631-26"><a href="k-means.html#cb631-26"></a>                 <span class="dt">y=</span>new_centroids_<span class="dv">1</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>]</span>
<span id="cb631-27"><a href="k-means.html#cb631-27"></a>                 ), </span>
<span id="cb631-28"><a href="k-means.html#cb631-28"></a>             <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb631-29"><a href="k-means.html#cb631-29"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">6</span>, </span>
<span id="cb631-30"><a href="k-means.html#cb631-30"></a>                   <span class="dt">y =</span> <span class="dv">5</span>, </span>
<span id="cb631-31"><a href="k-means.html#cb631-31"></a>                   <span class="dt">xend =</span> new_centroids_<span class="dv">1</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>], </span>
<span id="cb631-32"><a href="k-means.html#cb631-32"></a>                   <span class="dt">yend =</span> new_centroids_<span class="dv">1</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>]</span>
<span id="cb631-33"><a href="k-means.html#cb631-33"></a>                   ), </span>
<span id="cb631-34"><a href="k-means.html#cb631-34"></a>               <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb631-35"><a href="k-means.html#cb631-35"></a>               <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb631-36"><a href="k-means.html#cb631-36"></a>               <span class="dt">size =</span> <span class="fl">0.1</span></span>
<span id="cb631-37"><a href="k-means.html#cb631-37"></a>               )<span class="op">+</span></span>
<span id="cb631-38"><a href="k-means.html#cb631-38"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">5</span>, </span>
<span id="cb631-39"><a href="k-means.html#cb631-39"></a>                   <span class="dt">y =</span> <span class="dv">1</span>, </span>
<span id="cb631-40"><a href="k-means.html#cb631-40"></a>                   <span class="dt">xend =</span> new_centroids_<span class="dv">1</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>], </span>
<span id="cb631-41"><a href="k-means.html#cb631-41"></a>                   <span class="dt">yend =</span> new_centroids_<span class="dv">1</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>]</span>
<span id="cb631-42"><a href="k-means.html#cb631-42"></a>                   ), </span>
<span id="cb631-43"><a href="k-means.html#cb631-43"></a>               <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb631-44"><a href="k-means.html#cb631-44"></a>               <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb631-45"><a href="k-means.html#cb631-45"></a>               <span class="dt">size =</span> <span class="fl">0.1</span></span>
<span id="cb631-46"><a href="k-means.html#cb631-46"></a>               )</span></code></pre></div>
<p><img src="53-kmeans_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<ul>
<li><strong>Bước 4</strong>: Bây giờ, chúng ta sẽ lặp lại quá trình đã làm, tức quan sát gần hơn với điểm centroids mới nào thì sẽ thuộc về nhóm tương ứng. Kết quả như sau:</li>
</ul>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="k-means.html#cb632-1"></a>data2 &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb632-2"><a href="k-means.html#cb632-2"></a><span class="st">  </span><span class="co"># Update 2 centroids mới</span></span>
<span id="cb632-3"><a href="k-means.html#cb632-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Sepal.Length_red =</span> new_centroids_<span class="dv">1</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>],</span>
<span id="cb632-4"><a href="k-means.html#cb632-4"></a>         <span class="dt">Petal.Length_red =</span> new_centroids_<span class="dv">1</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>],</span>
<span id="cb632-5"><a href="k-means.html#cb632-5"></a>         <span class="dt">Sepal.Length_blue =</span> new_centroids_<span class="dv">1</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>],</span>
<span id="cb632-6"><a href="k-means.html#cb632-6"></a>         <span class="dt">Petal.Length_blue =</span> new_centroids_<span class="dv">1</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>]</span>
<span id="cb632-7"><a href="k-means.html#cb632-7"></a>         ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb632-8"><a href="k-means.html#cb632-8"></a><span class="st">  </span><span class="co"># Tính khoảng cách từ các quan sát đến 2 centroids</span></span>
<span id="cb632-9"><a href="k-means.html#cb632-9"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb632-10"><a href="k-means.html#cb632-10"></a>    <span class="dt">distance_red =</span> <span class="kw">sqrt</span>((Sepal.Length<span class="op">-</span>Sepal.Length_red)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(Petal.Length <span class="op">-</span><span class="st"> </span>Petal.Length_red)<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb632-11"><a href="k-means.html#cb632-11"></a>    <span class="dt">distance_blue =</span> <span class="kw">sqrt</span>((Sepal.Length<span class="op">-</span>Sepal.Length_blue)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(Petal.Length <span class="op">-</span><span class="st"> </span>Petal.Length_blue)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb632-12"><a href="k-means.html#cb632-12"></a>    ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb632-13"><a href="k-means.html#cb632-13"></a><span class="st">  </span><span class="co"># Tạo biến mới - nhóm mà các quan sát được phân vào</span></span>
<span id="cb632-14"><a href="k-means.html#cb632-14"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">case_when</span>(</span>
<span id="cb632-15"><a href="k-means.html#cb632-15"></a>    distance_red <span class="op">&lt;</span><span class="st"> </span>distance_blue <span class="op">~</span><span class="st"> &quot;red&quot;</span>,</span>
<span id="cb632-16"><a href="k-means.html#cb632-16"></a>    <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;blue&quot;</span></span>
<span id="cb632-17"><a href="k-means.html#cb632-17"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span>as.factor)</span>
<span id="cb632-18"><a href="k-means.html#cb632-18"></a></span>
<span id="cb632-19"><a href="k-means.html#cb632-19"></a></span>
<span id="cb632-20"><a href="k-means.html#cb632-20"></a><span class="co"># Plot dữ liệu mới  </span></span>
<span id="cb632-21"><a href="k-means.html#cb632-21"></a>data2 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb632-22"><a href="k-means.html#cb632-22"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Sepal.Length, Petal.Length), <span class="dt">group =</span> group) <span class="op">+</span></span>
<span id="cb632-23"><a href="k-means.html#cb632-23"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">col =</span> group))<span class="op">+</span></span>
<span id="cb632-24"><a href="k-means.html#cb632-24"></a><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span></span>
<span id="cb632-25"><a href="k-means.html#cb632-25"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(</span>
<span id="cb632-26"><a href="k-means.html#cb632-26"></a>    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span> =<span class="st"> &quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span> =<span class="st"> &quot;red&quot;</span>)</span>
<span id="cb632-27"><a href="k-means.html#cb632-27"></a>  )<span class="op">+</span></span>
<span id="cb632-28"><a href="k-means.html#cb632-28"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span></span>
<span id="cb632-29"><a href="k-means.html#cb632-29"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>new_centroids_<span class="dv">1</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>],</span>
<span id="cb632-30"><a href="k-means.html#cb632-30"></a>                 <span class="dt">y=</span>new_centroids_<span class="dv">1</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>]</span>
<span id="cb632-31"><a href="k-means.html#cb632-31"></a>                 ), </span>
<span id="cb632-32"><a href="k-means.html#cb632-32"></a>             <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb632-33"><a href="k-means.html#cb632-33"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>new_centroids_<span class="dv">1</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>],</span>
<span id="cb632-34"><a href="k-means.html#cb632-34"></a>                 <span class="dt">y=</span>new_centroids_<span class="dv">1</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>]</span>
<span id="cb632-35"><a href="k-means.html#cb632-35"></a>                 ), </span>
<span id="cb632-36"><a href="k-means.html#cb632-36"></a>             <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb632-37"><a href="k-means.html#cb632-37"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb632-38"><a href="k-means.html#cb632-38"></a>           <span class="dt">x =</span> <span class="fl">4.9</span>, <span class="dt">y =</span> <span class="fl">3.3</span>,</span>
<span id="cb632-39"><a href="k-means.html#cb632-39"></a>           <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb632-40"><a href="k-means.html#cb632-40"></a>           <span class="dt">size =</span> <span class="dv">4</span>,</span>
<span id="cb632-41"><a href="k-means.html#cb632-41"></a>           <span class="dt">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb632-42"><a href="k-means.html#cb632-42"></a>           <span class="dt">label =</span> <span class="st">&quot;This point: </span><span class="ch">\n</span><span class="st"> red -&gt; blue&quot;</span></span>
<span id="cb632-43"><a href="k-means.html#cb632-43"></a>           )</span></code></pre></div>
<p><img src="53-kmeans_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Như vậy, với 2 centroids mới việc phân nhóm quan sát có sự thay đổi: Có 1 điểm lúc trước thuộc về nhóm đỏ, nhưng giờ thuộc về nhóm xanh dương.</p>
<ul>
<li><strong>Bước 5</strong>: Tiếp tục quá trình như trên, chúng ta sẽ lại di chuyển các centroids để tìm các centroids mới.</li>
</ul>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="k-means.html#cb633-1"></a><span class="co"># Tính tọa độ của 2 centroids mới</span></span>
<span id="cb633-2"><a href="k-means.html#cb633-2"></a>new_centroids_<span class="dv">2</span> &lt;-<span class="st"> </span>data2 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb633-3"><a href="k-means.html#cb633-3"></a><span class="st">  </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb633-4"><a href="k-means.html#cb633-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">average_sepal =</span> <span class="kw">mean</span>(Sepal.Length),</span>
<span id="cb633-5"><a href="k-means.html#cb633-5"></a>            <span class="dt">average_petal =</span> <span class="kw">mean</span>(Petal.Length)</span>
<span id="cb633-6"><a href="k-means.html#cb633-6"></a>            ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb633-7"><a href="k-means.html#cb633-7"></a><span class="st">  </span>as.data.frame</span>
<span id="cb633-8"><a href="k-means.html#cb633-8"></a></span>
<span id="cb633-9"><a href="k-means.html#cb633-9"></a></span>
<span id="cb633-10"><a href="k-means.html#cb633-10"></a><span class="co"># Plot di chuyển centroids</span></span>
<span id="cb633-11"><a href="k-means.html#cb633-11"></a>data2 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb633-12"><a href="k-means.html#cb633-12"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Sepal.Length, Petal.Length), <span class="dt">group =</span> group) <span class="op">+</span></span>
<span id="cb633-13"><a href="k-means.html#cb633-13"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">col =</span> group))<span class="op">+</span></span>
<span id="cb633-14"><a href="k-means.html#cb633-14"></a><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span></span>
<span id="cb633-15"><a href="k-means.html#cb633-15"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(</span>
<span id="cb633-16"><a href="k-means.html#cb633-16"></a>    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span> =<span class="st"> &quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span> =<span class="st"> &quot;red&quot;</span>)</span>
<span id="cb633-17"><a href="k-means.html#cb633-17"></a>  )<span class="op">+</span></span>
<span id="cb633-18"><a href="k-means.html#cb633-18"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span></span>
<span id="cb633-19"><a href="k-means.html#cb633-19"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>new_centroids_<span class="dv">1</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>],</span>
<span id="cb633-20"><a href="k-means.html#cb633-20"></a>                 <span class="dt">y=</span>new_centroids_<span class="dv">1</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>]</span>
<span id="cb633-21"><a href="k-means.html#cb633-21"></a>                 ), </span>
<span id="cb633-22"><a href="k-means.html#cb633-22"></a>             <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb633-23"><a href="k-means.html#cb633-23"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>new_centroids_<span class="dv">1</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>],</span>
<span id="cb633-24"><a href="k-means.html#cb633-24"></a>                 <span class="dt">y=</span>new_centroids_<span class="dv">1</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>]</span>
<span id="cb633-25"><a href="k-means.html#cb633-25"></a>                 ), </span>
<span id="cb633-26"><a href="k-means.html#cb633-26"></a>             <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb633-27"><a href="k-means.html#cb633-27"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>new_centroids_<span class="dv">2</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>],</span>
<span id="cb633-28"><a href="k-means.html#cb633-28"></a>                 <span class="dt">y=</span>new_centroids_<span class="dv">2</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>]</span>
<span id="cb633-29"><a href="k-means.html#cb633-29"></a>                 ), </span>
<span id="cb633-30"><a href="k-means.html#cb633-30"></a>             <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb633-31"><a href="k-means.html#cb633-31"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>new_centroids_<span class="dv">2</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>],</span>
<span id="cb633-32"><a href="k-means.html#cb633-32"></a>                 <span class="dt">y=</span>new_centroids_<span class="dv">2</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>]</span>
<span id="cb633-33"><a href="k-means.html#cb633-33"></a>                 ), </span>
<span id="cb633-34"><a href="k-means.html#cb633-34"></a>             <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb633-35"><a href="k-means.html#cb633-35"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> new_centroids_<span class="dv">1</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>], </span>
<span id="cb633-36"><a href="k-means.html#cb633-36"></a>                   <span class="dt">y =</span> new_centroids_<span class="dv">1</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>], </span>
<span id="cb633-37"><a href="k-means.html#cb633-37"></a>                   <span class="dt">xend =</span> new_centroids_<span class="dv">2</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>], </span>
<span id="cb633-38"><a href="k-means.html#cb633-38"></a>                   <span class="dt">yend =</span> new_centroids_<span class="dv">2</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>]</span>
<span id="cb633-39"><a href="k-means.html#cb633-39"></a>                   ), </span>
<span id="cb633-40"><a href="k-means.html#cb633-40"></a>               <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb633-41"><a href="k-means.html#cb633-41"></a>               <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb633-42"><a href="k-means.html#cb633-42"></a>               <span class="dt">size =</span> <span class="fl">0.1</span></span>
<span id="cb633-43"><a href="k-means.html#cb633-43"></a>               )<span class="op">+</span></span>
<span id="cb633-44"><a href="k-means.html#cb633-44"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> new_centroids_<span class="dv">1</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>], </span>
<span id="cb633-45"><a href="k-means.html#cb633-45"></a>                   <span class="dt">y =</span> new_centroids_<span class="dv">1</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">1</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>], </span>
<span id="cb633-46"><a href="k-means.html#cb633-46"></a>                   <span class="dt">xend =</span> new_centroids_<span class="dv">2</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>], </span>
<span id="cb633-47"><a href="k-means.html#cb633-47"></a>                   <span class="dt">yend =</span> new_centroids_<span class="dv">2</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>]</span>
<span id="cb633-48"><a href="k-means.html#cb633-48"></a>                   ), </span>
<span id="cb633-49"><a href="k-means.html#cb633-49"></a>               <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb633-50"><a href="k-means.html#cb633-50"></a>               <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb633-51"><a href="k-means.html#cb633-51"></a>               <span class="dt">size =</span> <span class="fl">0.1</span></span>
<span id="cb633-52"><a href="k-means.html#cb633-52"></a>               )</span></code></pre></div>
<p><img src="53-kmeans_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<ul>
<li><strong>Bước 6</strong>: Phân nhóm lại theo các centroids mới</li>
</ul>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="k-means.html#cb634-1"></a>data3 &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb634-2"><a href="k-means.html#cb634-2"></a><span class="st">  </span><span class="co"># Update 2 centroids mới</span></span>
<span id="cb634-3"><a href="k-means.html#cb634-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Sepal.Length_red =</span> new_centroids_<span class="dv">2</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>],</span>
<span id="cb634-4"><a href="k-means.html#cb634-4"></a>         <span class="dt">Petal.Length_red =</span> new_centroids_<span class="dv">2</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>],</span>
<span id="cb634-5"><a href="k-means.html#cb634-5"></a>         <span class="dt">Sepal.Length_blue =</span> new_centroids_<span class="dv">2</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>],</span>
<span id="cb634-6"><a href="k-means.html#cb634-6"></a>         <span class="dt">Petal.Length_blue =</span> new_centroids_<span class="dv">2</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>]</span>
<span id="cb634-7"><a href="k-means.html#cb634-7"></a>         ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb634-8"><a href="k-means.html#cb634-8"></a><span class="st">  </span><span class="co"># Tính khoảng cách từ các quan sát đến 2 centroids</span></span>
<span id="cb634-9"><a href="k-means.html#cb634-9"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb634-10"><a href="k-means.html#cb634-10"></a>    <span class="dt">distance_red =</span> <span class="kw">sqrt</span>((Sepal.Length<span class="op">-</span>Sepal.Length_red)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(Petal.Length <span class="op">-</span><span class="st"> </span>Petal.Length_red)<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb634-11"><a href="k-means.html#cb634-11"></a>    <span class="dt">distance_blue =</span> <span class="kw">sqrt</span>((Sepal.Length<span class="op">-</span>Sepal.Length_blue)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(Petal.Length <span class="op">-</span><span class="st"> </span>Petal.Length_blue)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb634-12"><a href="k-means.html#cb634-12"></a>    ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb634-13"><a href="k-means.html#cb634-13"></a><span class="st">  </span><span class="co"># Tạo biến mới - nhóm mà các quan sát được phân vào</span></span>
<span id="cb634-14"><a href="k-means.html#cb634-14"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">case_when</span>(</span>
<span id="cb634-15"><a href="k-means.html#cb634-15"></a>    distance_red <span class="op">&lt;</span><span class="st"> </span>distance_blue <span class="op">~</span><span class="st"> &quot;red&quot;</span>,</span>
<span id="cb634-16"><a href="k-means.html#cb634-16"></a>    <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;blue&quot;</span></span>
<span id="cb634-17"><a href="k-means.html#cb634-17"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span>as.factor)</span>
<span id="cb634-18"><a href="k-means.html#cb634-18"></a></span>
<span id="cb634-19"><a href="k-means.html#cb634-19"></a></span>
<span id="cb634-20"><a href="k-means.html#cb634-20"></a><span class="co"># Plot dữ liệu mới  </span></span>
<span id="cb634-21"><a href="k-means.html#cb634-21"></a>data3 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb634-22"><a href="k-means.html#cb634-22"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Sepal.Length, Petal.Length), <span class="dt">group =</span> group) <span class="op">+</span></span>
<span id="cb634-23"><a href="k-means.html#cb634-23"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">col =</span> group))<span class="op">+</span></span>
<span id="cb634-24"><a href="k-means.html#cb634-24"></a><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span></span>
<span id="cb634-25"><a href="k-means.html#cb634-25"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(</span>
<span id="cb634-26"><a href="k-means.html#cb634-26"></a>    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span> =<span class="st"> &quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span> =<span class="st"> &quot;red&quot;</span>)</span>
<span id="cb634-27"><a href="k-means.html#cb634-27"></a>  )<span class="op">+</span></span>
<span id="cb634-28"><a href="k-means.html#cb634-28"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span></span>
<span id="cb634-29"><a href="k-means.html#cb634-29"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>new_centroids_<span class="dv">2</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>],</span>
<span id="cb634-30"><a href="k-means.html#cb634-30"></a>                 <span class="dt">y=</span>new_centroids_<span class="dv">2</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;red&quot;</span>]</span>
<span id="cb634-31"><a href="k-means.html#cb634-31"></a>                 ), </span>
<span id="cb634-32"><a href="k-means.html#cb634-32"></a>             <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb634-33"><a href="k-means.html#cb634-33"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>new_centroids_<span class="dv">2</span><span class="op">$</span>average_sepal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>],</span>
<span id="cb634-34"><a href="k-means.html#cb634-34"></a>                 <span class="dt">y=</span>new_centroids_<span class="dv">2</span><span class="op">$</span>average_petal[new_centroids_<span class="dv">2</span><span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;blue&quot;</span>]</span>
<span id="cb634-35"><a href="k-means.html#cb634-35"></a>                 ), </span>
<span id="cb634-36"><a href="k-means.html#cb634-36"></a>             <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="53-kmeans_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Kết quả phân nhóm vẫn giống như kết quả trước đó, thuật toán dừng lại.</p>
</div>
<div id="thut-toan" class="section level2">
<h2><span class="header-section-number">14.2</span> Thuật toán</h2>
<p>Như vậy, chúng ta có thể khái quát lại <strong>thuật toán của <code>K-means</code></strong> như sau:</p>
<ul>
<li><p><strong>Bước 1</strong>: Chọn ngẫu nhiên K tâm/centroids</p></li>
<li><p><strong>Bước 2</strong>: Tính khoảng cách từ các đối tượng/quan sát đến K tâm</p></li>
<li><p><strong>Bước 3</strong>: Dựa vào giá trị khoảng cách ở bước 2, chúng ta nhóm các quan sát vào K nhóm: Các quan sát gần với tâm nào hơn thì sẽ thuộc về nhóm đó.</p></li>
<li><p><strong>Bước 4</strong>: Xác định các tâm mới của K nhóm (tâm mới của mỗi nhóm có tọa độ bằng trung bình tọa độ của các quan sát trong nhóm đó).</p></li>
<li><p><strong>Bước 5</strong>: Lặp lại bước 2 đến bước 4 cho đến khi không có sự thay đổi kết quả phân nhóm các quan sát hoặc theo số lượng <code>iterations</code> mà chúng ta đặt ra cho thuật toán chạy.</p></li>
</ul>
</div>
<div id="uu-nhuc-im-cua-k-means" class="section level2">
<h2><span class="header-section-number">14.3</span> Ưu nhược điểm của K-means</h2>
<p><strong>Ưu điểm</strong> của thuật toán <code>clustering K-means</code> là đơn giản và dễ tính toán. Tuy nhiên thuật toán này có một số <strong>nhược điểm</strong> sau: Thứ nhất, do lấy ngẫu nhiên tâm/centroid nên khi dữ liệu lớn với rất nhiều các biến đầu vào thuật toán có thể phân loại các quan sát vào các nhóm khác nhau tại mỗi vòng (<code>iteration</code>). Thứ hai, thuật toán sẽ gặp vấn đề nếu các biến đầu vào có các đơn vị khác nhau, ví dụ như: biến chi tiêu hoặc thu nhập của khách hàng đơn vị là triệu đồng, biến đánh dấu khách hàng có sử dụng thẻ tín dụng (dummy 1-0), hoặc biến tỷ lệ chi tiêu thẻ tín dụng trên hạn mức được cấp, v.v.</p>
<p>Vì vậy, để khắc phục vấn đề trên trước khi áp dụng thuật toán <code>K-means</code>, chúng ta cần phải chuẩn hóa dữ liệu đầu vào bằng cách <code>scaling</code> dữ liệu:</p>
<p><span class="math display">\[x_i = \frac{x_i - min(x_i)}{max(x_i) - min(x_i)}\]</span></p>
</div>
<div id="thc-hanh-tren-r" class="section level2">
<h2><span class="header-section-number">14.4</span> Thực hành trên R</h2>
<p>Sau đây chúng ta sẽ cùng tìm hiểu cách thực hiện <code>K-means</code> trên <code>R</code>.</p>
<ul>
<li><strong>Bước 1</strong>: Chuẩn hóa dữ liệu (<code>Scaling</code>):</li>
</ul>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="k-means.html#cb635-1"></a><span class="co"># Scale dữ liệu</span></span>
<span id="cb635-2"><a href="k-means.html#cb635-2"></a>iris_scale &lt;-<span class="st"> </span><span class="kw">scale</span>(iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Species))</span></code></pre></div>
<ul>
<li><strong>Bước 2</strong>: Xác định số lượng nhóm tối ưu</li>
</ul>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="k-means.html#cb636-1"></a><span class="co"># Xác định số lượng nhóm tối ưu</span></span>
<span id="cb636-2"><a href="k-means.html#cb636-2"></a><span class="co">#install.packages(&quot;factoextra&quot;)</span></span>
<span id="cb636-3"><a href="k-means.html#cb636-3"></a><span class="kw">library</span>(factoextra)</span>
<span id="cb636-4"><a href="k-means.html#cb636-4"></a><span class="kw">fviz_nbclust</span>(iris_scale, </span>
<span id="cb636-5"><a href="k-means.html#cb636-5"></a>             kmeans, </span>
<span id="cb636-6"><a href="k-means.html#cb636-6"></a>             <span class="dt">method =</span> <span class="st">&quot;silhouette&quot;</span>)</span></code></pre></div>
<p><img src="53-kmeans_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Kết quả cho thấy trường hợp này chúng ta nên chia làm 2 nhóm sẽ tối ưu. Trong thực tế, việc chia thành bao nhiêu nhóm sẽ phụ thuộc vào mục tiêu kinh doanh, thông thường số lượng nhóm nên từ 2 đến 10.</p>
<ul>
<li><strong>Bước 3</strong>: Thực hiện <code>clustering K-means</code> thành 2 nhóm</li>
</ul>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="k-means.html#cb637-1"></a><span class="co"># Thực hiện thuật toán K-means</span></span>
<span id="cb637-2"><a href="k-means.html#cb637-2"></a>k_means_fit &lt;-<span class="st"> </span><span class="kw">kmeans</span>(iris_scale, </span>
<span id="cb637-3"><a href="k-means.html#cb637-3"></a>                      <span class="dt">centers =</span> <span class="dv">2</span> <span class="co"># số lượng nhóm</span></span>
<span id="cb637-4"><a href="k-means.html#cb637-4"></a>                      )</span>
<span id="cb637-5"><a href="k-means.html#cb637-5"></a></span>
<span id="cb637-6"><a href="k-means.html#cb637-6"></a><span class="co"># Nhóm của các quan sát</span></span>
<span id="cb637-7"><a href="k-means.html#cb637-7"></a>k_means_fit<span class="op">$</span>cluster</span></code></pre></div>
<pre><code>##   [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
##  [36] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [71] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [106] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [141] 1 1 1 1 1 1 1 1 1 1</code></pre>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="k-means.html#cb639-1"></a><span class="co"># Tâm của mỗi nhóm</span></span>
<span id="cb639-2"><a href="k-means.html#cb639-2"></a>k_means_fit<span class="op">$</span>centers</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1    0.5055957  -0.4252069     0.650315   0.6253518
## 2   -1.0111914   0.8504137    -1.300630  -1.2507035</code></pre>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="k-means.html#cb641-1"></a><span class="co"># Số lượng quan sát tại mỗi nhóm</span></span>
<span id="cb641-2"><a href="k-means.html#cb641-2"></a>k_means_fit<span class="op">$</span>size</span></code></pre></div>
<pre><code>## [1] 100  50</code></pre>
<ul>
<li><strong>Bước 4</strong>: Trực quan hóa kết quả</li>
</ul>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="k-means.html#cb643-1"></a><span class="co"># Trực quan hóa kết quả K-means</span></span>
<span id="cb643-2"><a href="k-means.html#cb643-2"></a><span class="kw">fviz_cluster</span>(k_means_fit, </span>
<span id="cb643-3"><a href="k-means.html#cb643-3"></a>             <span class="dt">data =</span> iris_scale,</span>
<span id="cb643-4"><a href="k-means.html#cb643-4"></a>             <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb643-5"><a href="k-means.html#cb643-5"></a>             <span class="dt">main =</span> <span class="st">&quot;Iris Cluster&quot;</span></span>
<span id="cb643-6"><a href="k-means.html#cb643-6"></a>             )<span class="op">+</span></span>
<span id="cb643-7"><a href="k-means.html#cb643-7"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb643-8"><a href="k-means.html#cb643-8"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb643-9"><a href="k-means.html#cb643-9"></a>        <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb643-10"><a href="k-means.html#cb643-10"></a>        <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb643-11"><a href="k-means.html#cb643-11"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()</span>
<span id="cb643-12"><a href="k-means.html#cb643-12"></a>        )</span></code></pre></div>
<p><img src="53-kmeans_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Như vậy, chúng ta đã vừa tìm hiểu về thuật toán <code>clustering K-means</code> cũng như cách thực hiện thuật toán trên <code>R</code>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="unsupervised-learning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="phan-tich-gio-hang.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"split_by": "rmd"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
