<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Phân tích dữ liệu thực tế với R</title>
  <meta name="description" content="A book example for a Chapman &amp; Hall book.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Phân tích dữ liệu thực tế với R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A book example for a Chapman &amp; Hall book." />
  <meta name="github-repo" content="yihui/bookdown-crc" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Phân tích dữ liệu thực tế với R" />
  
  <meta name="twitter:description" content="A book example for a Chapman &amp; Hall book." />
  

<meta name="author" content="Hoàng Đức Anh">


<meta name="date" content="2018-09-24">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html">
<link rel="next" href="phan-ra-va-xoay-chiu-d-liu.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Phân tích dữ liệu thực tế với R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Lời mở đầu</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#tai-sao-nen-oc-cun-sach-nay"><i class="fa fa-check"></i>Tại sao nên đọc cuốn sách này</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cu-truc-cua-sach"><i class="fa fa-check"></i>Cấu trúc của sách</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cac-phn-mm-uc-s-dung"><i class="fa fa-check"></i>Các phần mềm được sử dụng</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#li-cam-on"><i class="fa fa-check"></i>Lời cảm ơn</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="v-tac-gia.html"><a href="v-tac-gia.html"><i class="fa fa-check"></i>Về tác giả</a></li>
<li class="part"><span><b>I Các kiến thức cơ bản</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Khoa học dữ liệu và nghề phân tích dữ liệu</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#khoa-hoc-d-liu"><i class="fa fa-check"></i><b>1.1</b> Khoa học dữ liệu</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#tai-sao-phan-tich-d-liu-la-ngh-kho"><i class="fa fa-check"></i><b>1.2</b> Tại sao phân tích dữ liệu là nghề khó?</a></li>
</ul></li>
<li class="part"><span><b>II Ứng dụng thực tế</b></span></li>
<li class="chapter" data-level="2" data-path="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html"><a href="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html"><i class="fa fa-check"></i><b>2</b> Các phương pháp phân tích dữ liệu thực tế ứng dụng với R</a><ul>
<li class="chapter" data-level="2.1" data-path="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html"><a href="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html#phn-1"><i class="fa fa-check"></i><b>2.1</b> Phần 1</a></li>
<li class="chapter" data-level="2.2" data-path="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html"><a href="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html#phn-2"><i class="fa fa-check"></i><b>2.2</b> Phần 2</a></li>
<li class="chapter" data-level="2.3" data-path="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html"><a href="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html#phn-3"><i class="fa fa-check"></i><b>2.3</b> Phần 3</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><i class="fa fa-check"></i><b>3</b> Ngữ pháp của biến đổi dữ liệu với DPLYR</a><ul>
<li class="chapter" data-level="3.1" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#gii-thiu-v-pipe-operator"><i class="fa fa-check"></i><b>3.1</b> Giới thiệu về pipe operator</a></li>
<li class="chapter" data-level="3.2" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#cac-ham-co-ban-trong-dplyr"><i class="fa fa-check"></i><b>3.2</b> Các hàm cơ bản trong dplyr</a><ul>
<li class="chapter" data-level="3.2.1" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#nhom-cau-lnh-truy-vn-d-liu"><i class="fa fa-check"></i><b>3.2.1</b> Nhóm câu lệnh truy vấn dữ liệu</a></li>
<li class="chapter" data-level="3.2.2" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#nhom-cau-lnh-bin-i-d-liu"><i class="fa fa-check"></i><b>3.2.2</b> Nhóm câu lệnh biến đổi dữ liệu</a></li>
<li class="chapter" data-level="3.2.3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#nhom-ham-tng-hp-d-liu-vi-summarise"><i class="fa fa-check"></i><b>3.2.3</b> Nhóm hàm tổng hợp dữ liệu với <code>summarise</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#cac-ham-nang-cao-trong-dplyr"><i class="fa fa-check"></i><b>3.3</b> Các hàm nâng cao trong dplyr</a><ul>
<li class="chapter" data-level="3.3.1" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#iu-kin-phan-nhom-vi-case_when"><i class="fa fa-check"></i><b>3.3.1</b> Điều kiện phân nhóm với <code>case_when</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#tao-them-bin-mi-theo-iu-kin-vi-mutate_if-mutate_at"><i class="fa fa-check"></i><b>3.3.2</b> Tạo thêm biến mới theo điều kiện với <code>mutate_if</code> &amp; <code>mutate_at</code></a></li>
<li class="chapter" data-level="3.3.3" data-path="ng-phap-cua-bin-i-d-liu-vi-dplyr.html"><a href="ng-phap-cua-bin-i-d-liu-vi-dplyr.html#tng-hp-d-liu-theo-iu-kin-vi-summarise_at-va-summarise_if"><i class="fa fa-check"></i><b>3.3.3</b> Tổng hợp dữ liệu theo điều kiện với <code>summarise_at</code> và <code>summarise_if</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html"><i class="fa fa-check"></i><b>4</b> Phân rã và xoay chiều dữ liệu</a><ul>
<li class="chapter" data-level="4.1" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#phan-ra-d-liu-thanh-dang-doc-vi-gather"><i class="fa fa-check"></i><b>4.1</b> Phân rã dữ liệu thành dạng dọc với <code>gather</code></a></li>
<li class="chapter" data-level="4.2" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#xoay-chiu-d-liu-vi-spread"><i class="fa fa-check"></i><b>4.2</b> Xoay chiều dữ liệu với <code>spread</code></a></li>
<li class="chapter" data-level="4.3" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#tach-mt-bin-thanh-nhiu-bin-vi-separate"><i class="fa fa-check"></i><b>4.3</b> Tách một biến thành nhiều biến với <code>separate</code></a></li>
<li class="chapter" data-level="4.4" data-path="phan-ra-va-xoay-chiu-d-liu.html"><a href="phan-ra-va-xoay-chiu-d-liu.html#gp-nhiu-bin-thanh-mt-bin-vi-unite"><i class="fa fa-check"></i><b>4.4</b> Gộp nhiều biến thành một biến với <code>unite</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html"><i class="fa fa-check"></i><b>5</b> Lập trình chức năng hàm với purrr</a><ul>
<li class="chapter" data-level="5.1" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#nhom-ham-map"><i class="fa fa-check"></i><b>5.1</b> Nhóm hàm map</a></li>
<li class="chapter" data-level="5.2" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#sa-i-gia-tri-vi-modify"><i class="fa fa-check"></i><b>5.2</b> Sửa đổi giá trị với <code>modify</code></a></li>
<li class="chapter" data-level="5.3" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#ng-dung"><i class="fa fa-check"></i><b>5.3</b> Ứng dụng</a><ul>
<li class="chapter" data-level="5.3.1" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#bin-i-d-liu-vi-modify-va-map_df"><i class="fa fa-check"></i><b>5.3.1</b> Biến đổi dữ liệu với <code>modify</code> và <code>map_df</code></a></li>
<li class="chapter" data-level="5.3.2" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#phan-tich-nhiu-nhom-khac-nhau-cung-luc"><i class="fa fa-check"></i><b>5.3.2</b> Phân tích nhiều nhóm khác nhau cùng lúc</a></li>
<li class="chapter" data-level="5.3.3" data-path="lp-trinh-chc-nang-ham-vi-purrr.html"><a href="lp-trinh-chc-nang-ham-vi-purrr.html#phan-tich-nhiu-bin-trong-dataframe-cung-luc"><i class="fa fa-check"></i><b>5.3.3</b> Phân tích nhiều biến trong dataframe cùng lúc</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Machine Learning</b></span></li>
<li class="chapter" data-level="6" data-path="khai-quat-v-hoc-may.html"><a href="khai-quat-v-hoc-may.html"><i class="fa fa-check"></i><b>6</b> Khái quát về học máy</a><ul>
<li class="chapter" data-level="6.1" data-path="khai-quat-v-hoc-may.html"><a href="khai-quat-v-hoc-may.html#gii-thiu"><i class="fa fa-check"></i><b>6.1</b> Giới thiệu</a></li>
<li class="chapter" data-level="6.2" data-path="khai-quat-v-hoc-may.html"><a href="khai-quat-v-hoc-may.html#quy-trinh-xay-dng-mo-hinh-d-bao"><i class="fa fa-check"></i><b>6.2</b> Quy trình xây dựng mô hình dự báo</a></li>
<li class="chapter" data-level="6.3" data-path="khai-quat-v-hoc-may.html"><a href="khai-quat-v-hoc-may.html#cac-nhom-thut-ng-cn-nh"><i class="fa fa-check"></i><b>6.3</b> Các nhóm thuật ngữ cần nhớ</a></li>
<li class="chapter" data-level="6.4" data-path="khai-quat-v-hoc-may.html"><a href="khai-quat-v-hoc-may.html#luu-y"><i class="fa fa-check"></i><b>6.4</b> Lưu ý</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html"><i class="fa fa-check"></i><b>7</b> Phân tích giỏ hàng</a><ul>
<li class="chapter" data-level="7.1" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#cac-khai-nim-co-ban"><i class="fa fa-check"></i><b>7.1</b> Các khái niệm cơ bản</a></li>
<li class="chapter" data-level="7.2" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#cach-thc-hin-mo-hinh"><i class="fa fa-check"></i><b>7.2</b> Cách thực hiện mô hình</a></li>
<li class="chapter" data-level="7.3" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#ba-cau-hoi-khi-phan-tich-gio-hang"><i class="fa fa-check"></i><b>7.3</b> Ba câu hỏi khi phân tích giỏ hàng</a><ul>
<li class="chapter" data-level="7.3.1" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#cac-san-phm-nao-hay-uc-mua-cung-nhau"><i class="fa fa-check"></i><b>7.3.1</b> Các sản phẩm nào hay được mua cùng nhau</a></li>
<li class="chapter" data-level="7.3.2" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#khach-hang-mua-san-phm-a-thi-se-mua-san-phm-nao-tip-theo"><i class="fa fa-check"></i><b>7.3.2</b> Khách hàng mua sản phẩm A thì sẽ mua sản phẩm nào tiếp theo?</a></li>
<li class="chapter" data-level="7.3.3" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#khach-hang-mua-san-phm-gi-thi-se-mua-tip-san-phm-a"><i class="fa fa-check"></i><b>7.3.3</b> Khách hàng mua sản phẩm gì thì sẽ mua tiếp sản phẩm A?</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="phan-tich-gio-hang.html"><a href="phan-tich-gio-hang.html#uu-nhuc-im"><i class="fa fa-check"></i><b>7.4</b> Ưu nhược điểm</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="feature-engineering.html"><a href="feature-engineering.html"><i class="fa fa-check"></i><b>8</b> Feature Engineering</a><ul>
<li class="chapter" data-level="8.1" data-path="feature-engineering.html"><a href="feature-engineering.html#feature-engineering-cho-cac-bin-nhom"><i class="fa fa-check"></i><b>8.1</b> Feature engineering cho các biến nhóm</a><ul>
<li class="chapter" data-level="8.1.1" data-path="feature-engineering.html"><a href="feature-engineering.html#tao-d-liu-gia-dummy-data-cho-bin-khong-phan-bit-th-t"><i class="fa fa-check"></i><b>8.1.1</b> Tạo dữ liệu giả (dummy data) cho biến không phân biệt thứ tự</a></li>
<li class="chapter" data-level="8.1.2" data-path="feature-engineering.html"><a href="feature-engineering.html#d-liu-co-rt-nhiu-nhom"><i class="fa fa-check"></i><b>8.1.2</b> Dữ liệu có rất nhiều nhóm</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="feature-engineering.html"><a href="feature-engineering.html#cac-bin-lien-tuc"><i class="fa fa-check"></i><b>8.2</b> Các biến liên tục</a><ul>
<li class="chapter" data-level="8.2.1" data-path="feature-engineering.html"><a href="feature-engineering.html#bin-i-11"><i class="fa fa-check"></i><b>8.2.1</b> Biến đổi 1:1</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Chuỗi thời gian</b></span></li>
<li class="chapter" data-level="9" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html"><i class="fa fa-check"></i><b>9</b> Giới thiệu về chuỗi thời gian</a><ul>
<li class="chapter" data-level="9.1" data-path="gii-thiu-v-chui-thi-gian.html"><a href="gii-thiu-v-chui-thi-gian.html#thanh-phn-cua-chui-thi-gian"><i class="fa fa-check"></i><b>9.1</b> Thành phần của chuỗi thời gian</a></li>
</ul></li>
<li class="part"><span><b>V Case study</b></span></li>
<li class="chapter" data-level="10" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html"><i class="fa fa-check"></i><b>10</b> Trực quan hóa dữ liệu</a><ul>
<li class="chapter" data-level="10.1" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html#xay-dng-phu-ban-hang-theo-tng-nhom"><i class="fa fa-check"></i><b>10.1</b> Xây dựng phễu bán hàng theo từng nhóm</a></li>
<li class="chapter" data-level="10.2" data-path="trc-quan-hoa-d-liu.html"><a href="trc-quan-hoa-d-liu.html#ve-biu--warterfall-cho-aciveinactive-users"><i class="fa fa-check"></i><b>10.2</b> Vẽ biểu đồ warterfall cho acive/inactive users</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="more-to-say.html"><a href="more-to-say.html"><i class="fa fa-check"></i><b>A</b> More to Say</a></li>
<li class="chapter" data-level="" data-path="tai-liu-tham-khao.html"><a href="tai-liu-tham-khao.html"><i class="fa fa-check"></i>Tài liệu tham khảo</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Phân tích dữ liệu thực tế với R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ng-phap-cua-bin-i-d-liu-vi-dplyr" class="section level1">
<h1><span class="header-section-number">Chương 3</span> Ngữ pháp của biến đổi dữ liệu với DPLYR</h1>
<p>Khi bắt tay vào công việc phân tích số liệu, việc đầu tiên ta cần phải làm là thu thập dữ liệu từ nhiều nguồn khác nhau. Sau khi hoàn thành xong bước này, ta sẽ phải dành phần lớn thời gian để làm sạch, biến đổi và tổng hợp dữ liệu nhằm tìm kiếm các insights hoặc chuẩn bị dữ liệu cho các bước xây dựng mô hình, dự báo.</p>
<p>R rất mạnh trong việc biến đối dữ liệu và có rất nhiều package hỗ trợ cho công việc này. Tuy nhiên, thư viện nổi tiếng nhất trong R trong việc làm sạch và biến đổi dữ liệu là <code>dplyr</code>, một thư viện nổi tiếng với những tính năng chuyên cho việc xử lý, tổng hợp dữ liệu trước khi xây dựng mô hình phân tích dữ liệu. Chương này sẽ tập trung vào giới thiệu về những hàm cơ bản nhất của <code>dplyr</code>.</p>
<p>Trước khi bắt đầu nội dung bài giảng, chúng ta có thể download và gọi gói dplyr.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">#install.packages(&quot;dplyr&quot;)</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<div id="gii-thiu-v-pipe-operator" class="section level2">
<h2><span class="header-section-number">3.1</span> Giới thiệu về pipe operator</h2>
<p>Khi viết các câu lệnh, thông thường ta có 2 cách viết phổ biến sau.</p>
<ul>
<li><p>Cách 1: Viết với các câu lệnh lồng vào nhau (nested). Với cách viết này, các hàm sẽ được viết lồng vào nhau và kết quả của hàm sẽ được tính toán theo thứ tự từ trong ra ngoài.</p></li>
<li><p>Cách 2: Viết lưu dưới dạng các đối tượng trung gian. Với cách viết này, từng đối tượng sẽ được tính toán từng phần và kết quả sẽ được hiển thị một cách mạch lạc hơn. Tuy nhiên, nhược điểm của phương pháp này là sẽ tạo ra rất nhiều đối tượng trung gian, gây ra khó khăn trong việc theo dõi và quản lỹ.</p></li>
</ul>
<p>Giả sử ta cần tính toán độ lệch chuẩn của véc-tơ x, công thức tính độ lệch chuẩn sẽ là</p>
<p><span class="math display">\[\sigma = \frac{\sum_{i=1}^n(x_i-\overline{x})^2}{n-1}\]</span></p>
<p>Với hai cách viết code khác nhau, ta có thể tính độ lệch chuẩn theo hai cách.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Cách 1</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># Tạo vector x</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">100</span>, <span class="dv">2</span>)  </a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># Tính độ lệch chuẩn</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw">sqrt</span>(<span class="kw">sum</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>))</a></code></pre></div>
<pre><code>## [1] 29.15</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">sd</span>(x)</a></code></pre></div>
<pre><code>## [1] 29.15</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Cách 2</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># Tạo vector x</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">100</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co"># Tính tổng bình phương </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">sum_sqr &lt;-<span class="st"> </span><span class="kw">sum</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">len_x &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">var &lt;-<span class="st"> </span>sum_sqr<span class="op">/</span>(len_x <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">sd &lt;-<span class="st"> </span>var<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">sd</a></code></pre></div>
<pre><code>## [1] 29.15</code></pre>
<p>Ta thấy kết quả ở hai cách tính là như nhau. Tuy nhiên, cách viết hai sẽ tạo ra nhiều đối tượng trung gian hơn cách viết 1 rất nhiều. Khi phân tích dữ liệu thực tế, ta sẽ phải áp dụng cả 2 cách viết code để có thể vận dụng linh hoạt trong từng trường hợp cụ thể.</p>
<p>Trong R, có cách viết code thứ ba, được gọi là cách suwr dụng <code>pipe operator</code> <code>(%&gt;%)</code>. <code>Toán tử Pipe</code> cho phép viết code theo cách đơn giản và dễ theo dõi giúp cho người đọc và người viết code trên R có thể theo dõi được code một cách dễ dàng nhất. Câu trúc của pipe như sau</p>
<blockquote>
<p>f(x, y) = x %&gt;% f(., y)</p>
</blockquote>
<p>Ví dụ của pipe.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Cách 1</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co"># Cách 2</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">x <span class="op">%&gt;%</span><span class="st"> </span>mean</a></code></pre></div>
<p>Ta có thể xem xét ví dụ phức tạp hơn.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Cách 1 - dùng cách viết thường</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">summary</span>(<span class="kw">head</span>(iris))</a></code></pre></div>
<pre><code>##   Sepal.Length   Sepal.Width    Petal.Length 
##  Min.   :4.60   Min.   :3.00   Min.   :1.30  
##  1st Qu.:4.75   1st Qu.:3.12   1st Qu.:1.40  
##  Median :4.95   Median :3.35   Median :1.40  
##  Mean   :4.95   Mean   :3.38   Mean   :1.45  
##  3rd Qu.:5.08   3rd Qu.:3.58   3rd Qu.:1.48  
##  Max.   :5.40   Max.   :3.90   Max.   :1.70  
##   Petal.Width          Species 
##  Min.   :0.200   setosa    :6  
##  1st Qu.:0.200   versicolor:0  
##  Median :0.200   virginica :0  
##  Mean   :0.233                 
##  3rd Qu.:0.200                 
##  Max.   :0.400</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># Cách 2 - dùng pipe</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">iris <span class="op">%&gt;%</span><span class="st"> </span>head <span class="op">%&gt;%</span><span class="st"> </span>summary</a></code></pre></div>
<pre><code>##   Sepal.Length   Sepal.Width    Petal.Length 
##  Min.   :4.60   Min.   :3.00   Min.   :1.30  
##  1st Qu.:4.75   1st Qu.:3.12   1st Qu.:1.40  
##  Median :4.95   Median :3.35   Median :1.40  
##  Mean   :4.95   Mean   :3.38   Mean   :1.45  
##  3rd Qu.:5.08   3rd Qu.:3.58   3rd Qu.:1.48  
##  Max.   :5.40   Max.   :3.90   Max.   :1.70  
##   Petal.Width          Species 
##  Min.   :0.200   setosa    :6  
##  1st Qu.:0.200   versicolor:0  
##  Median :0.200   virginica :0  
##  Mean   :0.233                 
##  3rd Qu.:0.200                 
##  Max.   :0.400</code></pre>
<p>Cả hai cách đều cho ra kết quả giống nhau. Tuy nhiên, cách hai sẽ dễ theo dõi, dễ đọc hơn cách 1 rất nhiều. Cách đọc hiểu quá trình thực hiện pipe như sau:</p>
<ol style="list-style-type: decimal">
<li>Gọi tập dữ liệu <code>iris</code> để phân tích</li>
<li>Thực hiện hàm <code>head</code> trên tập dữ liệu này, <em>được kết quả bao nhiêu</em>…</li>
<li>… tiếp tục thực hiện hàm <code>summary</code></li>
</ol>
<p>Như ta thấy, cách viết theo phong cách của <code>pipe operator (%&gt;%)</code> cho phép ta thực hiện các phép tính theo đúng mạch tư duy logic của bản thân. Điều này là một điểm rất mạnh mà hiện tại, mới chỉ ở R có toán tử <code>%&gt;%</code> áp dụng được cho mọi hàm.</p>
<p><strong>Một số đặc tính cơ bản của <code>%&gt;%</code></strong>:</p>
<ol style="list-style-type: decimal">
<li>Theo mặc định, Phía tay trái (LHS) sẽ được chuyển tiếp thành yếu tố đầu tiên của hàm được sử dụng phía tay phải (RHS), ví dụ:</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">mean</span>(x) </a></code></pre></div>
<pre><code>## [1] 51</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># Tương đương với:</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">x <span class="op">%&gt;%</span><span class="st"> </span>mean</a></code></pre></div>
<pre><code>## [1] 51</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Khi LHS không còn là yếu tố đầu tiên của một hàm RHS, thì dấu “.” được sử dụng để định vị cho LHS, ví dụ:</li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co"># Cách 1</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="kw">summary</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl, <span class="dt">data =</span> mtcars))</a>
<a class="sourceLine" id="cb21-4" data-line-number="4"></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co"># Cách 2</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="st">  </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl, <span class="dt">data =</span> .) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="st">  </span>summary</a></code></pre></div>
<p>Trong tình huống trên, tham số về dữ liệu trong hàm lm không phải là ở đầu, mà sau phần công thức, nên chúng ta sẽ dùng dấu “.” như là đại diện của thực thể mtcars ở bên ngoài (LHS) của hàm lm.</p>
</div>
<div id="cac-ham-co-ban-trong-dplyr" class="section level2">
<h2><span class="header-section-number">3.2</span> Các hàm cơ bản trong dplyr</h2>
<p>Trong công việc biến đổi dữ liệu, bất kỳ ngôn ngữ phân tích nào cũng có 3 nhóm hàm lớn.</p>
<ul>
<li>Nhóm 1 - các hàm truy vấn dữ liệu: Lấy dữ liệu theo dòng, theo cột và theo điều kiện. Trong <code>dplyr</code> sẽ là các hàm <code>select</code>, <code>filter</code> và <code>slice</code></li>
<li>Nhóm 2 - Các hàm tổng hợp dữ liệu: Tính toán tổng hợp dữ liệu theo chiều. Trong <code>dplyr</code> sẽ là các hàm <code>group_by</code>, <code>summarise</code></li>
<li>Nhóm 3 - Các hàm biến đổi dữ liệu: Tạo mới, biến đổi các dữ liệu cũ thành các dữ liệu mới. Trong <code>dplyr</code> sẽ là các hàm thuộc nhóm <code>mutate</code>, <code>join</code>, <code>bind</code></li>
</ul>
<p>Trong phần này, chúng ta sẽ giới thiệu nhanh các nhóm câu lệnh cơ bản trên.</p>
<div id="nhom-cau-lnh-truy-vn-d-liu" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Nhóm câu lệnh truy vấn dữ liệu</h3>
<p>Khi truy vấn dữ liệu, ta thường phải thực hiện 3 nhóm công việc sau.</p>
<ul>
<li>Lấy theo cột</li>
<li>Lấy theo dòng</li>
<li>Lấy theo điều kiện</li>
</ul>
<p>Xét về mặt bản chất, lấy theo điều kiện là một trường hợp đặc biệt của việc lấy theo dòng. Đối với các ngôn ngữ như SQL, sẽ không phân biệt hai loại này. Tuy nhiên, vì R lưu thứ tự của từng quan sát trong dataframe, nên việc phân biệt được hai loại truy vấn trên là cần thiết.</p>
<div id="ly-cac-ct-trong-dataframe-vi-select" class="section level4">
<h4><span class="header-section-number">3.2.1.1</span> Lấy các cột trong dataframe với <code>select</code></h4>
<blockquote>
<p>data %&gt;% select(var1, var2, …)</p>
</blockquote>
<p>Trong đó, <code>var1</code>, <code>var2</code> là tên các cột cần truy vấn. Đặc biệt, R rất linh hoạt trong việc lọc theo cột. Ta có thể truy vấn theo tên, theo thứ tự hoặc thậm chí theo các khoảng thứ tự các biến. Xem ví dụ sau.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="co"># Xêm tên các biến trong mtcars</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">mtcars <span class="op">%&gt;%</span><span class="st"> </span>names</a></code></pre></div>
<pre><code>##  [1] &quot;mpg&quot;  &quot;cyl&quot;  &quot;disp&quot; &quot;hp&quot;   &quot;drat&quot; &quot;wt&quot;   &quot;qsec&quot;
##  [8] &quot;vs&quot;   &quot;am&quot;   &quot;gear&quot; &quot;carb&quot;</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># Chọn cột mpg và cyl</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(mpg, cyl) <span class="op">%&gt;%</span><span class="st"> </span>head</a></code></pre></div>
<pre><code>##                    mpg cyl
## Mazda RX4         21.0   6
## Mazda RX4 Wag     21.0   6
## Datsun 710        22.8   4
## Hornet 4 Drive    21.4   6
## Hornet Sportabout 18.7   8
## Valiant           18.1   6</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># Chọn cột thứ nhất và thứ hai</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dv">1</span>,<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span>head</a></code></pre></div>
<pre><code>##                    mpg cyl
## Mazda RX4         21.0   6
## Mazda RX4 Wag     21.0   6
## Datsun 710        22.8   4
## Hornet 4 Drive    21.4   6
## Hornet Sportabout 18.7   8
## Valiant           18.1   6</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># Chọn cột thứ 3 đến cột thứ 6</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>) <span class="op">%&gt;%</span><span class="st"> </span>head</a></code></pre></div>
<pre><code>##                   disp  hp drat    wt
## Mazda RX4          160 110 3.90 2.620
## Mazda RX4 Wag      160 110 3.90 2.875
## Datsun 710         108  93 3.85 2.320
## Hornet 4 Drive     258 110 3.08 3.215
## Hornet Sportabout  360 175 3.15 3.440
## Valiant            225 105 2.76 3.460</code></pre>
<p> </p>
<p>Ngoài ra, khi lấy chi tiết các cột (liệt kê từng cột) khi lấy dữ liệu trên 1 bảng, bạn có thể dùng một số hàm sau để hỗ trợ việc lấy trường dữ liệu được nhanh hơn:</p>
<ul>
<li><code>starts_with(&quot;Ký tự là thông tin mong muốn&quot;)</code>: các cột dữ liệu ccó tên hứa các ký tự mong muốn đứng ở đầu của tên, ví dụ:</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">iris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;Petal&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="st">  </span>head</a></code></pre></div>
<pre><code>##   Petal.Length Petal.Width
## 1          1.4         0.2
## 2          1.4         0.2
## 3          1.3         0.2
## 4          1.5         0.2
## 5          1.4         0.2
## 6          1.7         0.4</code></pre>
<ul>
<li><code>ends_with(&quot;Ký tự là thông tin mong muốn&quot;)</code>: các cột dữ liệu có tên chứa các ký tự mong muốn ở cuối của tên, ví dụ:</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">iris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">ends_with</span>(<span class="st">&quot;Length&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="st">  </span>head</a></code></pre></div>
<pre><code>##   Sepal.Length Petal.Length
## 1          5.1          1.4
## 2          4.9          1.4
## 3          4.7          1.3
## 4          4.6          1.5
## 5          5.0          1.4
## 6          5.4          1.7</code></pre>
<ul>
<li><code>contains(&quot;Ký tự là thông tin mong muốn&quot;)</code>: các cột dữ liệu có tên chứa chính xác các ký tự mong muốn ở bất kỳ vị trí nào của tên, ví dụ:</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">iris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;etal&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-3" data-line-number="3"><span class="st">  </span>head</a></code></pre></div>
<pre><code>##   Petal.Length Petal.Width
## 1          1.4         0.2
## 2          1.4         0.2
## 3          1.3         0.2
## 4          1.5         0.2
## 5          1.4         0.2
## 6          1.7         0.4</code></pre>
<ul>
<li>matches(“Dạng ký tự là thông tin mong muốn”): các cột dữ liệu có tên chứa các ký tự có dạng ký tự mong muốn ở bất kỳ vị trí nào của tên, ví dụ:</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">iris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">matches</span>(<span class="st">&quot;.t.&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="st">  </span>head</a></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1          5.1         3.5          1.4         0.2
## 2          4.9         3.0          1.4         0.2
## 3          4.7         3.2          1.3         0.2
## 4          4.6         3.1          1.5         0.2
## 5          5.0         3.6          1.4         0.2
## 6          5.4         3.9          1.7         0.4</code></pre>
<p>Trong ví dụ trên, R sẽ lấy tất cả các cột có tên chứa chữ t và có ký tự khác ở trước và sau (các ký tự chỉ chứa chữ t mà chữ t ở đâu hoặc cuối tên sẽ không được tính vào)</p>
<p>Thêm vào đó, ta có thể đổi tên biến ngay trong khi lựa chọn các biến với <code>select</code> như sau:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">mtcars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">miles per gallon</span><span class="st">`</span> =<span class="st"> </span>mpg</a>
<a class="sourceLine" id="cb38-3" data-line-number="3">         , <span class="dt">cylinder =</span> cyl</a>
<a class="sourceLine" id="cb38-4" data-line-number="4">         , <span class="dt">weight =</span> wt) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-5" data-line-number="5"><span class="st">  </span>head</a></code></pre></div>
<pre><code>##                   miles per gallon cylinder weight
## Mazda RX4                     21.0        6  2.620
## Mazda RX4 Wag                 21.0        6  2.875
## Datsun 710                    22.8        4  2.320
## Hornet 4 Drive                21.4        6  3.215
## Hornet Sportabout             18.7        8  3.440
## Valiant                       18.1        6  3.460</code></pre>
</div>
<div id="ly-cac-dong-trong-dataframe-vi-slice" class="section level4">
<h4><span class="header-section-number">3.2.1.2</span> Lấy các dòng trong dataframe với <code>slice</code></h4>
<blockquote>
<p>data %&gt;% slice(observation)</p>
</blockquote>
<p>Tương tự như lấy theo cột, ta có thể lấy các dòng trong một dataframe. Tuy nhiên, lưu ý hàm <code>slice</code> chỉ cho phép điều kiện lấy quan sát là một véc-tơ. Xem ví dụ sau.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># Lấy dòng đầu tiên</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 11
##     mpg   cyl  disp    hp  drat    wt  qsec    vs
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1    21     6   160   110   3.9  2.62  16.5     0
## # ... with 3 more variables: am &lt;dbl&gt;, gear &lt;dbl&gt;,
## #   carb &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co"># Lấy dòng từ 1:3</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 11
##     mpg   cyl  disp    hp  drat    wt  qsec    vs
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  21       6   160   110  3.9   2.62  16.5     0
## 2  21       6   160   110  3.9   2.88  17.0     0
## 3  22.8     4   108    93  3.85  2.32  18.6     1
## # ... with 3 more variables: am &lt;dbl&gt;, gear &lt;dbl&gt;,
## #   carb &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="co"># Lấy dòng 1:3 và 5</span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">5</span>))</a></code></pre></div>
<pre><code>## # A tibble: 4 x 11
##     mpg   cyl  disp    hp  drat    wt  qsec    vs
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  21       6   160   110  3.9   2.62  16.5     0
## 2  21       6   160   110  3.9   2.88  17.0     0
## 3  22.8     4   108    93  3.85  2.32  18.6     1
## 4  18.7     8   360   175  3.15  3.44  17.0     0
## # ... with 3 more variables: am &lt;dbl&gt;, gear &lt;dbl&gt;,
## #   carb &lt;dbl&gt;</code></pre>
</div>
<div id="loc-quan-sat-theo-iu-kin-vi-filter" class="section level4">
<h4><span class="header-section-number">3.2.1.3</span> Lọc quan sát theo điều kiện với <code>filter</code></h4>
<blockquote>
<p>data %&gt;% filter(condition)</p>
</blockquote>
<p>Hàm filter cho phép ta sử dụng các điều kiện phức tạp để truy xuất dữ liệu từ dataframe. Các điều kiện thường dùng bao gồm.</p>
<table>
<thead>
<tr class="header">
<th>Dấu</th>
<th>Ký hiệu</th>
<th>Ví dụ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bằng</td>
<td><code>==</code></td>
<td><code>7==8</code></td>
</tr>
<tr class="even">
<td>Khác</td>
<td><code>!=</code></td>
<td><code>7!=8</code></td>
</tr>
<tr class="odd">
<td>Lớn hơn</td>
<td><code>&gt;</code></td>
<td><code>a &gt; b</code></td>
</tr>
<tr class="even">
<td>Lớn hơn hoặc bằng</td>
<td><code>&gt;=</code></td>
<td><code>a &gt;= b</code></td>
</tr>
<tr class="odd">
<td>Nhỏ hơn</td>
<td><code>&lt;</code></td>
<td><code>a &lt; b</code></td>
</tr>
<tr class="even">
<td>Nhỏ hơn hoặc bằng</td>
<td><code>&lt;=</code></td>
<td><code>a &lt;= b</code></td>
</tr>
<tr class="odd">
<td>Và</td>
<td><code>&amp;</code></td>
<td><code>a &gt; 7 &amp; b &lt; 9</code></td>
</tr>
</tbody>
</table>
<p>Xem ví dụ sau.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co"># Lọc điều kiện mpg &gt; 20</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">mtcars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(mpg <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="st">  </span>dim</a></code></pre></div>
<pre><code>## [1] 14 11</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="co"># Lọc điều kiện mpg &gt;20 hoặc mpg &lt;18</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(mpg <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span> <span class="op">|</span><span class="st"> </span>mpg <span class="op">&lt;</span><span class="st"> </span><span class="dv">18</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="st">  </span>dim</a></code></pre></div>
<pre><code>## [1] 27 11</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="co"># Lọc điều kiện mpg &gt;=20 và cyl = 6</span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb50-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(mpg <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span> <span class="op">&amp;</span><span class="st"> </span>cyl <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</a></code></pre></div>
<pre><code>##    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## 1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## 2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## 3 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1</code></pre>
<p><strong>Lưu ý</strong>: Khi điều kiện <em>hoặc</em> là chuỗi các giá trị rời rạc áp dụng cho cùng một trường, chúng ta có thể làm ngắn gọn hơn với cấu trúc “%in%” thay vì cấu phải liệt kê tất cả các điều kiện đơn lẻ và ngăn cách nhau bởi dấu “|”:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">mtcars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="st"> </span><span class="kw">filter</span>(carb <span class="op">==</span><span class="st"> </span><span class="dv">4</span> <span class="op">|</span><span class="st"> </span>carb <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">|</span><span class="st"> </span>carb <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>##     mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## 1  21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
## 2  21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
## 3  22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## 4  21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## 5  18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
## 6  14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
## 7  19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
## 8  17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
## 9  16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## 10 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
## 11 15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
## 12 10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
## 13 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
## 14 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
## 15 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## 16 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
## 17 21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
## 18 13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
## 19 27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
## 20 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4</code></pre>
<p>Câu lệnh trên tương đương với:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">mtcars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(carb <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>))</a></code></pre></div>
</div>
<div id="sp-xp-d-liu-vi-arrange" class="section level4">
<h4><span class="header-section-number">3.2.1.4</span> Sắp xếp dữ liệu với <code>arrange</code></h4>
<blockquote>
<p>data %&gt;% arrange(var1, var2)</p>
</blockquote>
<p>Ngoài việc lọc dữ liệu có điều kiện, chúng ta cũng thường xuyên thực hiện việc sắp xếp dữ liệu theo một trật tự nhất định nào đó khi xem dữ liệu. Hàm arrange() hỗ trợ công việc này. Cách thức sắp xếp dữ liệu mặc định là từ nhỏ đến lớn.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">mtcars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="st">  </span><span class="kw">arrange</span>(mpg) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="st">  </span>head</a></code></pre></div>
<pre><code>##    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## 1 10.4   8  472 205 2.93 5.250 17.98  0  0    3    4
## 2 10.4   8  460 215 3.00 5.424 17.82  0  0    3    4
## 3 13.3   8  350 245 3.73 3.840 15.41  0  0    3    4
## 4 14.3   8  360 245 3.21 3.570 15.84  0  0    3    4
## 5 14.7   8  440 230 3.23 5.345 17.42  0  0    3    4
## 6 15.0   8  301 335 3.54 3.570 14.60  0  1    5    8</code></pre>
<p>Khi có nhiều biến cần được sắp xếp, hàm <code>arrange</code> sẽ ưu tiên các biến theo thứ tự từ trái sang phải.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(mpg, cyl)</a></code></pre></div>
<pre><code>##     mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## 1  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
## 2  10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
## 3  13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
## 4  14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
## 5  14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
## 6  15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
## 7  15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
## 8  15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
## 9  15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
## 10 15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
## 11 16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## 12 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
## 13 17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
## 14 18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
## 15 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## 16 19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
## 17 19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
## 18 19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
## 19 21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
## 20 21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
## 21 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
## 22 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## 23 21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
## 24 22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## 25 22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
## 26 24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
## 27 26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
## 28 27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
## 29 30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
## 30 30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
## 31 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## 32 33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1</code></pre>
</div>
<div id="i-ten-bin-vi-rename" class="section level4">
<h4><span class="header-section-number">3.2.1.5</span> Đổi tên biến với <code>rename</code></h4>
<blockquote>
<p>data %&gt;% rename(new_var = old_var)</p>
</blockquote>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">mtcars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb59-2" data-line-number="2"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">displacement =</span> disp,</a>
<a class="sourceLine" id="cb59-3" data-line-number="3">         <span class="dt">miles_per_gallon =</span> mpg) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-4" data-line-number="4"><span class="st">  </span>names</a></code></pre></div>
<pre><code>##  [1] &quot;miles_per_gallon&quot; &quot;cyl&quot;             
##  [3] &quot;displacement&quot;     &quot;hp&quot;              
##  [5] &quot;drat&quot;             &quot;wt&quot;              
##  [7] &quot;qsec&quot;             &quot;vs&quot;              
##  [9] &quot;am&quot;               &quot;gear&quot;            
## [11] &quot;carb&quot;</code></pre>
</div>
</div>
<div id="nhom-cau-lnh-bin-i-d-liu" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Nhóm câu lệnh biến đổi dữ liệu</h3>
<div id="tao-mi-trung-d-liu-vi-mutate" class="section level5">
<h5><span class="header-section-number">3.2.2.0.1</span> Tạo mới trường dữ liệu với <code>mutate</code></h5>
<p>Trong quá trình xử lý dữ liệu, ta thường xuyên phải tạo thêm các trường dữ liệu mới (trường dữ liệu phát sinh). Hàm mutate() được sử dụng để làm công việc này. Cấu trúc của hàm rất đơn giản như sau.</p>
<blockquote>
<p>data %&gt;% mutate(new_var = statement)</p>
</blockquote>
<p>Xem ví dụ sau</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">mtcars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(mpg) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">new_mpg =</span> mpg <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-4" data-line-number="4"><span class="st">  </span>head</a></code></pre></div>
<pre><code>##    mpg new_mpg
## 1 21.0    42.0
## 2 21.0    42.0
## 3 22.8    45.6
## 4 21.4    42.8
## 5 18.7    37.4
## 6 18.1    36.2</code></pre>
<p>Trong một số trường hợp, khi ta không muốn lấy các trường thông tin cũ mà chỉ muốn lấy các trường thông tin mới tạo thì có thể sử dụng hàm <code>transmute()</code> với cấu trúc giống như hàm mutate.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">mtcars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(mpg) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb63-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">new_mpg =</span> mpg <span class="op">*</span><span class="st"> </span><span class="fl">1.61</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb63-4" data-line-number="4"><span class="st">  </span>head</a></code></pre></div>
<pre><code>##   new_mpg
## 1   33.81
## 2   33.81
## 3   36.71
## 4   34.45
## 5   30.11
## 6   29.14</code></pre>
</div>
<div id="gp-nhiu-bang-vi-nhom-ham-join" class="section level5">
<h5><span class="header-section-number">3.2.2.0.2</span> Gộp nhiều bảng với nhóm hàm <code>join</code></h5>
<ul>
<li>Hàm <code>inner_join(x, y, by = &quot;key&quot;)</code>: lấy tất cả dữ liệu có trên bảng hai bảng khi trùng key, ví dụ:</li>
</ul>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">student_id =</span> <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb65-2" data-line-number="2">                <span class="dt">maths =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="fl">7.8</span>, <span class="dv">4</span>, </a>
<a class="sourceLine" id="cb65-3" data-line-number="3">                          <span class="fl">7.7</span>, <span class="dv">9</span>, <span class="fl">9.5</span>, <span class="fl">6.5</span>))</a>
<a class="sourceLine" id="cb65-4" data-line-number="4">y &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">student_id =</span> <span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">20</span>, <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb65-5" data-line-number="5">                <span class="dt">physics =</span> <span class="kw">c</span>(<span class="dv">8</span>, <span class="fl">9.5</span>, <span class="fl">7.5</span>, <span class="dv">6</span>, <span class="fl">5.5</span>, </a>
<a class="sourceLine" id="cb65-6" data-line-number="6">                            <span class="fl">6.5</span>, <span class="fl">7.8</span>, <span class="fl">8.2</span>, <span class="dv">8</span>, <span class="fl">7.5</span>))</a>
<a class="sourceLine" id="cb65-7" data-line-number="7">x</a></code></pre></div>
<pre><code>##    student_id maths
## 1           1  10.0
## 2           2   8.0
## 3           3   7.0
## 4           4   6.0
## 5           5   7.8
## 6           6   4.0
## 7           7   7.7
## 8           8   9.0
## 9           9   9.5
## 10         10   6.5</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">y</a></code></pre></div>
<pre><code>##    student_id physics
## 1           2     8.0
## 2           4     9.5
## 3           6     7.5
## 4           8     6.0
## 5          10     5.5
## 6          12     6.5
## 7          14     7.8
## 8          16     8.2
## 9          18     8.0
## 10         20     7.5</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="co"># gộp 2 bảng dữ liệu x và y theo student_id</span></a>
<a class="sourceLine" id="cb69-2" data-line-number="2">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb69-3" data-line-number="3"><span class="st">  </span><span class="kw">inner_join</span>(y, <span class="dt">by =</span> <span class="st">&quot;student_id&quot;</span>) </a></code></pre></div>
<pre><code>##   student_id maths physics
## 1          2   8.0     8.0
## 2          4   6.0     9.5
## 3          6   4.0     7.5
## 4          8   9.0     6.0
## 5         10   6.5     5.5</code></pre>
<hr />
<ul>
<li><strong>full_join</strong>: lấy tất cả dữ liệu có cả trên bảng x, y.</li>
</ul>
<blockquote>
<p>full_join(x, y, by = “key”)</p>
</blockquote>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-2" data-line-number="2"><span class="st">  </span><span class="kw">full_join</span>(y, <span class="dt">by =</span> <span class="st">&quot;student_id&quot;</span>)</a></code></pre></div>
<pre><code>##    student_id maths physics
## 1           1  10.0      NA
## 2           2   8.0     8.0
## 3           3   7.0      NA
## 4           4   6.0     9.5
## 5           5   7.8      NA
## 6           6   4.0     7.5
## 7           7   7.7      NA
## 8           8   9.0     6.0
## 9           9   9.5      NA
## 10         10   6.5     5.5
## 11         12    NA     6.5
## 12         14    NA     7.8
## 13         16    NA     8.2
## 14         18    NA     8.0
## 15         20    NA     7.5</code></pre>
<p>Trong ví dụ trên, các giá trị về điểm toán (maths) sẽ trả về NA cho các student_id không tồn tại trên bảng y và ngược lại cho bảng x với các giá trị điểm vật lý (physics) của các student_id không tồn tại trên bảng x.</p>
<hr />
<ul>
<li>Hàm <strong>left_join</strong>: lấy dữ liệu chỉ có trên bảng x, ví dụ:</li>
</ul>
<blockquote>
<p>left_join(x, y, by = “var”)</p>
</blockquote>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb73-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(y, <span class="dt">by =</span> <span class="st">&quot;student_id&quot;</span>) </a></code></pre></div>
<pre><code>##    student_id maths physics
## 1           1  10.0      NA
## 2           2   8.0     8.0
## 3           3   7.0      NA
## 4           4   6.0     9.5
## 5           5   7.8      NA
## 6           6   4.0     7.5
## 7           7   7.7      NA
## 8           8   9.0     6.0
## 9           9   9.5      NA
## 10         10   6.5     5.5</code></pre>
<p>Với các <code>student_id</code> không có giá trị trên bảng y, cột physics sẽ trả về giá trị NA</p>
<hr />
<ul>
<li>Hàm <strong>right_join</strong> : lấy dữ liệu chỉ có trên bảng y, ví dụ:</li>
</ul>
<blockquote>
<p>right_join(x, y, by = “var”)</p>
</blockquote>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-2" data-line-number="2"><span class="st">  </span><span class="kw">right_join</span>(y, <span class="dt">by =</span> <span class="st">&quot;student_id&quot;</span>) </a></code></pre></div>
<pre><code>##    student_id maths physics
## 1           2   8.0     8.0
## 2           4   6.0     9.5
## 3           6   4.0     7.5
## 4           8   9.0     6.0
## 5          10   6.5     5.5
## 6          12    NA     6.5
## 7          14    NA     7.8
## 8          16    NA     8.2
## 9          18    NA     8.0
## 10         20    NA     7.5</code></pre>
<p>Với các <code>student_id</code> không có giá trị trên bảng x, cột maths sẽ trả về giá trị NA</p>
<p><strong>Lưu ý</strong>: Trong trường hợp cột dữ liệu dùng để nối các bảng có tên khác nhau, ta có thể sử dụng cấu trúc sau:</p>
<blockquote>
<p>left_join(x, y, by = c(“key_x” = “key_y”))</p>
</blockquote>
<p>Xem ví dụ sau:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw">names</span>(x)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;student_id1&quot;</span></a>
<a class="sourceLine" id="cb77-2" data-line-number="2"><span class="kw">names</span>(y)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;student_id2&quot;</span></a>
<a class="sourceLine" id="cb77-3" data-line-number="3"></a>
<a class="sourceLine" id="cb77-4" data-line-number="4">x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-5" data-line-number="5"><span class="st">  </span><span class="kw">inner_join</span>(y, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;student_id1&quot;</span> =<span class="st"> &quot;student_id2&quot;</span>)) </a></code></pre></div>
<pre><code>##   student_id1 maths physics
## 1           2   8.0     8.0
## 2           4   6.0     9.5
## 3           6   4.0     7.5
## 4           8   9.0     6.0
## 5          10   6.5     5.5</code></pre>
</div>
<div id="ghep-nhiu-bang-theo-dong-hoc-ct-vi-nhom-ham-bind" class="section level5">
<h5><span class="header-section-number">3.2.2.0.3</span> Ghép nhiều bảng theo dòng hoặc cột với nhóm hàm <code>bind</code></h5>
<p>Bên cạnh các hàm <code>join</code>, khi xử lý dữ liệu trong thực tiễn, ta có thể phải <em>ghép</em> các bảng dữ liệu theo hàng hoặc cột. Trong dplyr, có hai hàm rất hữu dụng trong hai trường hợp trên là <code>bind_col</code> và <code>bind_rows</code></p>
<blockquote>
<p>bind_cols(data1, data2)
bind_rows(data1, data2)</p>
</blockquote>
<p>Xem hai ví dụ sau.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1">df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb79-2" data-line-number="2">                  <span class="dt">income =</span> <span class="dv">8</span><span class="op">:</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb79-3" data-line-number="3">df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">9</span>,</a>
<a class="sourceLine" id="cb79-4" data-line-number="4">                  <span class="dt">income =</span> <span class="dv">8</span><span class="op">:</span><span class="dv">13</span>)</a>
<a class="sourceLine" id="cb79-5" data-line-number="5">df3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb79-6" data-line-number="6">                  <span class="dt">gender =</span> <span class="kw">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>))</a>
<a class="sourceLine" id="cb79-7" data-line-number="7"></a>
<a class="sourceLine" id="cb79-8" data-line-number="8"><span class="co"># Nối theo dòng</span></a>
<a class="sourceLine" id="cb79-9" data-line-number="9">df1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>(df2)</a></code></pre></div>
<pre><code>##   id income
## 1  1      8
## 2  2      9
## 3  3     10
## 4  4      8
## 5  5      9
## 6  6     10
## 7  7     11
## 8  8     12
## 9  9     13</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="co"># Nối theo cột</span></a>
<a class="sourceLine" id="cb81-2" data-line-number="2">df1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_cols</span>(df3)</a></code></pre></div>
<pre><code>##   id income id1 gender
## 1  1      8   1      F
## 2  2      9   2      F
## 3  3     10   3      M</code></pre>
</div>
</div>
<div id="nhom-ham-tng-hp-d-liu-vi-summarise" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Nhóm hàm tổng hợp dữ liệu với <code>summarise</code></h3>
<p>Trong quá trình xử lý dữ liệu, ta thường xuyên phải tổng hợp dữ liệu theo các cách như: tính tổng, tính số dư bình quân, phương sai, tổng số lượng quan sát… Với <code>dplyr</code>, ta có thể sử dụng hàm <code>summarise()</code> để thực hiện công việc này.</p>
<blockquote>
<p>data %&gt;% summarise(var_name = calculate_stats(var))</p>
</blockquote>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_mpg =</span> <span class="kw">mean</span>(mpg),</a>
<a class="sourceLine" id="cb83-3" data-line-number="3">            <span class="dt">sd_mpg =</span> <span class="kw">sd</span>(mpg))</a></code></pre></div>
<pre><code>##   mean_mpg sd_mpg
## 1    20.09  6.027</code></pre>
<p>Đây là ví dụ đơn giản nhất với <code>summarise</code> mà ta có thể thay thế bằng <code>summary()</code> trên R base. Tuy nhiên, kết hợp giữa hàm <code>summarise()</code> và hàm group_by() trên dplyr sẽ cho chúng ta có cái nhìn về dữ liệu tổng hợp một cách đa chiều hơn. Hàm group_by() cho phép dữ liệu tổng hợp được gộp lại theo một hoặc nhiều trường thông tin khác nhau, giúp người phân tích có thể nhìn dữ liệu theo từ chiều riêng biệt hoặc gộp các chiều thông tin với nhau.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb85-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(cyl) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb85-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_mpg =</span> <span class="kw">mean</span>(mpg),</a>
<a class="sourceLine" id="cb85-4" data-line-number="4">            <span class="dt">mean_disp =</span> <span class="kw">mean</span>(disp))</a></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##     cyl mean_mpg mean_disp
##   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1     4     26.7      105.
## 2     6     19.7      183.
## 3     8     15.1      353.</code></pre>
</div>
</div>
<div id="cac-ham-nang-cao-trong-dplyr" class="section level2">
<h2><span class="header-section-number">3.3</span> Các hàm nâng cao trong dplyr</h2>
<p>Bên cạnh các nhóm hàm cơ bản đã trình bày ở phần trên, <code>dplyr</code> còn có một số hàm nâng cao khác đặc biệt hữu dụng trong quá trình biến đổi, tổng hợp dữ liệu, bao gồm <code>case_when</code>, <code>mutate_at</code> &amp; <code>summarise_at</code></p>
<div id="iu-kin-phan-nhom-vi-case_when" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Điều kiện phân nhóm với <code>case_when</code></h3>
<p>Trong quá trình phân tích và xử lý dữ liệu, chúng ta thường phải tạo thêm các trường mới hoặc tính toán dữ liệu dựa vào từng điều kiện khác nhau để đưa ra giá trị của trường hoặc cách tính cho dữ liệu. Ví dụ, khi ta muốn tính thưởng cho KH thì sẽ phải dùng nhiều công thức khác nhau như KH thuộc VIP sẽ nhân 1 tỷ lệ, KH thuộc nhóm trung bình sẽ có 1 tỷ lệ khác, hay KH thông thường thì sẽ 1 tỷ lệ khác….</p>
<p>Trong dplyr, hàm <code>case_when()</code> xử lý các trường hợp trên rất nhanh chóng.</p>
<blockquote>
<p>data %&gt;% mutate(new_var = case_when(
condition_1 ~ “value_1”,
condition_2 ~ “value_2”,…,
TRUE ~ “value_n”
))</p>
</blockquote>
<p>Ta xem ví dụ sau:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">number =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) </a>
<a class="sourceLine" id="cb87-2" data-line-number="2"></a>
<a class="sourceLine" id="cb87-3" data-line-number="3">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">nhom =</span> <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb87-4" data-line-number="4">  number <span class="op">&lt;=</span><span class="st"> </span><span class="dv">5</span> <span class="op">~</span><span class="st"> &quot;nhom_1&quot;</span>, <span class="co"># nhóm 1: số từ 1 đến 5</span></a>
<a class="sourceLine" id="cb87-5" data-line-number="5">  number <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> <span class="op">&amp;</span><span class="st"> </span>number <span class="op">&lt;=</span><span class="st"> </span><span class="dv">8</span> <span class="op">~</span><span class="st"> &quot;nhom_2&quot;</span>, <span class="co"># nhóm 2: số từ 6 đến 8</span></a>
<a class="sourceLine" id="cb87-6" data-line-number="6">  <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;nhom_3&quot;</span> <span class="co"># các số còn lại</span></a>
<a class="sourceLine" id="cb87-7" data-line-number="7">  ))</a></code></pre></div>
<pre><code>##    number   nhom
## 1       1 nhom_1
## 2       2 nhom_1
## 3       3 nhom_1
## 4       4 nhom_1
## 5       5 nhom_1
## 6       6 nhom_2
## 7       7 nhom_2
## 8       8 nhom_2
## 9       9 nhom_3
## 10     10 nhom_3</code></pre>
</div>
<div id="tao-them-bin-mi-theo-iu-kin-vi-mutate_if-mutate_at" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Tạo thêm biến mới theo điều kiện với <code>mutate_if</code> &amp; <code>mutate_at</code></h3>
<p>Khi phân tích, ta có thể tạo thêm biến mới khi các biến trong dataframe thỏa mãn điều kiện nào đó.</p>
<blockquote>
<p>data %&gt;% mutate_if(condition, function)</p>
</blockquote>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb89-2" data-line-number="2">  <span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb89-3" data-line-number="3">  <span class="dt">gender =</span> <span class="kw">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;F&quot;</span>),</a>
<a class="sourceLine" id="cb89-4" data-line-number="4">  <span class="dt">income =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>)</a>
<a class="sourceLine" id="cb89-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb89-6" data-line-number="6">df <span class="op">%&gt;%</span><span class="st"> </span>summary</a></code></pre></div>
<pre><code>##        id    gender     income 
##  Min.   :1   F:3    Min.   :3  
##  1st Qu.:2   M:2    1st Qu.:4  
##  Median :3          Median :5  
##  Mean   :3          Mean   :5  
##  3rd Qu.:4          3rd Qu.:6  
##  Max.   :5          Max.   :7</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1"><span class="co"># Biến đổi các biến factor thành character</span></a>
<a class="sourceLine" id="cb91-2" data-line-number="2">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_if</span>(is.factor, </a>
<a class="sourceLine" id="cb91-3" data-line-number="3">                 as.character) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-4" data-line-number="4"><span class="st">  </span>summary</a></code></pre></div>
<pre><code>##        id       gender              income 
##  Min.   :1   Length:5           Min.   :3  
##  1st Qu.:2   Class :character   1st Qu.:4  
##  Median :3   Mode  :character   Median :5  
##  Mean   :3                      Mean   :5  
##  3rd Qu.:4                      3rd Qu.:6  
##  Max.   :5                      Max.   :7</code></pre>
<p>Ngoài ra, ta có thể tự tạo các hàm mới và áp dụng với <code>mutate_if</code>. Xem ví dụ sau.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">my_func &lt;-<span class="st"> </span><span class="cf">function</span>(x){x<span class="op">*</span><span class="dv">100</span>}</a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="co"># Nhân các biến numeric lên 100 lần</span></a>
<a class="sourceLine" id="cb93-3" data-line-number="3">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb93-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate_if</span>(is.numeric, my_func)</a></code></pre></div>
<pre><code>##    id gender income
## 1 100      F    400
## 2 200      M    500
## 3 300      M    300
## 4 400      F    600
## 5 500      F    700</code></pre>
<p>Đối với <code>mutate_at</code>, ta cũng có thể thực hiện tương tự. Cấu trúc tổng quát của <code>mutate_at</code> như sau.</p>
<blockquote>
<p>data %&gt;% mutate_at(vars(var1, var2, …), function)</p>
</blockquote>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1">df </a></code></pre></div>
<pre><code>##   id gender income
## 1  1      F      4
## 2  2      M      5
## 3  3      M      3
## 4  4      F      6
## 5  5      F      7</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1"><span class="co"># Nhân biến income lên 100 lần</span></a>
<a class="sourceLine" id="cb97-2" data-line-number="2">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(income), my_func)</a></code></pre></div>
<pre><code>##   id gender income
## 1  1      F    400
## 2  2      M    500
## 3  3      M    300
## 4  4      F    600
## 5  5      F    700</code></pre>
</div>
<div id="tng-hp-d-liu-theo-iu-kin-vi-summarise_at-va-summarise_if" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Tổng hợp dữ liệu theo điều kiện với <code>summarise_at</code> và <code>summarise_if</code></h3>
<p>Tương tự như <code>mutate_at</code> và <code>mutate_if</code>, ta có thể tổng hợp nhanh dữ liệu theo điều kiện.</p>
<p>Cấu trúc tổng quát của <code>summarise_at</code></p>
<blockquote>
<p>data %&gt;%
group_by(var) (không bắt buộc)
summarise_at(vars(variables), funs(functions))</p>
</blockquote>
<p>Xem ví dụ sau</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1">mtcars <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb99-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(am) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb99-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(mpg, disp),</a>
<a class="sourceLine" id="cb99-4" data-line-number="4">               <span class="kw">funs</span>(mean, max, median))</a></code></pre></div>
<pre><code>## # A tibble: 2 x 7
##      am mpg_mean disp_mean mpg_max disp_max mpg_median
##   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
## 1     0     17.1      290.    24.4      472       17.3
## 2     1     24.4      144.    33.9      351       22.8
## # ... with 1 more variable: disp_median &lt;dbl&gt;</code></pre>
<p>Tương tự, ta có cấu trúc tổng quát của <code>summarise_if</code></p>
<blockquote>
<p>data %&gt;%
group_by(var) (không bắt buộc)
summarise_if(condition, funs(functions))</p>
</blockquote>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1">iris <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(Species, Sepal.Length, Sepal.Width) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise_if</span>(is.numeric,</a>
<a class="sourceLine" id="cb101-5" data-line-number="5">               <span class="kw">funs</span>(mean, median))</a></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   Species    Sepal.Length_mean Sepal.Width_mean
##   &lt;fct&gt;                  &lt;dbl&gt;            &lt;dbl&gt;
## 1 setosa                  5.01             3.43
## 2 versicolor              5.94             2.77
## 3 virginica               6.59             2.97
## # ... with 2 more variables:
## #   Sepal.Length_median &lt;dbl&gt;,
## #   Sepal.Width_median &lt;dbl&gt;</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cac-phuong-phap-phan-tich-d-liu-thc-t-ng-dung-vi-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="phan-ra-va-xoay-chiu-d-liu.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/03-bien-doi-du-lieu-dplyr.Rmd",
"text": "Edit"
},
"download": ["bookdown.pdf", "bookdown.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
